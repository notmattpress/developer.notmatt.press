
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Untitled Page</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@3.3.5/dist/tailwind.min.css" rel="stylesheet">
    <style>
        body {
            background-color: white;
            color: black;
            font-family: 'Quicksand', 'Open Sans', 'Helvetica', 'Arial', san-serif;
        }
        a, h1, h2, h3, h4, h5, h6 {
            color: #0073aa;
        }
        .container {
            max-width: 800px;
            margin: auto;
            padding: 20px;
        }
        .has-small-font-size.is-link-to-top {
            position: absolute;
            bottom: 10px;
            right: 10px;
        }
        .entry-content {
            position:relative;
        }
        .entry-content img {
            max-width: 100%;
        }
    </style>
</head>
<body>
<div class='container'>
    
    <div class="page-metadata" data-published="" data-last-updated=""></div>
    
    <div aria-label="Breadcrumbs" class="wp-block-wporg-site-breadcrumbs has-small-font-size" role="navigation"><div class="wporg-site-breadcrumbs__wrapper"><span><a href="https://developer.wordpress.org">Home</a></span><span><a href="https://developer.wordpress.org/block-editor/">Block Editor Handbook</a></span><span><a href="https://developer.wordpress.org/block-editor/how-to-guides/">How-to Guides</a></span><span><a href="https://developer.wordpress.org/block-editor/how-to-guides/themes/">Themes</a></span><span class="is-current-page">Global Settings &amp; Styles (theme.json)</span></div></div>  <!-- Full breadcrumbs HTML -->
    <h1>Global Settings & Styles (theme.json)</h1>
    
    
    <div class="content"><div class="entry-content wp-block-post-content is-layout-flow wp-block-post-content-is-layout-flow"><p>WordPress 5.8 comes with <a href="https://make.wordpress.org/core/2021/06/25/introducing-theme-json-in-wordpress-5-8/">a new mechanism</a> to configure the editor that enables a finer-grained control and introduces the first step in managing styles for future WordPress releases: the <code>theme.json</code> file.</p>
<h2 class="is-toc-heading" id="rationale" tabindex="-1"><a href="#rationale">Rationale</a></h2>
<p>The Block Editor API has evolved at different velocities and there are some growing pains, specially in areas that affect themes. Examples of this are: the ability to <a href="https://make.wordpress.org/core/2020/01/23/controlling-the-block-editor/">control the editor programmatically</a>, or <a href="https://github.com/WordPress/gutenberg/issues/9534">a block style system</a> that facilitates user, theme, and core style preferences.</p>
<p>This describes the current efforts to consolidate the various APIs related to styles into a single point – a <code>theme.json</code> file that should be located inside the root of the theme directory.</p>
<h3 class="is-toc-heading" id="settings-for-the-block-editor" tabindex="-1"><a href="#settings-for-the-block-editor">Settings for the block editor</a></h3>
<p>Instead of the proliferation of theme support flags or alternative methods, the <code>theme.json</code> files provides a canonical way to define the settings of the block editor. These settings includes things like:</p>
<ul>
<li>What customization options should be made available or hidden from the user.</li>
<li>What are the default colors, font sizes… available to the user.</li>
<li>Defines the default layout of the editor (widths and available alignments).</li>
</ul>
<h3 class="is-toc-heading" id="settings-can-be-controlled-per-block" tabindex="-1"><a href="#settings-can-be-controlled-per-block">Settings can be controlled per block</a></h3>
<p>For more granularity, these settings also work at the block level in <code>theme.json</code>.</p>
<p>Examples of what can be achieved are:</p>
<ul>
<li>Use a particular preset for a block (e.g.: table) but the common one for the rest of blocks.</li>
<li>Enable font size UI controls for all blocks but the headings block.</li>
<li>etc.</li>
</ul>
<h3 class="is-toc-heading" id="styles-are-managed" tabindex="-1"><a href="#styles-are-managed">Styles are managed</a></h3>
<p>By using the <code>theme.json</code> file to set style properties in a structured way, the Block Editor can “manage” the CSS that comes from different origins (user, theme, and core CSS). For example, if a theme and a user set the font size for paragraphs, we only enqueue the style coming from the user and not the theme’s.</p>
<p>Some of the advantages are:</p>
<ul>
<li>Reduce the amount of CSS enqueued.</li>
<li>Prevent specificity wars.</li>
</ul>
<h3 class="is-toc-heading" id="css-custom-properties-presets-custom" tabindex="-1"><a href="#css-custom-properties-presets-custom">CSS Custom Properties: presets &amp; custom</a></h3>
<p>There are some areas of styling that would benefit from having shared values that can change across a site.</p>
<p>To address this need, we’ve started to experiment with CSS Custom Properties, aka CSS Variables, in some places:</p>
<ul>
<li><strong>Presets</strong>: <a href="https://developer.notmatt.press/block-editor/how-to-guides/themes/theme-support/#block-color-palettes">color palettes</a>, <a href="https://developer.notmatt.press/block-editor/how-to-guides/themes/theme-support/#block-font-sizes">font sizes</a>, or <a href="https://developer.notmatt.press/block-editor/how-to-guides/themes/theme-support/#block-gradient-presets">gradients</a> declared by the theme are converted to CSS Custom Properties and enqueued both the front-end and the editors.</li>
</ul>
<div class="code-tabs"><button class="code-tab Input is-active" data-language="Input">Input</button><button class="code-tab Output" data-language="Output">Output</button>
<div class="code-tab-block Input is-active">
<pre><code class="language-json">{
    "version": 3,
    "settings": {
        "color": {
            "palette": [
                {
                    "name": "Black",
                    "slug": "black",
                    "color": "#000000"
                },
                {
                    "name": "White",
                    "slug": "white",
                    "color": "#ffffff"
                }
            ]
        }
    }
}
</code></pre>
</div>
<div class="code-tab-block Output">
<pre><code class="language-css">body {
    --wp--preset--color--black: #000000;
    --wp--preset--color--white: #ffffff;
}
</code></pre>
</div>
</div>
<ul>
<li><strong>Custom properties</strong>: there’s also a mechanism to create your own CSS Custom Properties.</li>
</ul>
<div class="code-tabs"><button class="code-tab Input is-active" data-language="Input">Input</button><button class="code-tab Output" data-language="Output">Output</button>
<div class="code-tab-block Input is-active">
<pre><code class="language-json">{
    "version": 3,
    "settings": {
        "custom": {
            "line-height": {
                "body": 1.7,
                "heading": 1.3
            }
        }
    }
}
</code></pre>
</div>
<div class="code-tab-block Output">
<pre><code class="language-css">body {
    --wp--custom--line-height--body: 1.7;
    --wp--custom--line-height--heading: 1.3;
}
</code></pre>
</div>
</div>
<h2 class="is-toc-heading" id="specification" tabindex="-1"><a href="#specification">Specification</a></h2>
<p>This specification is the same for the three different origins that use this format: core, themes, and users. Themes can override core’s defaults by creating a file called <code>theme.json</code>. Users, via the site editor, will also be able to override theme’s or core’s preferences via an user interface that is being worked on.</p>
<pre><code class="language-json">{
    "version": 3,
    "settings": {},
    "styles": {},
    "customTemplates": {},
    "templateParts": {}
}
</code></pre>
<h3 class="is-toc-heading" id="version" tabindex="-1"><a href="#version">Version</a></h3>
<p>This field describes the format of the <code>theme.json</code> file. The latest version is <a href="https://developer.notmatt.press/block-editor/reference-guides/theme-json-reference/theme-json-living/">version 3</a> introduced in WordPress 6.6.</p>
<p>New versions are introduced when a breaking change needs to be made. This allows theme authors to choose when to opt-in to the breaking changes and migrate their theme.json files to the new format.</p>
<p>Older versions of <code>theme.json</code> are backwards-compatible and will continue to work with newer versions of WordPress and the Gutenberg plugin. However new features will be developed on the latest version.</p>
<p>Follow the instructions in <a href="https://developer.notmatt.press/block-editor/reference-guides/theme-json-reference/theme-json-migrations/">migrating to newer versions</a> for details on updating to the latest version.</p>
<h3 class="is-toc-heading" id="settings" tabindex="-1"><a href="#settings">Settings</a></h3>
<div class="callout callout-alert">
The Gutenberg plugin extends the settings available from WordPress 5.8, so they can be used with other WordPress versions and they go through a maturation process before being ported to core.
<p>The tabs below show WordPress 5.8 supported settings and the ones supported by the Gutenberg plugin.
</p></div>
<p>The settings section has the following structure:</p>
<div class="code-tabs"><button class="code-tab WordPress is-active" data-language="WordPress">WordPress</button><button class="code-tab Gutenberg" data-language="Gutenberg">Gutenberg</button>
<div class="code-tab-block WordPress is-active">
<pre><code class="language-json">{
    "version": 3,
    "settings": {
        "border": {
            "radius": false,
            "color": false,
            "style": false,
            "width": false
        },
        "color": {
            "custom": true,
            "customDuotone": true,
            "customGradient": true,
            "duotone": [],
            "gradients": [],
            "link": false,
            "palette": [],
            "text": true,
            "background": true,
            "defaultGradients": true,
            "defaultPalette": true
        },
        "custom": {},
        "layout": {
            "contentSize": "800px",
            "wideSize": "1000px"
        },
        "spacing": {
            "margin": false,
            "padding": false,
            "blockGap": null,
            "units": [ "px", "em", "rem", "vh", "vw" ]
        },
        "typography": {
            "customFontSize": true,
            "lineHeight": false,
            "dropCap": true,
            "fluid": false,
            "fontStyle": true,
            "fontWeight": true,
            "letterSpacing": true,
            "textDecoration": true,
            "textTransform": true,
            "fontSizes": [],
            "fontFamilies": []
        },
        "blocks": {
            "core/paragraph": {
                "color": {},
                "custom": {},
                "layout": {},
                "spacing": {},
                "typography": {}
            },
            "core/heading": {},
            "etc": {}
        }
    }
}
</code></pre>
</div>
<div class="code-tab-block Gutenberg">
<pre><code class="language-json">{
    "version": 3,
    "settings": {
        "appearanceTools": false,
        "border": {
            "color": false,
            "radius": false,
            "style": false,
            "width": false
        },
        "color": {
            "background": true,
            "custom": true,
            "customDuotone": true,
            "customGradient": true,
            "defaultGradients": true,
            "defaultPalette": true,
            "duotone": [],
            "gradients": [],
            "link": false,
            "palette": [],
            "text": true
        },
        "custom": {},
        "dimensions": {
            "aspectRatio": false,
            "minHeight": false,
        },
        "layout": {
            "contentSize": "800px",
            "wideSize": "1000px"
        },
        "spacing": {
            "blockGap": null,
            "margin": false,
            "padding": false,
            "customSpacingSize": true,
            "units": [ "px", "em", "rem", "vh", "vw" ],
            "spacingScale": {
                "operator": "*",
                "increment": 1.5,
                "steps": 7,
                "mediumStep": 1.5,
                "unit": "rem"
            },
            "spacingSizes": []
        },
        "typography": {
            "customFontSize": true,
            "dropCap": true,
            "fluid": false,
            "fontFamilies": [],
            "fontSizes": [],
            "fontStyle": true,
            "fontWeight": true,
            "letterSpacing": true,
            "lineHeight": false,
            "textAlign": true,
            "textColumns": false,
            "textDecoration": true,
            "textTransform": true
        },
        "blocks": {
            "core/paragraph": {
                "border": {},
                "color": {},
                "custom": {},
                "layout": {},
                "spacing": {},
                "typography": {}
            },
            "core/heading": {},
            "etc": {}
        }
    }
}
</code></pre>
</div>
</div>
<p>Each block can configure any of these settings separately, providing a more fine-grained control over what exists via <code>add_theme_support</code>. The settings declared at the top-level affect to all blocks, unless a particular block overwrites it. It’s a way to provide inheritance and configure all blocks at once.</p>
<p>Note, however, that not all settings are relevant for all blocks. The settings section provides an opt-in/opt-out mechanism for themes, but it’s the block’s responsibility to add support for the features that are relevant to it. For example, if a block doesn’t implement the <code>dropCap</code> feature, a theme can’t enable it for such a block through <code>theme.json</code>.</p>
<h3 class="is-toc-heading" id="opt-in-into-ui-controls" tabindex="-1"><a href="#opt-in-into-ui-controls">Opt-in into UI controls</a></h3>
<p>There’s one special setting property, <code>appearanceTools</code>, which is a boolean and its default value is false. Themes can use this setting to enable the following ones:</p>
<ul>
<li>background: backgroundImage, backgroundSize</li>
<li>border: color, radius, style, width</li>
<li>color: link</li>
<li>dimensions: aspectRatio, minHeight</li>
<li>position: sticky</li>
<li>spacing: blockGap, margin, padding</li>
<li>typography: lineHeight</li>
</ul>
<h4>Backward compatibility with add_theme_support</h4>
<p>To retain backward compatibility, the existing <code>add_theme_support</code> declarations that configure the block editor are retrofit in the proper categories for the top-level section. For example, if a theme uses <code>add_theme_support('disable-custom-colors')</code>, it’ll be the same as setting <code>settings.color.custom</code> to <code>false</code>. If the <code>theme.json</code> contains any settings, these will take precedence over the values declared via <code>add_theme_support</code>. This is the complete list of equivalences:</p>
<figure class="wp-block-table is-style-borderless"><table>
<thead>
<tr>
<th>add_theme_support</th>
<th>theme.json setting</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>custom-line-height</code></td>
<td>Set <code>typography.lineHeight</code> to <code>true</code>.</td>
</tr>
<tr>
<td><code>custom-spacing</code></td>
<td>Set <code>spacing.padding</code> to <code>true</code>.</td>
</tr>
<tr>
<td><code>custom-units</code></td>
<td>Provide the list of units via <code>spacing.units</code>.</td>
</tr>
<tr>
<td><code>disable-custom-colors</code></td>
<td>Set <code>color.custom</code> to <code>false</code>.</td>
</tr>
<tr>
<td><code>disable-custom-font-sizes</code></td>
<td>Set <code>typography.customFontSize</code> to <code>false</code>.</td>
</tr>
<tr>
<td><code>disable-custom-gradients</code></td>
<td>Set <code>color.customGradient</code> to <code>false</code>.</td>
</tr>
<tr>
<td><code>editor-color-palette</code></td>
<td>Provide the list of colors via <code>color.palette</code>.</td>
</tr>
<tr>
<td><code>editor-font-sizes</code></td>
<td>Provide the list of font size via <code>typography.fontSizes</code>.</td>
</tr>
<tr>
<td><code>editor-gradient-presets</code></td>
<td>Provide the list of gradients via <code>color.gradients</code>.</td>
</tr>
<tr>
<td><code>editor-spacing-sizes</code></td>
<td>Provide the list of spacing sizes via <code>spacing.spacingSizes</code>.</td>
</tr>
<tr>
<td><code>appearance-tools</code></td>
<td>Set <code>appearanceTools</code> to <code>true</code>.</td>
</tr>
<tr>
<td><code>border</code></td>
<td>Set <code>border: color, radius, style, width</code> to <code>true</code>.</td>
</tr>
<tr>
<td><code>link-color</code></td>
<td>Set <code>color.link</code> to <code>true</code>.</td>
</tr>
</tbody>
</table></figure>
<h4>Presets</h4>
<p>Presets are part of the settings section. They are values that are shown to the user via some UI controls. By defining them via <code>theme.json</code> the engine can do more for themes, such as automatically translate the preset name or enqueue the corresponding CSS classes and custom properties.</p>
<p>The following presets can be defined via <code>theme.json</code>:</p>
<ul>
<li><code>color.duotone</code>: doesn’t generate classes or custom properties.</li>
<li><code>color.gradients</code>: generates a single class and custom property per preset value.</li>
<li><code>color.palette</code>:
<ul>
<li>generates 3 classes per preset value: color, background-color, and border-color.</li>
<li>generates a single custom property per preset value.</li>
</ul>
</li>
<li><code>spacing.spacingSizes</code>/<code>spacing.spacingScale</code>: generates a single custom property per preset value.</li>
<li><code>typography.fontSizes</code>: generates a single class and custom property per preset value.</li>
<li><code>typography.fontFamilies</code>: generates a single custom property per preset value.</li>
</ul>
<p>The naming schema for the classes and the custom properties is as follows:</p>
<ul>
<li>Custom Properties: <code>--wp--preset--{preset-category}--{preset-slug}</code> such as <code>--wp--preset--color--black</code></li>
<li>Classes: <code>.has-{preset-slug}-{preset-category}</code> such as <code>.has-black-color</code>.</li>
</ul>
<div class="code-tabs"><button class="code-tab Input is-active" data-language="Input">Input</button><button class="code-tab Output" data-language="Output">Output</button>
<div class="code-tab-block Input is-active">
<pre><code class="language-json">{
    "version": 3,
    "settings": {
        "color": {
            "duotone": [
                {
                    "colors": [ "#000", "#FFF" ],
                    "slug": "black-and-white",
                    "name": "Black and White"
                }
            ],
            "gradients": [
                {
                    "slug": "blush-bordeaux",
                    "gradient": "linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%)",
                    "name": "Blush bordeaux"
                },
                {
                    "slug": "blush-light-purple",
                    "gradient": "linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%)",
                    "name": "Blush light purple"
                }
            ],
            "palette": [
                {
                    "slug": "strong-magenta",
                    "color": "#a156b4",
                    "name": "Strong magenta"
                },
                {
                    "slug": "very-dark-grey",
                    "color": "rgb(131, 12, 8)",
                    "name": "Very dark grey"
                }
            ]
        },
        "typography": {
            "fontFamilies": [
                {
                    "fontFamily": "-apple-system,BlinkMacSystemFont,\"Segoe UI\",Roboto,Oxygen-Sans,Ubuntu,Cantarell, \"Helvetica Neue\",sans-serif",
                    "slug": "system-font",
                    "name": "System Font"
                },
                {
                    "fontFamily": "Helvetica Neue, Helvetica, Arial, sans-serif",
                    "slug": "helvetica-arial",
                    "name": "Helvetica or Arial"
                }
            ],
            "fontSizes": [
                {
                    "slug": "big",
                    "size": 32,
                    "name": "Big"
                },
                {
                    "slug": "x-large",
                    "size": 46,
                    "name": "Large"
                }
            ]
        },
        "spacing": {
            "spacingScale": {
                "operator": "*",
                "increment": 1.5,
                "steps": 7,
                "mediumStep": 1.5,
                "unit": "rem"
            },
            "spacingSizes": [
                {
                    "slug": "40",
                    "size": "1rem",
                    "name": "Small"
                },
                {
                    "slug": "50",
                    "size": "1.5rem",
                    "name": "Medium"
                },
                {
                    "slug": "60",
                    "size": "2rem",
                    "name": "Large"
                }
            ]
        },
        "blocks": {
            "core/group": {
                "color": {
                    "palette": [
                        {
                            "slug": "black",
                            "color": "#000000",
                            "name": "Black"
                        },
                        {
                            "slug": "white",
                            "color": "#ffffff",
                            "name": "White"
                        }
                    ]
                }
            }
        }
    }
}
</code></pre>
</div>
<div class="code-tab-block Output">
<pre><code class="language-css">/* Top-level custom properties */
body {
    --wp--preset--color--strong-magenta: #a156b4;
    --wp--preset--color--very-dark-grey: #444;
    --wp--preset--gradient--blush-bordeaux: linear-gradient( 135deg, rgb( 254, 205, 165 ) 0%, rgb( 254, 45, 45 ) 50%, rgb( 107, 0, 62 ) 100% );
    --wp--preset--gradient--blush-light-purple: linear-gradient( 135deg, rgb( 255, 206, 236 ) 0%, rgb( 152, 150, 240 ) 100% );
    --wp--preset--font-size--x-large: 46;
    --wp--preset--font-size--big: 32;
    --wp--preset--font-family--helvetica-arial: Helvetica Neue, Helvetica, Arial, sans-serif;
    --wp--preset--font-family--system: -apple-system,BlinkMacSystemFont,\"Segoe UI\",Roboto,Oxygen-Sans,Ubuntu,Cantarell, \"Helvetica Neue\",sans-serif;
    --wp--preset--spacing--20: 0.44rem;
    --wp--preset--spacing--30: 0.67rem;
    --wp--preset--spacing--40: 1rem;
    --wp--preset--spacing--50: 1.5rem;
    --wp--preset--spacing--60: 2.25rem;
    --wp--preset--spacing--70: 3.38rem;
    --wp--preset--spacing--80: 5.06rem;
}

/* Block-level custom properties (bounded to the group block) */
.wp-block-group {
    --wp--preset--color--black: #000000;
    --wp--preset--color--white: #ffffff;
}

/* Top-level classes */
.has-strong-magenta-color { color: #a156b4 !important; }
.has-strong-magenta-background-color { background-color: #a156b4 !important; }
.has-strong-magenta-border-color { border-color: #a156b4 !important; }
.has-very-dark-grey-color { color: #444 !important; }
.has-very-dark-grey-background-color { background-color: #444 !important; }
.has-very-dark-grey-border-color { border-color: #444 !important; }
.has-blush-bordeaux-background { background: linear-gradient( 135deg, rgb( 254, 205, 165 ) 0%, rgb( 254, 45, 45 ) 50%, rgb( 107, 0, 62 ) 100% ) !important; }
.has-blush-light-purple-background { background: linear-gradient( 135deg, rgb( 255, 206, 236 ) 0%, rgb( 152, 150, 240 ) 100% ) !important; }
.has-big-font-size { font-size: 32; }
.has-normal-font-size { font-size: 16; }

/* Block-level classes (bounded to the group block) */
.wp-block-group.has-black-color { color: #a156b4 !important; }
.wp-block-group.has-black-background-color { background-color: #a156b4 !important; }
.wp-block-group.has-black-border-color { border-color: #a156b4 !important; }
.wp-block-group.has-white-color { color: #444 !important; }
.wp-block-group.has-white-background-color { background-color: #444 !important; }
.wp-block-group.has-white-border-color { border-color: #444 !important; }

</code></pre>
</div>
</div>
<p>To maintain backward compatibility, the presets declared via <code>add_theme_support</code> will also generate the CSS Custom Properties. If the <code>theme.json</code> contains any presets, these will take precedence over the ones declared via <code>add_theme_support</code>.</p>
<p>Preset classes are attached to the content of a post by some user action. That’s why the engine will add <code>!important</code> to these, because user styles should take precedence over theme styles.</p>
<h4>Custom</h4>
<p>In addition to create CSS Custom Properties for the presets, the <code>theme.json</code> also allows for themes to create their own, so they don’t have to be enqueued separately. Any values declared within the <code>custom</code> field will be transformed to CSS Custom Properties following this naming schema: <code>--wp--custom--&lt;variable-name&gt;</code>.</p>
<p>For example:</p>
<div class="code-tabs"><button class="code-tab Input is-active" data-language="Input">Input</button><button class="code-tab Output" data-language="Output">Output</button>
<div class="code-tab-block Input is-active">
<pre><code class="language-json">{
    "version": 3,
    "settings": {
        "custom": {
            "baseFont": 16,
            "lineHeight": {
                "small": 1.2,
                "medium": 1.4,
                "large": 1.8
            }
        },
        "blocks": {
            "core/group": {
                "custom": {
                    "baseFont": 32
                }
            }
        }
    }
}
</code></pre>
</div>
<div class="code-tab-block Output">
<pre><code class="language-css">body {
    --wp--custom--base-font: 16;
    --wp--custom--line-height--small: 1.2;
    --wp--custom--line-height--medium: 1.4;
    --wp--custom--line-height--large: 1.8;
}
.wp-block-group {
    --wp--custom--base-font: 32;
}
</code></pre>
</div>
</div>
<p>Note that the name of the variable is created by adding <code>--</code> in between each nesting level and <code>camelCase</code> fields are transformed to <code>kebab-case</code>.</p>
<h4>Settings examples</h4>
<ul>
<li>Enable custom colors only for the paragraph block:</li>
</ul>
<pre><code class="language-json">{
    "version": 3,
    "settings": {
        "color": {
            "custom": false
        },
        "blocks": {
            "core/paragraph": {
                "color": {
                    "custom": true
                }
            }
        }
    }
}
</code></pre>
<ul>
<li>Disable border radius for the button block:</li>
</ul>
<pre><code class="language-json">{
    "version": 3,
    "settings": {
        "blocks": {
            "core/button": {
                "border": {
                    "radius": false
                }
            }
        }
    }
}
</code></pre>
<ul>
<li>Provide the group block a different palette than the rest:</li>
</ul>
<pre><code class="language-json">{
    "version": 3,
    "settings": {
        "color": {
            "palette": [
                {
                    "slug": "black",
                    "color": "#000000",
                    "name": "Black"
                },
                {
                    "slug": "white",
                    "color": "#FFFFFF",
                    "name": "White"
                },
                {
                    "slug": "red",
                    "color": "#FF0000",
                    "name": "Red"
                },
                {
                    "slug": "green",
                    "color": "#00FF00",
                    "name": "Green"
                },
                {
                    "slug": "blue",
                    "color": "#0000FF",
                    "name": "Blue"
                }
            ]
        },
        "blocks": {
            "core/group": {
                "color": {
                    "palette": [
                        {
                            "slug": "black",
                            "color": "#000000",
                            "name": "Black"
                        },
                        {
                            "slug": "white",
                            "color": "#FFF",
                            "name": "White"
                        }
                    ]
                }
            }
        }
    }
}
</code></pre>
<h3 class="is-toc-heading" id="styles" tabindex="-1"><a href="#styles">Styles</a></h3>
<div class="callout callout-alert">
The Gutenberg plugin extends the styles available from WordPress 5.8, so they can be used with other WordPress versions and they go through a maturation process before being ported to core.
<p>The tabs below show WordPress 5.8 supported styles and the ones supported by the Gutenberg plugin.
</p></div>
<p>Each block declares which style properties it exposes via the <a href="https://developer.notmatt.press/block-editor/reference-guides/block-api/block-supports/">block supports mechanism</a>. The support declarations are used to automatically generate the UI controls for the block in the editor. Themes can use any style property via the <code>theme.json</code> for any block ― it’s the theme’s responsibility to verify that it works properly according to the block markup, etc.</p>
<div class="code-tabs"><button class="code-tab WordPress is-active" data-language="WordPress">WordPress</button><button class="code-tab Gutenberg" data-language="Gutenberg">Gutenberg</button>
<div class="code-tab-block WordPress is-active">
<pre><code class="language-json">{
    "version": 3,
    "styles": {
        "border": {
            "radius": "value",
            "color": "value",
            "style": "value",
            "width": "value"
        },
        "filter": {
            "duotone": "value"
        },
        "color": {
            "background": "value",
            "gradient": "value",
            "text": "value"
        },
        "spacing": {
            "blockGap": "value",
            "margin": {
                "top": "value",
                "right": "value",
                "bottom": "value",
                "left": "value",
            },
            "padding": {
                "top": "value",
                "right": "value",
                "bottom": "value",
                "left": "value"
            }
        },
        "typography": {
            "fontSize": "value",
            "fontStyle": "value",
            "fontWeight": "value",
            "letterSpacing": "value",
            "lineHeight": "value",
            "textDecoration": "value",
            "textTransform": "value"
        },
        "elements": {
            "link": {
                "border": {},
                "color": {},
                "spacing": {},
                "typography": {}
            },
            "h1": {},
            "h2": {},
            "h3": {},
            "h4": {},
            "h5": {},
            "h6": {}
        },
        "blocks": {
            "core/group": {
                "border": {},
                "color": {},
                "spacing": {},
                "typography": {},
                "elements": {
                    "link": {},
                    "h1": {},
                    "h2": {},
                    "h3": {},
                    "h4": {},
                    "h5": {},
                    "h6": {}
                }
            },
            "etc": {}
        }
    }
}
</code></pre>
</div>
<div class="code-tab-block Gutenberg">
<pre><code class="language-json">{
    "version": 3,
    "styles": {
        "border": {
            "color": "value",
            "radius": "value",
            "style": "value",
            "width": "value"
        },
        "color": {
            "background": "value",
            "gradient": "value",
            "text": "value"
        },
        "dimensions": {
            "aspectRatio": "value",
            "minHeight": "value"
        },
        "filter": {
            "duotone": "value"
        },
        "spacing": {
            "blockGap": "value",
            "margin": {
                "top": "value",
                "right": "value",
                "bottom": "value",
                "left": "value"
            },
            "padding": {
                "top": "value",
                "right": "value",
                "bottom": "value",
                "left": "value"
            }
        },
        "typography": {
            "fontFamily": "value",
            "fontSize": "value",
            "fontStyle": "value",
            "fontWeight": "value",
            "letterSpacing": "value",
            "lineHeight": "value",
            "textColumns": "value",
            "textDecoration": "value",
            "textTransform": "value"
        },
        "elements": {
            "link": {
                "border": {},
                "color": {},
                "spacing": {},
                "typography": {}
            },
            "h1": {},
            "h2": {},
            "h3": {},
            "h4": {},
            "h5": {},
            "h6": {},
            "heading": {},
            "button": {},
            "caption": {}
        },
        "blocks": {
            "core/group": {
                "border": {},
                "color": {},
                "dimensions": {},
                "spacing": {},
                "typography": {},
                "elements": {
                    "link": {},
                    "h1": {},
                    "h2": {},
                    "h3": {},
                    "h4": {},
                    "h5": {},
                    "h6": {}
                }
            },
            "etc": {}
        }
    }
}
</code></pre>
</div>
</div>
<h3 class="is-toc-heading" id="top-level-styles" tabindex="-1"><a href="#top-level-styles">Top-level styles</a></h3>
<p>Styles found at the top-level will be enqueued using the <code>body</code> selector.</p>
<div class="code-tabs"><button class="code-tab Input is-active" data-language="Input">Input</button><button class="code-tab Output" data-language="Output">Output</button>
<div class="code-tab-block Input is-active">
<pre><code class="language-json">{
    "version": 3,
    "styles": {
        "color": {
            "text": "var(--wp--preset--color--primary)"
        }
    }
}
</code></pre>
</div>
<div class="code-tab-block Output">
<pre><code class="language-css">body {
    color: var( --wp--preset--color--primary );
}
</code></pre>
</div>
</div>
<h3 class="is-toc-heading" id="block-styles" tabindex="-1"><a href="#block-styles">Block styles</a></h3>
<p>Styles found within a block will be enqueued using the block selector.</p>
<p>By default, the block selector is generated based on its name such as <code>.wp-block-&lt;blockname-without-namespace&gt;</code>. For example, <code>.wp-block-group</code> for the <code>core/group</code> block. There are some blocks that want to opt-out from this default behavior. They can do so by explicitly telling the system which selector to use for them via the <code>__experimentalSelector</code> key within the <code>supports</code> section of its <code>block.json</code> file. Note that the block needs to be registered server-side for the <code>__experimentalSelector</code> field to be available to the style engine.</p>
<div class="code-tabs"><button class="code-tab Input is-active" data-language="Input">Input</button><button class="code-tab Output" data-language="Output">Output</button>
<div class="code-tab-block Input is-active">
<pre><code class="language-json">{
    "version": 3,
    "styles": {
        "color": {
            "text": "var(--wp--preset--color--primary)"
        },
        "blocks": {
            "core/paragraph": {
                "color": {
                    "text": "var(--wp--preset--color--secondary)"
                }
            },
            "core/group": {
                "color": {
                    "text": "var(--wp--preset--color--tertiary)"
                }
            }
        }
    }
}
</code></pre>
</div>
<div class="code-tab-block Output">
<pre><code class="language-css">body {
    color: var( --wp--preset--color--primary );
}
p { /* The core/paragraph opts out from the default behaviour and uses p as a selector. */
    color: var( --wp--preset--color--secondary );
}
.wp-block-group {
    color: var( --wp--preset--color--tertiary );
}
</code></pre>
</div>
</div>
<h4>Referencing a style</h4>
<p>A block can be styled using a reference to a root level style. This feature is supported by Gutenberg.<br/>
If you register a background color for the root using styles.color.background:</p>
<pre><code class="language-JSON">"styles": {
        "color": {
            "background": "var(--wp--preset--color--primary)"
        }
    }
</code></pre>
<p>You can use <code>ref: "styles.color.background"</code>  to re-use the style for a block:</p>
<pre><code class="language-JSON">{
    "color": {
        "text": { "ref": "styles.color.background" }
    }
}
</code></pre>
<h4>Element styles</h4>
<p>In addition to top-level and block-level styles, there’s the concept of elements that can be used in both places. There’s a closed set of them:</p>
<p>Supported by Gutenberg:</p>
<ul>
<li><code>button</code>: maps to the <code>wp-element-button</code> CSS class. Also maps to <code>wp-block-button__link</code> for backwards compatibility.</li>
<li><code>caption</code>: maps to the <code>.wp-element-caption, .wp-block-audio figcaption, .wp-block-embed figcaption, .wp-block-gallery figcaption, .wp-block-image figcaption, .wp-block-table figcaption, .wp-block-video figcaption</code> CSS classes.</li>
<li><code>heading</code>: maps to all headings, the <code>h1 to h6</code> CSS selectors.</li>
</ul>
<p>Supported by WordPress:</p>
<ul>
<li><code>h1</code>: maps to the <code>h1</code> CSS selector.</li>
<li><code>h2</code>: maps to the <code>h2</code> CSS selector.</li>
<li><code>h3</code>: maps to the <code>h3</code> CSS selector.</li>
<li><code>h4</code>: maps to the <code>h4</code> CSS selector.</li>
<li><code>h5</code>: maps to the <code>h5</code> CSS selector.</li>
<li><code>h6</code>: maps to the <code>h6</code> CSS selector.</li>
<li><code>link</code>: maps to the <code>a</code> CSS selector.</li>
</ul>
<p>If they’re found in the top-level the element selector will be used. If they’re found within a block, the selector to be used will be the element’s appended to the corresponding block.</p>
<div class="code-tabs"><button class="code-tab Input is-active" data-language="Input">Input</button><button class="code-tab Output" data-language="Output">Output</button>
<div class="code-tab-block Input is-active">
<pre><code class="language-json">{
    "version": 3,
    "styles": {
        "typography": {
            "fontSize": "var(--wp--preset--font-size--normal)"
        },
        "elements": {
            "h1": {
                "typography": {
                    "fontSize": "var(--wp--preset--font-size--huge)"
                }
            },
            "h2": {
                "typography": {
                    "fontSize": "var(--wp--preset--font-size--big)"
                }
            },
            "h3": {
                "typography": {
                    "fontSize": "var(--wp--preset--font-size--medium)"
                }
            }
        },
        "blocks": {
            "core/group": {
                "elements": {
                    "h2": {
                        "typography": {
                            "fontSize": "var(--wp--preset--font-size--small)"
                        }
                    },
                    "h3": {
                        "typography": {
                            "fontSize": "var(--wp--preset--font-size--smaller)"
                        }
                    }
                }
            }
        }
    }
}
</code></pre>
</div>
<div class="code-tab-block Output">
<pre><code class="language-css">body {
    font-size: var( --wp--preset--font-size--normal );
}
h1 {
    font-size: var( --wp--preset--font-size--huge );
}
h2 {
    font-size: var( --wp--preset--font-size--big );
}
h3 {
    font-size: var( --wp--preset--font-size--medium );
}
.wp-block-group h2 {
    font-size: var( --wp--preset--font-size--small );
}
.wp-block-group h3 {
    font-size: var( --wp--preset--font-size--smaller );
}
</code></pre>
</div>
</div>
<h5>Element pseudo selectors</h5>
<p>Pseudo selectors <code>:hover</code>, <code>:focus</code>, <code>:visited</code>, <code>:active</code>, <code>:link</code>, <code>:any-link</code> are supported by Gutenberg.</p>
<pre><code class="language-json">"elements": {
        "link": {
            "color": {
                "text": "green"
            },
            ":hover": {
                "color": {
                    "text": "hotpink"
                }
            }
        }
    }
</code></pre>
<h4>Variations</h4>
<p>A block can have a “style variation,” as defined in the <a href="https://developer.notmatt.press/block-editor/reference-guides/block-api/block-registration/#styles-optional">block.json specification</a>. Theme authors can define the style attributes for an existing style variation using the <code>theme.json</code> file. Styles for unregistered style variations will be ignored.</p>
<p>Note that variations are a “block concept”—they only exist when bound to blocks. The <code>theme.json</code> specification respects this distinction by only allowing <code>variations</code> at the block level, not the top level. It’s also worth highlighting that only variations defined in the <code>block.json</code> file of the block or via <code>register_block_style</code> on the server are considered “registered” for <code>theme.json</code> styling purposes.</p>
<p>For example, this is how to provide styles for the existing <code>plain</code> variation for the <code>core/quote</code> block:</p>
<pre><code class="language-json">{
    "version": 3,
    "styles": {
        "blocks": {
            "core/quote": {
                "variations": {
                    "plain": {
                        "color": {
                            "background": "red"
                        }
                    }
                }
            }
        }
    }
}
</code></pre>
<p>The resulting CSS output is:</p>
<pre><code class="language-css">.wp-block-quote.is-style-plain {
    background-color: red;
}
</code></pre>
<p>It is also possible for multiple block types to share the same variation styles. There are two recommended ways to define such shared styles:</p>
<ol>
<li><code>theme.json</code> partial files</li>
<li>programmatically, using <code>register_block_style</code></li>
</ol>
<h5>Variation Theme.json Partials</h5>
<p>Like theme style variation partials, those for block style variations reside within a theme’s <code>/styles</code> directory. However, they are differentiated from theme style variations by the introduction of a top-level property called <code>blockTypes</code>. The <code>blockTypes</code> property is an array of block types for which the block style variation has been registered.</p>
<p>Additionally, a <code>slug</code> property is available to provide consistency between the different sources that may define block style variations and to decouple the <code>slug</code> from the translatable <code>title</code> property.</p>
<p>The following is an example of a <code>theme.json</code> partial that defines styles for the “Variation A” block style for the Group, Columns, and Media &amp; Text block types:</p>
<pre><code class="language-json">{
    "$schema": "https://schemas.wp.org/trunk/theme.json",
    "version": 3,
    "title": "Variation A",
    "slug": "variation-a",
    "blockTypes": [ "core/group", "core/columns", "core/media-text" ],
    "styles": {
        "color": {
            "background": "#eed8d3",
            "text": "#201819"
        },
        "elements": {
            "heading": {
                "color": {
                    "text": "#201819"
                }
            }
        },
        "blocks": {
            "core/group": {
                "color": {
                    "background": "#825f58",
                    "text": "#eed8d3"
                },
                "elements": {
                    "heading": {
                        "color": {
                            "text": "#eed8d3"
                        }
                    }
                }
            }
        }
    }
}
</code></pre>
<h5>Programmatically Registering Variation Styles</h5>
<p>As an alternative to <code>theme.json</code> partials, you can register variation styles at the same time as registering the variation itself through <code>register_block_style</code>. This is done by registering the block style for an array of block types while also passing a “style object” within the <code>style_data</code> option.</p>
<p>The example below registers a “Green” variation for the Group and Columns blocks. Note that the style object passed via <code>style_data</code> follows the same shape as the <code>styles</code> property of a <code>theme.json</code> partial.</p>
<pre><code class="language-php">register_block_style(
    array( 'core/group', 'core/columns' ),
    array(
        'name'       =&gt; 'green',
        'label'      =&gt; __( 'Green' ),
        'style_data' =&gt; array(
            'color'    =&gt; array(
                'background' =&gt; '#4f6f52',
                'text'       =&gt; '#d2e3c8',
            ),
            'blocks'   =&gt; array(
                'core/group' =&gt; array(
                    'color' =&gt; array(
                        'background' =&gt; '#739072',
                        'text'       =&gt; '#e3eedd',
                    ),
                ),
            ),
            'elements' =&gt; array(
                'link'   =&gt; array(
                    'color'  =&gt; array(
                        'text' =&gt; '#ead196',
                    ),
                    ':hover' =&gt; array(
                        'color' =&gt; array(
                            'text' =&gt; '#ebd9b4',
                        ),
                    ),
                ),
            ),
        ),
    )
);
</code></pre>
<h3 class="is-toc-heading" id="customtemplates" tabindex="-1"><a href="#customtemplates">customTemplates</a></h3>
<div class="callout callout-alert">Supported in WordPress from version 5.9.</div>
<p>Within this field themes can list the custom templates present in the <code>templates</code> folder. For example, for a custom template named <code>my-custom-template.html</code>, the <code>theme.json</code> can declare what post types can use it and what’s the title to show the user:</p>
<ul>
<li>name: mandatory.</li>
<li>title: mandatory, translatable.</li>
<li>postTypes: optional, only applies to the <code>page</code> by default.</li>
</ul>
<pre><code class="language-json">{
    "version": 3,
    "customTemplates": [
        {
            "name": "my-custom-template",
            "title": "The template title",
            "postTypes": [
                "page",
                "post",
                "my-cpt"
            ]
        }
    ]
}
</code></pre>
<h3 class="is-toc-heading" id="templateparts" tabindex="-1"><a href="#templateparts">templateParts</a></h3>
<div class="callout callout-alert">Supported in WordPress from version 5.9.</div>
<p>Within this field themes can list the template parts present in the <code>parts</code> folder. For example, for a template part named <code>my-template-part.html</code>, the <code>theme.json</code> can declare the area term for the template part entity which is responsible for rendering the corresponding block variation (Header block, Footer block, etc.) in the editor. Defining this area term in the json will allow the setting to persist across all uses of that template part entity, as opposed to a block attribute that would only affect one block. Defining area as a block attribute is not recommended as this is only used ‘behind the scenes’ to aid in bridging the gap between placeholder flows and entity creation.</p>
<p>Currently block variations exist for “header” and “footer” values of the area term, any other values and template parts not defined in the json will default to the general template part block. Variations will be denoted by specific icons within the editor’s interface, will default to the corresponding semantic HTML element for the wrapper (this can also be overridden by the <code>tagName</code> attribute set on the template part block), and will contextualize the template part allowing more custom flows in future editor improvements.</p>
<ul>
<li>name: mandatory.</li>
<li>title: optional, translatable.</li>
<li>area: optional, will be set to <code>uncategorized</code> by default and trigger no block variation.</li>
</ul>
<pre><code class="language-json">{
    "version": 3,
    "templateParts": [
        {
            "name": "my-template-part",
            "title": "Header",
            "area": "header"
        }
    ]
}
</code></pre>
<h3 class="is-toc-heading" id="patterns" tabindex="-1"><a href="#patterns">patterns</a></h3>
<div class="callout callout-alert">Supported in WordPress from version 6.0.</div>
<p>Within this field themes can list patterns to register from <a href="https://wordpress.org/patterns/">Pattern Directory</a>. The <code>patterns</code> field is an array of pattern <code>slugs</code> from the Pattern Directory. Pattern slugs can be extracted by the <code>url</code> in single pattern view at the Pattern Directory. For example in this url <code>https://wordpress.org/patterns/pattern/partner-logos` the slug is</code>partner-logos`.</p>
<pre><code class="language-json">{
    "version": 3,
    "patterns": [ "short-text-surrounded-by-round-images", "partner-logos" ]
}
</code></pre>
<h2 class="is-toc-heading" id="developing-with-theme-json" tabindex="-1"><a href="#developing-with-theme-json">Developing with theme.json</a></h2>
<p>It can be difficult to remember the theme.json settings and properties and which versions of WordPress support which settings while you develop, so it can be helpful to use the provided JSON schema for theme.json.</p>
<p>Many code editors support JSON schema and can provide help like tooltips, autocomplete, or schema validation right in your editor.</p>
<p>Theme.json schemas for each WordPress version are available at <code>https://schemas.wp.org/wp//theme.json`. For example a schema for WordPress 5.8 is available at</code>https://schemas.wp.org/wp/5.8/theme.json`. To ensure that you’re only using features available to your users, it’s best to use the oldest version that your theme supports.</p>
<p>The latest schema including all the latest changes from the Gutenberg plugin is available at `https://schemas.wp.org/trunk/theme.json`.</p>
<p>Check your editor’s documentation for JSON schema support. In Visual Studio Code, for example, you need to add <code>"$schema": "https://schemas.wp.org/wp/x.x/theme.json"</code> as a top-level property of your theme.json file, but other editors may be configured differently.</p>
<p><img alt="Example using validation with schema" data-recalc-dims="1" decoding="async" src="https://i0.wp.com/developer.wordpress.org/files/2021/11/theme-json-schema-updated.gif?ssl=1"/></p>
<h2 class="is-toc-heading" id="frequently-asked-questions" tabindex="-1"><a href="#frequently-asked-questions">Frequently Asked Questions</a></h2>
<h3 class="is-toc-heading" id="the-naming-schema-of-css-custom-properties" tabindex="-1"><a href="#the-naming-schema-of-css-custom-properties">The naming schema of CSS Custom Properties</a></h3>
<p>One thing you may have noticed is the naming schema used for the CSS Custom Properties the system creates, including the use of double hyphen, <code>--</code>, to separate the different “concepts”. Take the following examples.</p>
<p><strong>Presets</strong> such as <code>--wp--preset--color--black</code> can be divided into the following chunks:</p>
<ul>
<li><code>--wp</code>: prefix to namespace the CSS variable.</li>
<li><code>preset</code>: indicates is a CSS variable that belongs to the presets.</li>
<li><code>color</code>: indicates which preset category the variable belongs to. It can be <code>color</code>, <code>font-size</code>, <code>gradients</code>.</li>
<li><code>black</code>: the <code>slug</code> of the particular preset value.</li>
</ul>
<p><strong>Custom</strong> properties such as <code>--wp--custom--line-height--body</code>, which can be divided into the following chunks:</p>
<ul>
<li><code>--wp</code>: prefix to namespace the CSS variable.</li>
<li><code>custom</code>: indicates is a “free-form” CSS variable created by the theme.</li>
<li><code>line-height--body</code>: the result of converting the “custom” object keys into a string.</li>
</ul>
<p>The <code>--</code> as a separator has two functions:</p>
<ul>
<li>Readability, for human understanding. It can be thought as similar to the BEM naming schema, it separates “categories”.</li>
<li>Parsability, for machine understanding. Using a defined structure allows machines to understand the meaning of the property <code>--wp--preset--color--black</code>: it’s a value bounded to the color preset whose slug is “black”, which then gives us room to do more things with them.</li>
</ul>
<h3 class="is-toc-heading" id="why-using-as-a-separator" tabindex="-1"><a href="#why-using-as-a-separator">Why using — as a separator?</a></h3>
<p>We could have used any other separator, such as a single <code>-</code>.</p>
<p>However, that’d have been problematic, as it’d have been impossible to tell how <code>--wp-custom-line-height-template-header</code> should be converted back into an object, unless we force theme authors not to use <code>-</code> in their variable names.</p>
<p>By reserving <code>--</code> as a category separator and let theme authors use <code>-</code> for word-boundaries, the naming is clearer: <code>--wp--custom--line-height--template-header</code>.</p>
<h3 class="is-toc-heading" id="how-settings-under-custom-create-new-css-custom-properties" tabindex="-1"><a href="#how-settings-under-custom-create-new-css-custom-properties">How settings under “custom” create new CSS Custom Properties</a></h3>
<p>The algorithm to create CSS Variables out of the settings under the “custom” key works this way:</p>
<p>This is for clarity, but also because we want a mechanism to parse back a variable name such <code>--wp--custom--line-height--body</code> to its object form in theme.json. We use the same separation for presets.</p>
<p>For example:</p>
<div class="code-tabs"><button class="code-tab Input is-active" data-language="Input">Input</button><button class="code-tab Output" data-language="Output">Output</button>
<div class="code-tab-block Input is-active">
<pre><code class="language-json">{
    "version": 3,
    "settings": {
        "custom": {
            "lineHeight": {
                "body": 1.7
            },
            "font-primary": "-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen-Sans, Ubuntu, Cantarell, 'Helvetica Neue', sans-serif"
        }
    }
}
</code></pre>
</div>
<div class="code-tab-block Output">
<pre><code class="language-css">body {
    --wp--custom--line-height--body: 1.7;
    --wp--custom--font-primary: "-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen-Sans, Ubuntu, Cantarell, 'Helvetica Neue', sans-serif";
}
</code></pre>
</div>
</div>
<p>A few notes about this process:</p>
<ul>
<li><code>camelCased</code> keys are transformed into its <code>kebab-case</code> form, as to follow the CSS property naming schema. Example: <code>lineHeight</code> is transformed into <code>line-height</code>.</li>
<li>Keys at different depth levels are separated by <code>--</code>. That’s why <code>line-height</code> and <code>body</code> are separated by <code>--</code>.</li>
<li>You shouldn’t use <code>--</code> in the names of the keys within the <code>custom</code> object. Example, <strong>don’t do</strong> this:</li>
</ul>
<pre><code class="language-json">{
    "version": 3,
    "settings": {
        "custom": {
            "line--height": { // DO NOT DO THIS
                "body": 1.7
            }
        }
    }
}
</code></pre>
<h3 class="is-toc-heading" id="global-stylesheet" tabindex="-1"><a href="#global-stylesheet">Global Stylesheet</a></h3>
<p>In WordPress 5.8, the CSS for some of the presets defined by WordPress (font sizes, colors, and gradients) was loaded twice for most themes: in the block-library stylesheet plus in the global stylesheet. Additionally, there were slight differences in the CSS in both places.</p>
<p>In WordPress 5.9 release, CSS of presets are consolidated into the global stylesheet, that is now loaded for all themes. Each preset value generates a single CSS Custom Property and a class, as in:</p>
<pre><code class="language-css">/* CSS Custom Properties for the preset values */
body {
  --wp--preset--&lt;PRESET_TYPE&gt;--&lt;PRESET_SLUG&gt;: &lt;DEFAULT_VALUE&gt;;
  --wp--preset--color--pale-pink: #f78da7;
  --wp--preset--font-size--large: 36px;
  /* etc. */
}

/* CSS classes for the preset values */
.has-&lt;PRESET_SLUG&gt;-&lt;PRESET_TYPE&gt; { ... }
.has-pale-pink-color { color: var(--wp--preset--color--pale-pink) !important; }
.has-large-font-size { font-size: var(--wp--preset--font-size--large) !important; }
</code></pre>
<p>For themes to override the default values they can use the <code>theme.json</code> and provide the same slug. Themes that do not use a <code>theme.json</code> can still override the default values by enqueuing some CSS that sets the corresponding CSS Custom Property.</p>
<p><code>Example</code> (sets a new value for the default large font size):</p>
<pre><code class="language-css">body {
 --wp--preset--font-size--large: &lt;NEW_VALUE&gt;;
}
</code></pre>
<h3 class="is-toc-heading" id="specificity-for-link-colors-provided-by-the-user" tabindex="-1"><a href="#specificity-for-link-colors-provided-by-the-user">Specificity for link colors provided by the user</a></h3>
<p>In WordPress 5.8, when a user selected a link color for a specific block we attached a class to that block in the form of <code>.wp-element-&lt;ID&gt;</code> and then enqueued the following style:</p>
<pre><code class="language-css">.wp-element-&lt;ID&gt; a { color: &lt;USER_COLOR_VALUE&gt; !important; }
</code></pre>
<p>While this preserved user preferences at all times, the specificity was too strong and conflicted with some blocks with legit uses of an HTML element that shouldn’t be considered links. To <a href="https://github.com/WordPress/gutenberg/pull/34689">address this issue</a>, in WordPress 5.9 release, the <code>!important</code> was removed and updated the corresponding blocks to style the a elements with a specificity higher than the user link color, which now is:</p>
<pre><code class="language-css">.wp-element-&lt;ID&gt; a { color: &lt;USER_COLOR_VALUE&gt;; }
</code></pre>
<p>As a result of this change, it’s now the block author and theme author’s responsibility to make sure the user choices are respected at all times and that the link color provided by the user (specificity 011) is not overridden.</p>
<h3 class="is-toc-heading" id="what-is-blockgap-and-how-can-i-use-it" tabindex="-1"><a href="#what-is-blockgap-and-how-can-i-use-it">What is blockGap and how can I use it?</a></h3>
<p>For blocks that contain inner blocks, such as Group, Columns, Buttons, and Social Icons, <code>blockGap</code> controls the spacing between inner blocks. For <code>blockGap</code> to work, the block must also opt in to the <a href="https://developer.notmatt.press/block-editor/reference-guides/block-api/block-supports/#layout"><code>layout</code> block support</a>, which provides layout styles that can be adjusted via the block spacing controls. Depending on the layout of the block, the <code>blockGap</code> value will be output as either a vertical margin or a <code>gap</code> value. In the editor, the control for the <code>blockGap</code> value is called <em>Block spacing</em>, located in the Dimensions panel.</p>
<pre><code class="language-json">{
    "version": 3,
    "settings": {
        "spacing": {
            "blockGap": true,
        }
    },
    "styles": {
        "spacing": {
            "blockGap": "1.5rem"
        }
    }
}
</code></pre>
<p>The setting for <code>blockGap</code> is either a boolean or <code>null</code> value and is <code>null</code> by default. This allows an extra level of control over style output. The <code>settings.spacing.blockGap</code> setting in a <code>theme.json</code> file accepts the following values:</p>
<ul>
<li><code>true</code>: Opt into displaying <em>Block spacing</em> controls in the editor UI and output <code>blockGap</code> styles.</li>
<li><code>false</code>: Opt out of displaying <em>Block spacing</em> controls in the editor UI, with <code>blockGap</code> styles stored in <code>theme.json</code> still being rendered. This allows themes to use <code>blockGap</code> values without allowing users to make changes within the editor.</li>
<li><code>null</code> (default): Opt out of displaying <em>Block spacing</em> controls, <em>and</em> prevent the output of <code>blockGap</code> styles.</li>
</ul>
<p>The value defined for the root <code>styles.spacing.blockGap</code> style is also output as a CSS property, named <code>--wp--style--block-gap</code>.</p>
<h3 class="is-toc-heading" id="why-does-it-take-so-long-to-update-the-styles-in-the-browser" tabindex="-1"><a href="#why-does-it-take-so-long-to-update-the-styles-in-the-browser">Why does it take so long to update the styles in the browser?</a></h3>
<p>When you are actively developing with theme.json you may notice it takes 30+ seconds for your changes to show up in the browser, this is because <code>theme.json</code> is cached. To remove this caching issue, set either <a href="https://developer.notmatt.press/advanced-administration/debug/debug-wordpress/#wp_debug"><code>WP_DEBUG</code></a> or <a href="https://developer.notmatt.press/advanced-administration/debug/debug-wordpress/#script_debug"><code>SCRIPT_DEBUG</code></a> to ‘true’ in your <a href="https://developer.notmatt.press/advanced-administration/wordpress/wp-config/"><code>wp-config.php</code></a>. This tells WordPress to skip the cache and always use fresh data.</p>
</div></div>
    </div>
<footer class="text-center mt-10 py-5">
    <p class="text-sm"><a href="https://notmatt.press">NotMattPress</a>.</p>
</footer>
</body>
</html>
