
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Untitled Page</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@3.3.5/dist/tailwind.min.css" rel="stylesheet">
    <style>
        body {
            background-color: white;
            color: black;
            font-family: 'Quicksand', 'Open Sans', 'Helvetica', 'Arial', san-serif;
        }
        a, h1, h2, h3, h4, h5, h6 {
            color: #0073aa;
        }
        .container {
            max-width: 800px;
            margin: auto;
            padding: 20px;
        }
        .has-small-font-size.is-link-to-top {
            position: absolute;
            bottom: 10px;
            right: 10px;
        }
        .entry-content {
            position:relative;
        }
        .entry-content img {
            max-width: 100%;
        }
    </style>
</head>
<body>
<div class='container'>
    
    <div class="page-metadata" data-published="" data-last-updated=""></div>
    
    <div aria-label="Breadcrumbs" class="wp-block-wporg-site-breadcrumbs has-small-font-size" role="navigation"><div class="wporg-site-breadcrumbs__wrapper"><span><a href="https://developer.wordpress.org">Home</a></span><span><a href="https://developer.wordpress.org/block-editor/">Block Editor Handbook</a></span><span><a href="https://developer.wordpress.org/block-editor/reference-guides/">Reference Guides</a></span><span><a href="https://developer.wordpress.org/block-editor/reference-guides/packages/">Package Reference</a></span><span class="is-current-page">@wordpress/media-utils</span></div></div>  <!-- Full breadcrumbs HTML -->
    <h1>@wordpress/media-utils</h1>
    
    
    <div class="content"><div class="entry-content wp-block-post-content is-layout-flow wp-block-post-content-is-layout-flow"><p>The media utils package provides a set of artifacts to abstract media functionality that may be useful in situations where there is a need to deal with media uploads or with the media library, e.g., artifacts that extend or implement a block-editor.<br/>
This package is meant to be used by the WordPress core. It may not work as expected outside WordPress usages.</p>
<h2 class="is-toc-heading" id="installation" tabindex="-1"><a href="#installation">Installation</a></h2>
<p>Install the module</p>
<pre><code class="language-bash">npm install @wordpress/media-utils --save
</code></pre>
<p><em>This package assumes that your code will run in an <strong>ES2015+</strong> environment. If you’re using an environment that has limited or no support for such language features and APIs, you should include <a href="https://github.com/WordPress/gutenberg/tree/HEAD/packages/babel-preset-default#polyfill">the polyfill shipped in <code>@wordpress/babel-preset-default</code></a> in your code.</em></p>
<h2 class="is-toc-heading" id="api" tabindex="-1"><a href="#api">API</a></h2>
<p><!-- START TOKEN(Autogenerated API docs) --></p>
<h3 class="is-toc-heading" id="attachment" tabindex="-1"><a href="#attachment">Attachment</a></h3>
<p>Undocumented declaration.</p>
<h3 class="is-toc-heading" id="mediaupload" tabindex="-1"><a href="#mediaupload">MediaUpload</a></h3>
<p>Undocumented declaration.</p>
<h3 class="is-toc-heading" id="privateapis" tabindex="-1"><a href="#privateapis">privateApis</a></h3>
<p>Private @wordpress/media-utils APIs.</p>
<h3 class="is-toc-heading" id="restattachment" tabindex="-1"><a href="#restattachment">RestAttachment</a></h3>
<p>Undocumented declaration.</p>
<h3 class="is-toc-heading" id="transformattachment" tabindex="-1"><a href="#transformattachment">transformAttachment</a></h3>
<p>Transforms an attachment object from the REST API shape into the shape expected by the block editor and other consumers.</p>
<p><em>Parameters</em></p>
<ul>
<li><em>attachment</em> <code>RestAttachment</code>: REST API attachment object.</li>
</ul>
<h3 class="is-toc-heading" id="uploadmedia" tabindex="-1"><a href="#uploadmedia">uploadMedia</a></h3>
<p>Upload a media file when the file upload button is activated or when adding a file to the editor via drag &amp; drop.</p>
<p><em>Parameters</em></p>
<ul>
<li><em>$0</em> <code>UploadMediaArgs</code>: Parameters object passed to the function.</li>
<li><em>$0.allowedTypes</em> <code>UploadMediaArgs[ 'allowedTypes' ]</code>: Array with the types of media that can be uploaded, if unset all types are allowed.</li>
<li><em>$0.additionalData</em> <code>UploadMediaArgs[ 'additionalData' ]</code>: Additional data to include in the request.</li>
<li><em>$0.filesList</em> <code>UploadMediaArgs[ 'filesList' ]</code>: List of files.</li>
<li><em>$0.maxUploadFileSize</em> <code>UploadMediaArgs[ 'maxUploadFileSize' ]</code>: Maximum upload size in bytes allowed for the site.</li>
<li><em>$0.onError</em> <code>UploadMediaArgs[ 'onError' ]</code>: Function called when an error happens.</li>
<li><em>$0.onFileChange</em> <code>UploadMediaArgs[ 'onFileChange' ]</code>: Function called each time a file or a temporary representation of the file is available.</li>
<li><em>$0.wpAllowedMimeTypes</em> <code>UploadMediaArgs[ 'wpAllowedMimeTypes' ]</code>: List of allowed mime types and file extensions.</li>
<li><em>$0.signal</em> <code>UploadMediaArgs[ 'signal' ]</code>: Abort signal.</li>
</ul>
<h3 class="is-toc-heading" id="validatefilesize" tabindex="-1"><a href="#validatefilesize">validateFileSize</a></h3>
<p>Verifies whether the file is within the file upload size limits for the site.</p>
<p><em>Parameters</em></p>
<ul>
<li><em>file</em> <code>File</code>: File object.</li>
<li><em>maxUploadFileSize</em> <code>number</code>: Maximum upload size in bytes allowed for the site.</li>
</ul>
<h3 class="is-toc-heading" id="validatemimetype" tabindex="-1"><a href="#validatemimetype">validateMimeType</a></h3>
<p>Verifies if the caller (e.g. a block) supports this mime type.</p>
<p><em>Parameters</em></p>
<ul>
<li><em>file</em> <code>File</code>: File object.</li>
<li><em>allowedTypes</em> <code>string[]</code>: List of allowed mime types.</li>
</ul>
<h3 class="is-toc-heading" id="validatemimetypeforuser" tabindex="-1"><a href="#validatemimetypeforuser">validateMimeTypeForUser</a></h3>
<p>Verifies if the user is allowed to upload this mime type.</p>
<p><em>Parameters</em></p>
<ul>
<li><em>file</em> <code>File</code>: File object.</li>
<li><em>wpAllowedMimeTypes</em> <code>Record&lt; string, string &gt; | null</code>: List of allowed mime types and file extensions.</li>
</ul>
<p><!-- END TOKEN(Autogenerated API docs) --></p>
<h2 class="is-toc-heading" id="usage" tabindex="-1"><a href="#usage">Usage</a></h2>
<h3 class="is-toc-heading" id="uploadmedia-2" tabindex="-1"><a href="#uploadmedia-2">uploadMedia</a></h3>
<p>Media upload util is a function that allows the invokers to upload files to the WordPress media library.<br/>
As an example, provided that <code>myFiles</code> is an array of file objects, <code>handleFileChange</code> on onFileChange is a function that receives an array of objects containing the description of WordPress media items and <code>handleFileError</code> is a function that receives an object describing a possible error, the following code uploads a file to the WordPress media library:</p>
<pre><code class="language-js">wp.mediaUtils.utils.uploadMedia( {
    filesList: myFiles,
    onFileChange: handleFileChange,
    onError: handleFileError,
} );
</code></pre>
<p>The following code uploads a file named foo.txt with foo as content to the media library and alerts its URL:</p>
<pre><code class="language-js">wp.mediaUtils.utils.uploadMedia( {
    filesList: [ new File( [ 'foo' ], 'foo.txt', { type: 'text/plain' } ) ],
    onFileChange: ( [ fileObj ] ) =&gt; alert( fileObj.url ),
    onError: console.error,
} );
</code></pre>
<p>Beware that first onFileChange is called with temporary blob URLs and then with the final URL’s this allows to show the result in an optimistic UI as if the upload was already completed. E.g.: when uploading an image, one can show the image right away in the UI even before the upload is complete.</p>
<h3 class="is-toc-heading" id="mediaupload-2" tabindex="-1"><a href="#mediaupload-2">MediaUpload</a></h3>
<p>Media upload component provides a UI button that allows users to open the WordPress media library. It is normally used in conjunction with the filter <code>editor.MediaUpload</code>.<br/>
The component follows the interface specified in <a href="https://github.com/WordPress/gutenberg/blob/HEAD/packages/block-editor/src/components/media-upload/README.md">https://github.com/WordPress/gutenberg/blob/HEAD/packages/block-editor/src/components/media-upload/README.md</a>, and more details regarding its usage can be checked there.</p>
<h2 class="is-toc-heading" id="contributing-to-this-package" tabindex="-1"><a href="#contributing-to-this-package">Contributing to this package</a></h2>
<p>This is an individual package that’s part of the Gutenberg project. The project is organized as a monorepo. It’s made up of multiple self-contained software packages, each with a specific purpose. The packages in this monorepo are published to <a href="https://www.npmjs.com/">npm</a> and used by <a href="https://make.wordpress.org/core/">WordPress</a> as well as other software projects.</p>
<p>To find out more about contributing to this package or Gutenberg as a whole, please read the project’s main <a href="https://github.com/WordPress/gutenberg/tree/HEAD/CONTRIBUTING.md">contributor guide</a>.</p>
</div></div>
    </div>
<footer class="text-center mt-10 py-5">
    <p class="text-sm"><a href="https://notmatt.press">NotMattPress</a>.</p>
</footer>
</body>
</html>
