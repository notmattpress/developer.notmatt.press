
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Untitled Page</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@3.3.5/dist/tailwind.min.css" rel="stylesheet">
    <style>
        body {
            background-color: white;
            color: black;
            font-family: 'Quicksand', 'Open Sans', 'Helvetica', 'Arial', san-serif;
        }
        a, h1, h2, h3, h4, h5, h6 {
            color: #0073aa;
        }
        .container {
            max-width: 800px;
            margin: auto;
            padding: 20px;
        }
        .has-small-font-size.is-link-to-top {
            position: absolute;
            bottom: 10px;
            right: 10px;
        }
        .entry-content {
            position:relative;
        }
        .entry-content img {
            max-width: 100%;
        }
    </style>
</head>
<body>
<div class='container'>
    
    <div class="page-metadata" data-published="" data-last-updated=""></div>
    
    <div aria-label="Breadcrumbs" class="wp-block-wporg-site-breadcrumbs has-small-font-size" role="navigation"><div class="wporg-site-breadcrumbs__wrapper"><span><a href="https://developer.notmatt.press">Home</a></span><span><a href="https://developer.notmatt.press/reference/">Reference</a></span><span><a href="https://developer.notmatt.press/reference/hooks/">Hooks</a></span><span class="is-current-page">query_loop_block_query_vars</span></div></div>  <!-- Full breadcrumbs HTML -->
    <h1>query_loop_block_query_vars</h1>
    <h1 class="wp-block-wporg-code-reference-title" style="margin-bottom:40px;"><span class="hook-func">apply_filters</span>( ‘query_loop_block_query_vars’,  <nobr><span class="arg-type">array</span> <span class="arg-name">$query</span></nobr>,  <nobr><span class="arg-type">WP_Block</span> <span class="arg-name">$block</span></nobr>,  <nobr><span class="arg-type">int</span> <span class="arg-name">$page</span></nobr> )</h1>
    
    <div class="content"><div class="entry-content wp-block-post-content is-layout-flow wp-container-core-post-content-is-layout-1 wp-block-post-content-is-layout-flow">
<section class="wp-block-wporg-code-reference-summary"><p>Filters the arguments which will be passed to <code>WP_Query</code> for the Query Loop Block.</p>
</section>
<section class="wp-block-wporg-code-reference-description"><h2 class="is-toc-heading wp-block-heading has-heading-5-font-size" id="description" tabindex="-1"><a href="#description">Description</a></h2> <p>Anything to this filter should be compatible with the <code>WP_Query</code> API to form the query context which will be passed down to the Query Loop Block’s children.<br/>This can help, for example, to include additional settings or meta queries not directly supported by the core Query Loop Block, and extend its capabilities.</p>
<p>Please note that this will only influence the query that will be rendered on the front-end. The editor preview is not affected by this filter. Also, worth noting that the editor preview uses the REST API, so, ideally, one should aim to provide attributes which are also compatible with the REST API, in order to be able to implement identical queries on both sides.</p>
</section>
<section class="wp-block-wporg-code-reference-parameters"><h2 class="is-toc-heading wp-block-heading has-heading-5-font-size" id="parameters" tabindex="-1"><a href="#parameters">Parameters</a></h2> <dl><dt><code>$query</code><span class="type"><span class="array">array</span></span></dt><dd><div class="desc"><span class="description">Array containing parameters for <code>WP_Query</code> as parsed by the block context.</span></div></dd><dt><code>$block</code><span class="type"><span class="WP_Block"><a href="https://developer.notmatt.press/reference/classes/wp_block/" rel="class">WP_Block</a></span></span></dt><dd><div class="desc"><span class="description">Block instance.</span></div></dd><dt><code>$page</code><span class="type"><span class="int">int</span></span></dt><dd><div class="desc"><span class="description">Current query’s page.</span></div></dd></dl></section>
<section class="wp-block-wporg-code-reference-source"><h2 class="is-toc-heading wp-block-heading has-heading-5-font-size" id="source" tabindex="-1"><a href="#source">Source</a></h2> <pre aria-label="Function source code" class="wp-block-code" data-start="2617"><code class="language-php line-numbers" id="wporg-source-code" lang="php">return apply_filters( 'query_loop_block_query_vars', $query, $block, $page );
</code></pre><p class="wporg-dot-link-list"><a href="https://developer.notmatt.press/reference/files/wp-includes/blocks.php/">View all references</a> <a href="https://core.trac.notmatt.press/browser/tags/6.7/src/wp-includes/blocks.php#L2617">View on Trac</a> <a href="https://github.com/WordPress/wordpress-develop/blob/6.7/src/wp-includes/blocks.php#L2617-L2617">View on GitHub</a></p></section>
<section class="wp-block-wporg-code-reference-related" data-nosnippet="true"><h2 class="is-toc-heading wp-block-heading has-heading-5-font-size" id="related" tabindex="-1"><a href="#related">Related</a></h2> <section class="wp-block-wporg-code-table" id="used-by" style="margin-top:var(--wp--preset--spacing--20);"><figure class="wp-block-table"><table><thead><tr><th scope="col">Used by</th><th scope="col">Description</th></tr></thead><tbody><tr class=""><td><a href="https://developer.notmatt.press/reference/functions/build_query_vars_from_query_block/">build_query_vars_from_query_block()</a><code>wp-includes/blocks.php</code></td><td><p>Helper function that constructs a <a href="https://developer.notmatt.press/reference/classes/wp_query/" rel="class">WP_Query</a> args array from a <code>Query</code> block properties.</p>
</td></tr></tbody></table></figure></section> </section>
<section class="wp-block-wporg-code-reference-changelog"><h2 class="is-toc-heading wp-block-heading has-heading-5-font-size" id="changelog" tabindex="-1"><a href="#changelog">Changelog</a></h2> <section class="wp-block-wporg-code-table" style="margin-top:var(--wp--preset--spacing--20);"><figure class="wp-block-table"><table><thead><tr><th scope="col">Version</th><th scope="col">Description</th></tr></thead><tbody><tr class=""><td><a href="https://developer.notmatt.press/reference/since/6.1.0/">6.1.0</a></td><td>Introduced.</td></tr></tbody></table></figure></section> </section>
<section class="wp-block-wporg-code-reference-comments" data-nosnippet="true"><h2 class="is-toc-heading wp-block-heading" id="user-contributed-notes" tabindex="-1"><a href="#user-contributed-notes">User Contributed Notes</a></h2> <ol class="comment-list"> <li class="comment byuser comment-author-nicktrosnant even thread-even depth-1" data-comment-id="6300" id="comment-6300">
<article class="comment-body" id="div-comment-6300">
<a class="screen-reader-text" href="#comment-content-6300">Skip to note 3 content</a>

<!-- .comment-metadata -->
<div class="wporg-has-embedded-code comment-content" id="comment-content-6300">
<p>Here is an example of handing a custom post type which holds an event date field in metadata and where I wanted the Query Loop to display posts sorted by the event date rather than the post date.  I also wanted to exclude dates in the past.</p>
<pre class="wp-block-code"><code class="language-php line-numbers" lang="php">add_filter( 'query_loop_block_query_vars', 'wpdocs_filter_query' );
function wpdocs_filter_query( $query ) {
    // ignore if the query block is not using this post type
    if ( 'wpdocs_event' !== $query['post_type'] ) {
        return $query;
    }

    // always exclude events with dates in the past
    $query['meta_key'] = 'eventDate';
    $query['meta_value'] = date( 'Y-m-d' );
    $query['meta_compare'] = '&gt;=';

    // If date order was chosen in the block settings, change to use the Event date instead of Post date
    if ( 'date' === $query['orderby'] ) {
        $query['orderby'] = 'meta_value';
    }

    return $query;
}</code></pre>
</div><!-- .comment-content -->
<section class="wporg-has-embedded-code feedback hide-if-js" data-comment-count="0" id="feedback-6300">
</section><!-- .feedback -->

</article><!-- .comment-body -->
</li>
<li class="comment byuser comment-author-webmandesign odd alt thread-odd thread-alt depth-1" data-comment-id="6736" id="comment-6736">
<article class="comment-body" id="div-comment-6736">
<a class="screen-reader-text" href="#comment-content-6736">Skip to note 4 content</a>

<!-- .comment-metadata -->
<div class="wporg-has-embedded-code comment-content" id="comment-content-6736">
<p>Example of modifying the query based on the class name set on the <strong>Post Template</strong> block:</p>
<pre class="wp-block-code"><code class="language-php line-numbers" lang="php">function wpdocs_randomize_query( $query, $block ) {

	$block = $block-&gt;parsed_block;

	if (
		isset( $block['attrs']['className'] )
		&amp;&amp; false !== strpos( $block['attrs']['className'], 'randomize-content' )
	) {
		$query['orderby'] = 'rand';
	}

	return $query;
}

add_filter( 'query_loop_block_query_vars', 'wpdocs_randomize_query', 10, 2 );</code></pre>
</div><!-- .comment-content -->
<section class="wporg-has-embedded-code feedback hide-if-js" data-comment-count="0" id="feedback-6736">
</section><!-- .feedback -->

</article><!-- .comment-body -->
</li>
</ol></section>
</div></div>
    </div>
<footer class="text-center mt-10 py-5">
    <p class="text-sm"><a href="https://notmatt.press">NotMattPress</a>.</p>
</footer>
</body>
</html>
