
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Untitled Page</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@3.3.5/dist/tailwind.min.css" rel="stylesheet">
    <style>
        body {
            background-color: white;
            color: black;
            font-family: 'Quicksand', 'Open Sans', 'Helvetica', 'Arial', san-serif;
        }
        a, h1, h2, h3, h4, h5, h6 {
            color: #0073aa;
        }
        .container {
            max-width: 800px;
            margin: auto;
            padding: 20px;
        }
        .has-small-font-size.is-link-to-top {
            position: absolute;
            bottom: 10px;
            right: 10px;
        }
        .entry-content {
            position:relative;
        }
        .entry-content img {
            max-width: 100%;
        }
    </style>
</head>
<body>
<div class='container'>
    
    <div class="page-metadata" data-published="" data-last-updated=""></div>
    
    <div aria-label="Breadcrumbs" class="wp-block-wporg-site-breadcrumbs has-small-font-size" role="navigation"><div class="wporg-site-breadcrumbs__wrapper"><span><a href="https://developer.notmatt.press">Home</a></span><span><a href="https://developer.notmatt.press/reference/">Reference</a></span><span><a href="https://developer.notmatt.press/reference/hooks/">Hooks</a></span><span class="is-current-page">wp_img_tag_add_loading_attr</span></div></div>  <!-- Full breadcrumbs HTML -->
    <h1>wp_img_tag_add_loading_attr</h1>
    <h1 class="wp-block-wporg-code-reference-title" style="margin-bottom:40px;"><span class="hook-func">apply_filters</span>( ‘wp_img_tag_add_loading_attr’,  <nobr><span class="arg-type">string|bool</span> <span class="arg-name">$value</span></nobr>,  <nobr><span class="arg-type">string</span> <span class="arg-name">$image</span></nobr>,  <nobr><span class="arg-type">string</span> <span class="arg-name">$context</span></nobr> )</h1>
    
    <div class="content"><div class="entry-content wp-block-post-content is-layout-flow wp-container-core-post-content-is-layout-1 wp-block-post-content-is-layout-flow">
<section class="wp-block-wporg-code-reference-summary"><p>Filters the <code>loading</code> attribute value to add to an image. Default <code>lazy</code>.</p>
</section>
<section class="wp-block-wporg-code-reference-description"><h2 class="is-toc-heading wp-block-heading has-heading-5-font-size" id="description" tabindex="-1"><a href="#description">Description</a></h2> <p>Returning <code>false</code> or an empty string will not add the attribute.<br/>Returning <code>true</code> will add the default value.</p>
</section>
<section class="wp-block-wporg-code-reference-parameters"><h2 class="is-toc-heading wp-block-heading has-heading-5-font-size" id="parameters" tabindex="-1"><a href="#parameters">Parameters</a></h2> <dl><dt><code>$value</code><span class="type"><span class="string">string</span>|<span class="bool">bool</span></span></dt><dd><div class="desc"><span class="description">The <code>loading</code> attribute value. Returning a falsey value will result in                             the attribute being omitted for the image.</span></div></dd><dt><code>$image</code><span class="type"><span class="string">string</span></span></dt><dd><div class="desc"><span class="description">The HTML <code>img</code> tag to be filtered.</span></div></dd><dt><code>$context</code><span class="type"><span class="string">string</span></span></dt><dd><div class="desc"><span class="description">Additional context about how the function was called or where the img tag is.</span></div></dd></dl></section>
<section class="wp-block-wporg-code-reference-source"><h2 class="is-toc-heading wp-block-heading has-heading-5-font-size" id="source" tabindex="-1"><a href="#source">Source</a></h2> <pre aria-label="Function source code" class="wp-block-code" data-start="2046"><code class="language-php line-numbers" id="wporg-source-code" lang="php">$fetchpriority_val = preg_match( '/ fetchpriority=["\']([A-Za-z]+)["\']/', $image, $match_fetchpriority ) ? $match_fetchpriority[1] : null;
$decoding_val      = preg_match( '/ decoding=["\']([A-Za-z]+)["\']/', $image, $match_decoding ) ? $match_decoding[1] : null;

/*
 * Get loading optimization attributes to use.
 * This must occur before the conditional check below so that even images
</code></pre><p class="wporg-dot-link-list"><a href="https://developer.notmatt.press/reference/files/wp-includes/media.php/">View all references</a> <a href="https://core.trac.notmatt.press/browser/tags/6.7/src/wp-includes/media.php#L2046">View on Trac</a> <a href="https://github.com/WordPress/wordpress-develop/blob/6.7/src/wp-includes/media.php#L2046-L2051">View on GitHub</a></p></section>
<section class="wp-block-wporg-code-reference-changelog"><h2 class="is-toc-heading wp-block-heading has-heading-5-font-size" id="changelog" tabindex="-1"><a href="#changelog">Changelog</a></h2> <section class="wp-block-wporg-code-table" style="margin-top:var(--wp--preset--spacing--20);"><figure class="wp-block-table"><table><thead><tr><th scope="col">Version</th><th scope="col">Description</th></tr></thead><tbody><tr class=""><td><a href="https://developer.notmatt.press/reference/since/5.5.0/">5.5.0</a></td><td>Introduced.</td></tr></tbody></table></figure></section> </section>
<section class="wp-block-wporg-code-reference-comments" data-nosnippet="true"><h2 class="is-toc-heading wp-block-heading" id="user-contributed-notes" tabindex="-1"><a href="#user-contributed-notes">User Contributed Notes</a></h2> <ol class="comment-list"> <li class="comment byuser comment-author-gorostas odd alt thread-odd thread-alt depth-1" data-comment-id="5869" id="comment-5869">
<article class="comment-body" id="div-comment-5869">
<a class="screen-reader-text" href="#comment-content-5869">Skip to note 2 content</a>

<!-- .comment-metadata -->
<div class="wporg-has-embedded-code comment-content" id="comment-content-5869">
<p>tl;dr ⨪ this will fix your LCP in pagespeed report for lazy loaded images above the fold</p>
<p>This filter is very useful for images above the fold that don’t need to be lazy loaded (for example logos, featured images etc) so we can hook this filter to read our images and parse for example some custom class that can set lazy loading attribute ON or OFF per image.</p>
<p>– by setting custom class `skip-lazy` inside admin under `Advanced &gt; Additional Classes` inside image settings:</p>
<pre class="wp-block-code"><code class="language-php line-numbers" lang="php">add_filter( 'wp_img_tag_add_loading_attr', function( $value, $image ){
	if ( false !== strpos( $image, 'skip-lazy' ) ){
		return false;
	}
	return true;
}, 10, 2 );</code></pre>
<p>disables it</p>
</div><!-- .comment-content -->
<section class="wporg-has-embedded-code feedback hide-if-js" data-comment-count="0" id="feedback-5869">
</section><!-- .feedback -->

</article><!-- .comment-body -->
</li>
</ol></section>
</div></div>
    </div>
<footer class="text-center mt-10 py-5">
    <p class="text-sm"><a href="https://notmatt.press">NotMattPress</a>.</p>
</footer>
</body>
</html>
