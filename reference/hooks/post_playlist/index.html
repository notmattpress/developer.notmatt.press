
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Untitled Page</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@3.3.5/dist/tailwind.min.css" rel="stylesheet">
    <style>
        body {
            background-color: white;
            color: black;
            font-family: 'Quicksand', 'Open Sans', 'Helvetica', 'Arial', san-serif;
        }
        a, h1, h2, h3, h4, h5, h6 {
            color: #0073aa;
        }
        .container {
            max-width: 800px;
            margin: auto;
            padding: 20px;
        }
        .has-small-font-size.is-link-to-top {
            position: absolute;
            bottom: 10px;
            right: 10px;
        }
        .entry-content {
            position:relative;
        }
        .entry-content img {
            max-width: 100%;
        }
    </style>
</head>
<body>
<div class='container'>
    
    <div class="page-metadata" data-published="" data-last-updated=""></div>
    
    <div aria-label="Breadcrumbs" class="wp-block-wporg-site-breadcrumbs has-small-font-size" role="navigation"><div class="wporg-site-breadcrumbs__wrapper"><span><a href="https://developer.notmatt.press">Home</a></span><span><a href="https://developer.notmatt.press/reference/">Reference</a></span><span><a href="https://developer.notmatt.press/reference/hooks/">Hooks</a></span><span class="is-current-page">post_playlist</span></div></div>  <!-- Full breadcrumbs HTML -->
    <h1>post_playlist</h1>
    <h1 class="wp-block-wporg-code-reference-title" style="margin-bottom:40px;"><span class="hook-func">apply_filters</span>( ‘post_playlist’,  <nobr><span class="arg-type">string</span> <span class="arg-name">$output</span></nobr>,  <nobr><span class="arg-type">array</span> <span class="arg-name">$attr</span></nobr>,  <nobr><span class="arg-type">int</span> <span class="arg-name">$instance</span></nobr> )</h1>
    
    <div class="content"><div class="entry-content wp-block-post-content is-layout-flow wp-container-core-post-content-is-layout-1 wp-block-post-content-is-layout-flow">
<section class="wp-block-wporg-code-reference-summary"><p>Filters the playlist output.</p>
</section>
<section class="wp-block-wporg-code-reference-description"><h2 class="is-toc-heading wp-block-heading has-heading-5-font-size" id="description" tabindex="-1"><a href="#description">Description</a></h2> <p>Returning a non-empty value from the filter will short-circuit generation of the default playlist output, returning the passed value instead.</p>
</section>
<section class="wp-block-wporg-code-reference-parameters"><h2 class="is-toc-heading wp-block-heading has-heading-5-font-size" id="parameters" tabindex="-1"><a href="#parameters">Parameters</a></h2> <dl><dt><code>$output</code><span class="type"><span class="string">string</span></span></dt><dd><div class="desc"><span class="description">Playlist output. Default empty.</span></div></dd><dt><code>$attr</code><span class="type"><span class="array">array</span></span></dt><dd><div class="desc"><span class="description">An array of shortcode attributes.</span></div></dd><dt><code>$instance</code><span class="type"><span class="int">int</span></span></dt><dd><div class="desc"><span class="description">Unique numeric ID of this playlist shortcode instance.</span></div></dd></dl></section>
<section class="wp-block-wporg-code-reference-source"><h2 class="is-toc-heading wp-block-heading has-heading-5-font-size" id="source" tabindex="-1"><a href="#source">Source</a></h2> <pre aria-label="Function source code" class="wp-block-code" data-start="2938"><code class="language-php line-numbers" id="wporg-source-code" lang="php">*/
</code></pre><p class="wporg-dot-link-list"><a href="https://developer.notmatt.press/reference/files/wp-includes/media.php/">View all references</a> <a href="https://core.trac.notmatt.press/browser/tags/6.7/src/wp-includes/media.php#L2938">View on Trac</a> <a href="https://github.com/WordPress/wordpress-develop/blob/6.7/src/wp-includes/media.php#L2938-L2938">View on GitHub</a></p></section>
<section class="wp-block-wporg-code-reference-changelog"><h2 class="is-toc-heading wp-block-heading has-heading-5-font-size" id="changelog" tabindex="-1"><a href="#changelog">Changelog</a></h2> <section class="wp-block-wporg-code-table" style="margin-top:var(--wp--preset--spacing--20);"><figure class="wp-block-table"><table><thead><tr><th scope="col">Version</th><th scope="col">Description</th></tr></thead><tbody><tr class=""><td><a href="https://developer.notmatt.press/reference/since/4.2.0/">4.2.0</a></td><td><span class="since-description">The <code>$instance</code> parameter was added.</span></td></tr><tr class=""><td><a href="https://developer.notmatt.press/reference/since/3.9.0/">3.9.0</a></td><td>Introduced.</td></tr></tbody></table></figure></section> </section>
<section class="wp-block-wporg-code-reference-comments" data-nosnippet="true"><h2 class="is-toc-heading wp-block-heading" id="user-contributed-notes" tabindex="-1"><a href="#user-contributed-notes">User Contributed Notes</a></h2> <ol class="comment-list"> <li class="comment byuser comment-author-luboslives even thread-odd thread-alt depth-1" data-comment-id="4033" id="comment-4033">
<article class="comment-body" id="div-comment-4033">
<a class="screen-reader-text" href="#comment-content-4033">Skip to note 2 content</a>

<!-- .comment-metadata -->
<div class="wporg-has-embedded-code comment-content" id="comment-content-4033">
<p><strong>How to display the album art from your audio files in a size other than ‘thumbnail’:</strong></p>
<p>Sadly we can’t use responsive image sets with the default playlist / media player without completely rewriting the whole stack, which appears to involve jQuery, Backbone, undescore, a couple of mediaelement JS files, inlined JSON, and PHP templating. See <strong>/wp-includes⁩/js⁩/mediaelement/</strong> and <strong>/wp-includes/media.php</strong> and <strong>media-template.php</strong>.</p>
<p>The next-best thing we can do is to use a higher-res image for the album artwork thumbnail. The JS files will read from the inlined JSON data, and by default will use the specified “thumb” property. That’s all we’re updating with the code below.</p>
<p>1. Add a custom attribute to your <code>playlist</code> shortcode to signify which registered image size you’d like to use. We’ll use a <code>cover_size="medium"</code> attribute.</p>
<p><code>[playlist ids="121,82,84,43" cover_size="medium"]</code></p>
<p>2. Write your custom output using the <strong>post_playlist</strong> filter inside your functions.php file or elsewhere in your theme includes. Here I’ve removed any video playlist logic, see /wp-includes/media.php for the original.</p>
<pre class="wp-block-code"><code class="language-php line-numbers" lang="php">/**
 * Passing a non-empty value to the filter will short-circuit the default output.
 *
 * @param string $output   Playlist output. Default empty.
 * @param array  $attr     An array of shortcode attributes.
 * @param int    $instance Unique numeric ID of this playlist shortcode instance.
 */
function wpdocs_mytheme_custom_playlist( $output, $attr, $instance ) {

	if ( 'false' == $attr['images'] || 'video' == $attr['type'] ) {
		return;
	}

	$cover_size = $attr['cover_size'] || 'thumbnail';
	$post = get_post();

	if ( ! empty( $attr['ids'] ) ) {
		if ( empty( $attr['orderby'] ) ) {
			$attr['orderby'] = 'post__in';
		}
		$attr['include'] = $attr['ids'];
	}

	$atts = shortcode_atts(
		array(
			'type'         =&gt; 'audio',
			'order'        =&gt; 'ASC',
			'orderby'      =&gt; 'menu_order ID',
			'id'           =&gt; $post ? $post-&gt;ID : 0,
			'include'      =&gt; '',
			'exclude'      =&gt; '',
			'style'        =&gt; 'light',
			'tracklist'    =&gt; true,
			'tracknumbers' =&gt; true,
			'images'       =&gt; true,
			'artists'      =&gt; true,
		),
		$attr,
		'playlist'
	);

	$id = intval( $atts['id'] );

	$args = array(
		'post_status'    =&gt; 'inherit',
		'post_type'      =&gt; 'attachment',
		'post_mime_type' =&gt; $atts['type'],
		'order'          =&gt; $atts['order'],
		'orderby'        =&gt; $atts['orderby'],
	);

	if ( ! empty( $atts['include'] ) ) {
		$args['include'] = $atts['include'];
		$_attachments    = get_posts( $args );

		$attachments = array();
		foreach ( $_attachments as $key =&gt; $val ) {
			$attachments[ $val-&gt;ID ] = $_attachments[ $key ];
		}
	} elseif ( ! empty( $atts['exclude'] ) ) {
		$args['post_parent'] = $id;
		$args['exclude']     = $atts['exclude'];
		$attachments         = get_children( $args );
	} else {
		$args['post_parent'] = $id;
		$attachments         = get_children( $args );
	}

	if ( empty( $attachments ) ) {
		return '';
	}

	if ( is_feed() ) {
		$output = "n";
		foreach ( $attachments as $att_id =&gt; $attachment ) {
			$output .= wp_get_attachment_link( $att_id ) . "n";
		}
		return $output;
	}

	$data = array(
		'type'         =&gt; $atts['type'],
		'tracklist'    =&gt; wp_validate_boolean( $atts['tracklist'] ),
		'tracknumbers' =&gt; wp_validate_boolean( $atts['tracknumbers'] ),
		'images'       =&gt; wp_validate_boolean( $atts['images'] ),
		'artists'      =&gt; wp_validate_boolean( $atts['artists'] ),
	);

	$tracks = array();
	foreach ( $attachments as $attachment ) {
		$url   = wp_get_attachment_url( $attachment-&gt;ID );
		$ftype = wp_check_filetype( $url, wp_get_mime_types() );
		$track = array(
			'src'         =&gt; $url,
			'type'        =&gt; $ftype['type'],
			'title'       =&gt; $attachment-&gt;post_title,
			'caption'     =&gt; $attachment-&gt;post_excerpt,
			'description' =&gt; $attachment-&gt;post_content,
		);

		$track['meta'] = array();
		$meta          = wp_get_attachment_metadata( $attachment-&gt;ID );
		if ( ! empty( $meta ) ) {
			foreach ( wp_get_attachment_id3_keys( $attachment ) as $key =&gt; $label ) {
				if ( ! empty( $meta[ $key ] ) ) {
					$track['meta'][ $key ] = $meta[ $key ];
				}
			}
		}

		if ( $atts['images'] ) {
			$thumb_id = get_post_thumbnail_id( $attachment-&gt;ID );
			if ( ! empty( $thumb_id ) ) {
				list( $src, $width, $height ) = wp_get_attachment_image_src( $thumb_id, 'full' );
				$track['image']               = compact( 'src', 'width', 'height' );
				// use our custom size
				list( $src, $width, $height ) = wp_get_attachment_image_src( $thumb_id, $cover_size );
				$track['thumb']               = compact( 'src', 'width', 'height' );
			} else {
				$src            = wp_mime_type_icon( $attachment-&gt;ID );
				$width          = 48;
				$height         = 64;
				$track['image'] = compact( 'src', 'width', 'height' );
				$track['thumb'] = compact( 'src', 'width', 'height' );
			}
		}

		$tracks[] = $track;
	}
	$data['tracks'] = $tracks;

	$safe_type  = esc_attr( $atts['type'] );
	$safe_style = esc_attr( $atts['style'] );

	// begin output
	ob_start();

	if ( 1 === $instance ) {
		// Prints and enqueues playlist scripts, styles, and JavaScript templates.
		do_action( 'wp_playlist_scripts', $atts['type'], $atts['style'] );
	}
	?&gt;
	&lt;div class="wp-playlist wp-&lt;?php echo $safe_type; ?&gt;-playlist wp-playlist-&lt;?php echo $safe_style; ?&gt;"&gt;
		&lt;?php if ( 'audio' === $atts['type'] ) : ?&gt;
		&lt;div class="wp-playlist-current-item"&gt;&lt;/div&gt;
		&lt;?php endif ?&gt;
		&lt;&lt;?php echo $safe_type; ?&gt; controls="controls" preload="none"&gt;&lt;/&lt;?php echo $safe_type; ?&gt;&gt;
		&lt;div class="wp-playlist-next"&gt;&lt;/div&gt;
		&lt;div class="wp-playlist-prev"&gt;&lt;/div&gt;
		&lt;noscript&gt;
		&lt;ol&gt;
		&lt;?php
		foreach ( $attachments as $att_id =&gt; $attachment ) {
			printf( '&lt;li&gt;%s&lt;/li&gt;', wp_get_attachment_link( $att_id ) );
		}
		?&gt;
		&lt;/ol&gt;
		&lt;/noscript&gt;
		&lt;script type="application/json" class="wp-playlist-script"&gt;&lt;?php echo wp_json_encode( $data ); ?&gt;&lt;/script&gt;
	&lt;/div&gt;
	&lt;?php
	return ob_get_clean();
}
add_filter( 'post_playlist', 'mytheme_custom_playlist', 10, 3 );</code></pre>
</div><!-- .comment-content -->
<section class="wporg-has-embedded-code feedback hide-if-js" data-comment-count="1" id="feedback-4033">
<ul class="children">
<li class="comment byuser comment-author-luboslives odd alt depth-2" data-comment-id="4056" id="comment-4056">
<article class="comment-body" id="div-comment-4056">
<div class="wporg-has-embedded-code comment-content" id="comment-content-4056">
<div><strong>Correction:</strong> the conditional assignment should read <code>$cover_size = $attr['cover_size'] ?? 'thumbnail';</code> (using the null coalescing operator, PHP &gt;= 7.0)</div>
<div><a class="url" href="https://profiles.notmatt.press/luboslives/" rel="external nofollow">luboslives</a> <a class="comment-date" href="https://developer.notmatt.press/reference/hooks/post_playlist/#comment-4056"><time datetime="2020-07-16T12:05:06+00:00">5 years ago</time></a></div>
</div><!-- .comment-content -->
</article>
</li>
</ul>
</section><!-- .feedback -->

</article><!-- .comment-body -->
</li>
</ol></section>
</div></div>
    </div>
<footer class="text-center mt-10 py-5">
    <p class="text-sm"><a href="https://notmatt.press">NotMattPress</a>.</p>
</footer>
</body>
</html>
