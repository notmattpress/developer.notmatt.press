
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Untitled Page</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@3.3.5/dist/tailwind.min.css" rel="stylesheet">
    <style>
        body {
            background-color: white;
            color: black;
            font-family: 'Quicksand', 'Open Sans', 'Helvetica', 'Arial', san-serif;
        }
        a, h1, h2, h3, h4, h5, h6 {
            color: #0073aa;
        }
        .container {
            max-width: 800px;
            margin: auto;
            padding: 20px;
        }
        .has-small-font-size.is-link-to-top {
            position: absolute;
            bottom: 10px;
            right: 10px;
        }
        .entry-content {
            position:relative;
        }
        .entry-content img {
            max-width: 100%;
        }
    </style>
</head>
<body>
<div class='container'>
    
    <div class="page-metadata" data-published="" data-last-updated=""></div>
    
    <div aria-label="Breadcrumbs" class="wp-block-wporg-site-breadcrumbs has-small-font-size" role="navigation"><div class="wporg-site-breadcrumbs__wrapper"><span><a href="https://developer.notmatt.press">Home</a></span><span><a href="https://developer.notmatt.press/reference/">Reference</a></span><span><a href="https://developer.notmatt.press/reference/hooks/">Hooks</a></span><span><a href="https://developer.notmatt.press/reference/classes/wp_posts_list_table/extra_tablenav/">WP_Posts_List_Table::extra_tablenav</a></span><span class="is-current-page">restrict_manage_posts</span></div></div>  <!-- Full breadcrumbs HTML -->
    <h1>restrict_manage_posts</h1>
    <h1 class="wp-block-wporg-code-reference-title" style="margin-bottom:40px;"><span class="hook-func">do_action</span>( ‘restrict_manage_posts’,  <nobr><span class="arg-type">string</span> <span class="arg-name">$post_type</span></nobr>,  <nobr><span class="arg-type">string</span> <span class="arg-name">$which</span></nobr> )</h1>
    
    <div class="content"><div class="entry-content wp-block-post-content is-layout-flow wp-container-core-post-content-is-layout-1 wp-block-post-content-is-layout-flow">
<section class="wp-block-wporg-code-reference-summary"><p>Fires before the Filter button on the Posts and Pages list tables.</p>
</section>
<section class="wp-block-wporg-code-reference-description"><h2 class="is-toc-heading wp-block-heading has-heading-5-font-size" id="description" tabindex="-1"><a href="#description">Description</a></h2> <p>The Filter button allows sorting by date and/or category on the Posts list table, and sorting by date on the Pages list table.</p>
</section>
<section class="wp-block-wporg-code-reference-parameters"><h2 class="is-toc-heading wp-block-heading has-heading-5-font-size" id="parameters" tabindex="-1"><a href="#parameters">Parameters</a></h2> <dl><dt><code>$post_type</code><span class="type"><span class="string">string</span></span></dt><dd><div class="desc"><span class="description">The post type slug.</span></div></dd><dt><code>$which</code><span class="type"><span class="string">string</span></span></dt><dd><div class="desc"><span class="description">The location of the extra table nav markup:                          <code>'top'</code> or <code>'bottom'</code> for <a href="https://developer.notmatt.press/reference/classes/wp_posts_list_table/" rel="class">WP_Posts_List_Table</a>,                          <code>'bar'</code> for <a href="https://developer.notmatt.press/reference/classes/wp_media_list_table/" rel="class">WP_Media_List_Table</a>.</span></div></dd></dl></section>
<section class="wp-block-wporg-code-reference-source"><h2 class="is-toc-heading wp-block-heading has-heading-5-font-size" id="source" tabindex="-1"><a href="#source">Source</a></h2> <pre aria-label="Function source code" class="wp-block-code" data-start="594"><code class="language-php line-numbers" id="wporg-source-code" lang="php">do_action( 'restrict_manage_posts', $this-&gt;screen-&gt;post_type, $which );
</code></pre><p class="wporg-dot-link-list"><a href="https://developer.notmatt.press/reference/files/wp-admin/includes/class-wp-posts-list-table.php/">View all references</a> <a href="https://core.trac.notmatt.press/browser/tags/6.7/src/wp-admin/includes/class-wp-posts-list-table.php#L594">View on Trac</a> <a href="https://github.com/WordPress/wordpress-develop/blob/6.7/src/wp-admin/includes/class-wp-posts-list-table.php#L594-L594">View on GitHub</a></p></section>
<section class="wp-block-wporg-code-reference-related" data-nosnippet="true"><h2 class="is-toc-heading wp-block-heading has-heading-5-font-size" id="related" tabindex="-1"><a href="#related">Related</a></h2> <section class="wp-block-wporg-code-table" id="used-by" style="margin-top:var(--wp--preset--spacing--20);"><figure class="wp-block-table"><table><thead><tr><th scope="col">Used by</th><th scope="col">Description</th></tr></thead><tbody><tr class=""><td><a href="https://developer.notmatt.press/reference/classes/wp_media_list_table/extra_tablenav/">WP_Media_List_Table::extra_tablenav()</a><code>wp-admin/includes/class-wp-media-list-table.php</code></td><td></td></tr><tr class=""><td><a href="https://developer.notmatt.press/reference/classes/wp_posts_list_table/extra_tablenav/">WP_Posts_List_Table::extra_tablenav()</a><code>wp-admin/includes/class-wp-posts-list-table.php</code></td><td></td></tr></tbody></table></figure></section> </section>
<section class="wp-block-wporg-code-reference-changelog"><h2 class="is-toc-heading wp-block-heading has-heading-5-font-size" id="changelog" tabindex="-1"><a href="#changelog">Changelog</a></h2> <section class="wp-block-wporg-code-table" style="margin-top:var(--wp--preset--spacing--20);"><figure class="wp-block-table"><table><thead><tr><th scope="col">Version</th><th scope="col">Description</th></tr></thead><tbody><tr class=""><td><a href="https://developer.notmatt.press/reference/since/4.6.0/">4.6.0</a></td><td><span class="since-description">The <code>$which</code> parameter was added.</span></td></tr><tr class=""><td><a href="https://developer.notmatt.press/reference/since/4.4.0/">4.4.0</a></td><td><span class="since-description">The <code>$post_type</code> parameter was added.</span></td></tr><tr class=""><td><a href="https://developer.notmatt.press/reference/since/2.1.0/">2.1.0</a></td><td>Introduced.</td></tr></tbody></table></figure></section> </section>
<section class="wp-block-wporg-code-reference-comments" data-nosnippet="true"><h2 class="is-toc-heading wp-block-heading" id="user-contributed-notes" tabindex="-1"><a href="#user-contributed-notes">User Contributed Notes</a></h2> <ol class="comment-list"> <li class="comment byuser comment-author-roytanck even thread-even depth-1" data-comment-id="3034" id="comment-3034">
<article class="comment-body" id="div-comment-3034">
<a class="screen-reader-text" href="#comment-content-3034">Skip to note 5 content</a>

<!-- .comment-metadata -->
<div class="wporg-has-embedded-code comment-content" id="comment-content-3034">
<p>The example below eliminates the need for <code>parse_query</code> when filtering based on taxonomy. It uses the taxonomy slug as URL parameter, just like WordPress does out of the box. The example adds filter dropdowns for two taxonomies, and allows for boolean AND filtering.</p>
<pre class="wp-block-code"><code class="language-php line-numbers" lang="php">add_action( 'restrict_manage_posts', 'add_admin_filters', 10, 1 );

public function add_admin_filters( $post_type ){
	if( 'my_post_type' !== $post_type ){
		return;
	}
	$taxonomies_slugs = array(
		'my_taxonomy',
		'my_other_taxonomy'
	);
	// loop through the taxonomy filters array
	foreach( $taxonomies_slugs as $slug ){
		$taxonomy = get_taxonomy( $slug );
		$selected = '';
		// if the current page is already filtered, get the selected term slug
		$selected = isset( $_REQUEST[ $slug ] ) ? $_REQUEST[ $slug ] : '';
		// render a dropdown for this taxonomy's terms
		wp_dropdown_categories( array(
			'show_option_all' =&gt;  $taxonomy-&gt;labels-&gt;all_items,
			'taxonomy'        =&gt;  $slug,
			'name'            =&gt;  $slug,
			'orderby'         =&gt;  'name',
			'value_field'     =&gt;  'slug',
			'selected'        =&gt;  $selected,
			'hierarchical'    =&gt;  true,
		) );
	}
}</code></pre>
</div><!-- .comment-content -->
<section class="wporg-has-embedded-code feedback hide-if-js" data-comment-count="0" id="feedback-3034">
</section><!-- .feedback -->

</article><!-- .comment-body -->
</li>
<li class="comment byuser comment-author-aurovrata odd alt thread-odd thread-alt depth-1" data-comment-id="2173" id="comment-2173">
<article class="comment-body" id="div-comment-2173">
<a class="screen-reader-text" href="#comment-content-2173">Skip to note 6 content</a>

<!-- .comment-metadata -->
<div class="wporg-has-embedded-code comment-content" id="comment-content-2173">
<p>Use this hook to add a custom taxonomy filter for your post table, </p>
<pre class="wp-block-code"><code class="language-php line-numbers" lang="php">add_action( 'restrict_manage_posts', 'my_post_type_filter', 10, 2 );
function my_post_type_filter( $post_type, $which ) {
	if ( 'my-post' !== $post_type ) {
		return; //check to make sure this is your cpt
	}

	$taxonomy_slug = 'my-post-type';
	$taxonomy      = get_taxonomy($taxonomy_slug);
	$selected      = '';
	$request_attr  = 'my_type'; //this will show up in the url
 
	if ( isset( $_REQUEST[ $request_attr ] ) ) {
		$selected = $_REQUEST[ $request_attr ]; //in case the current page is already filtered
	}
    
	wp_dropdown_categories(array(
		'show_option_all' =&gt;  __("Show All {$taxonomy-&gt;label}"),
		'taxonomy'        =&gt;  $taxonomy_slug,
		'name'            =&gt;  $request_attr,
		'orderby'         =&gt;  'name',
		'selected'        =&gt;  $selected,
		'hierarchical'    =&gt;  true,
		'depth'           =&gt;  3,
		'show_count'      =&gt;  true, // Show number of post in parent term
		'hide_empty'      =&gt;  false, // Don't show posts w/o terms
	) );
}</code></pre>
</div><!-- .comment-content -->
<section class="wporg-has-embedded-code feedback hide-if-js" data-comment-count="0" id="feedback-2173">
</section><!-- .feedback -->

</article><!-- .comment-body -->
</li>
<li class="comment byuser comment-author-aurovrata even thread-even depth-1" data-comment-id="2175" id="comment-2175">
<article class="comment-body" id="div-comment-2175">
<a class="screen-reader-text" href="#comment-content-2175">Skip to note 7 content</a>

<!-- .comment-metadata -->
<div class="wporg-has-embedded-code comment-content" id="comment-content-2175">
<p>To add a custom filter based on a meta field for example, you can build a custom dropdown filter,</p>
<pre class="wp-block-code"><code class="language-php line-numbers" lang="php">add_action('restrict_manage_posts','location_filtering',10);
function location_filtering($post_type){
    if('my-custom-post' !== $post_type){
      return; //filter your post
    }
    $selected = '';
    $request_attr = 'my_loc';
    if ( isset($_REQUEST[$request_attr]) ) {
      $selected = $_REQUEST[$request_attr];
    }
    //get unique values of the meta field to filer by.
	$meta_key = 'my_custom_field_location';
	global $wpdb;
	$result = $wpdb-&gt;get_col( 
		$wpdb-&gt;prepare( "
			SELECT DISTINCT pm.meta_value FROM {$wpdb-&gt;postmeta} pm
			LEFT JOIN {$wpdb-&gt;posts} p ON p.ID = pm.post_id
			WHERE pm.meta_key = '%s' 
			AND p.post_status IN ('publish', 'draft')
			ORDER BY pm.meta_value", 
			$meta_key
		) 
    );
   //build a custom dropdown list of values to filter by
    echo '&lt;select id="my-loc" name="my_loc"&gt;';
    echo '&lt;option value="0"&gt;' . __( 'Show all locations', 'my-custom-domain' ) . ' &lt;/option&gt;';
    foreach($results as $location){
      $select = ($org-&gt;ID == $selected) ? ' selected="selected"':'';
      echo '&lt;option value="'.$location.'"'.$select.'&gt;' . $location . ' &lt;/option&gt;';
    }
    echo '&lt;/select&gt;';
  }</code></pre>
<p>next we need to ensure the admin query returns the correct set of filtered posts by hooking onto the ‘parse_query’ filter,</p>
<pre class="wp-block-code"><code class="language-php line-numbers" lang="php">add_filter( 'parse_query', 'filter_request_query' , 10);
function filter_request_query($query){
    //modify the query only if it admin and main query.
    if( !(is_admin() AND $query-&gt;is_main_query()) ){ 
      return $query;
    }
    //we want to modify the query for the targeted custom post and filter option
    if( !('my-custom-post' === $query-&gt;query['post_type'] AND isset($_REQUEST['my_loc']) ) ){
      return $query;
    }
    //for the default value of our filter no modification is required
    if(0 == $_REQUEST['my_loc']){
      return $query;
    }
   //modify the query_vars.
    $query-&gt;query_vars = array(array(
      'field' =&gt; 'my_custom_field_location',
      'value' =&gt; $_REQUEST['my_loc'],
      'compare' =&gt; '=',
      'type' =&gt; 'CHAR'
    ));
    return $query;
  }</code></pre>
<p>To build more complex meta field queries, lookup the documentation for the <code>WP_Meta_Query</code> object.</p>
</div><!-- .comment-content -->
<section class="wporg-has-embedded-code feedback hide-if-js" data-comment-count="0" id="feedback-2175">
</section><!-- .feedback -->

</article><!-- .comment-body -->
</li>
<li class="comment byuser comment-author-aurovrata odd alt thread-odd thread-alt depth-1" data-comment-id="2176" id="comment-2176">
<article class="comment-body" id="div-comment-2176">
<a class="screen-reader-text" href="#comment-content-2176">Skip to note 8 content</a>

<!-- .comment-metadata -->
<div class="wporg-has-embedded-code comment-content" id="comment-content-2176">
<p>Use this hook to add a custom taxonomy filter for your post table, </p>
<pre class="wp-block-code"><code class="language-php line-numbers" lang="php">add_action('restrict_manage_posts','my_post_type_filter',10,2);
function my_post_type_filter($post_type, $which){
    if('my-post' !== $post_type){
      return; //check to make sure this is your cpt
    }
    $taxonomy_slug = 'my-post-type';
    $taxonomy = get_taxonomy($taxonomy_slug);
    $selected = '';
    $request_attr = 'my_type'; //this will show up in the url
    if ( isset($_REQUEST[$request_attr] ) ) {
      $selected = $_REQUEST[$request_attr]; //in case the current page is already filtered
    }
    wp_dropdown_categories(array(
      'show_option_all' =&gt;  __("Show All {$taxonomy-&gt;label}"),
      'taxonomy'        =&gt;  $taxonomy_slug,
      'name'            =&gt;  $request_attr,
      'orderby'         =&gt;  'name',
      'selected'        =&gt;  $selected,
      'hierarchical'    =&gt;  true,
      'depth'           =&gt;  3,
      'show_count'      =&gt;  true, // Show number of post in parent term
      'hide_empty'      =&gt;  false, // Don't show posts w/o terms
    ));
  }</code></pre>
<p>to ensure the post table is correctly filtered, the post query needs to be modified to filter the selected term. This is done by hooking the <code>'parse_query'</code> filter,</p>
<pre class="wp-block-code"><code class="language-php line-numbers" lang="php">add_filter( 'parse_query', 'filter_request_query' , 10);
function filter_request_query($query){
    //modify the query only if it is admin and main query.
    if( !(is_admin() AND $query-&gt;is_main_query()) ){ 
      return $query;
    }
    //we want to modify the query for the targeted custom post.
    if( 'my-post' !== $query-&gt;query['post_type'] ){
      return $query;
    }
    //type filter
    if( isset($_REQUEST['my_type']) &amp;&amp;  0 != $_REQUEST['my_type']){
      $term =  $_REQUEST['my_type'];
      $taxonomy_slug = 'my-post-type';
      $query-&gt;query_vars['tax_query'] = array(
        array(
            'taxonomy'  =&gt; $taxonomy_slug,
            'field'     =&gt; 'ID',
            'terms'     =&gt; array($term)
        )
      );
    }
    return $query;
}</code></pre>
</div><!-- .comment-content -->
<section class="wporg-has-embedded-code feedback hide-if-js" data-comment-count="0" id="feedback-2176">
</section><!-- .feedback -->

</article><!-- .comment-body -->
</li>
</ol></section>
</div></div>
    </div>
<footer class="text-center mt-10 py-5">
    <p class="text-sm"><a href="https://notmatt.press">NotMattPress</a>.</p>
</footer>
</body>
</html>
