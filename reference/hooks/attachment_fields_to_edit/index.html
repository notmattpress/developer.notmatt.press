
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Untitled Page</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@3.3.5/dist/tailwind.min.css" rel="stylesheet">
    <style>
        body {
            background-color: white;
            color: black;
            font-family: 'Quicksand', 'Open Sans', 'Helvetica', 'Arial', san-serif;
        }
        a, h1, h2, h3, h4, h5, h6 {
            color: #0073aa;
        }
        .container {
            max-width: 800px;
            margin: auto;
            padding: 20px;
        }
        .has-small-font-size.is-link-to-top {
            position: absolute;
            bottom: 10px;
            right: 10px;
        }
        .entry-content {
            position:relative;
        }
        .entry-content img {
            max-width: 100%;
        }
    </style>
</head>
<body>
<div class='container'>
    
    <div class="page-metadata" data-published="" data-last-updated=""></div>
    
    <div aria-label="Breadcrumbs" class="wp-block-wporg-site-breadcrumbs has-small-font-size" role="navigation"><div class="wporg-site-breadcrumbs__wrapper"><span><a href="https://developer.notmatt.press">Home</a></span><span><a href="https://developer.notmatt.press/reference/">Reference</a></span><span><a href="https://developer.notmatt.press/reference/hooks/">Hooks</a></span><span class="is-current-page">attachment_fields_to_edit</span></div></div>  <!-- Full breadcrumbs HTML -->
    <h1>attachment_fields_to_edit</h1>
    <h1 class="wp-block-wporg-code-reference-title" style="margin-bottom:40px;"><span class="hook-func">apply_filters</span>( ‘attachment_fields_to_edit’,  <nobr><span class="arg-type">array</span> <span class="arg-name">$form_fields</span></nobr>,  <nobr><span class="arg-type">WP_Post</span> <span class="arg-name">$post</span></nobr> )</h1>
    
    <div class="content"><div class="entry-content wp-block-post-content is-layout-flow wp-container-core-post-content-is-layout-1 wp-block-post-content-is-layout-flow">
<section class="wp-block-wporg-code-reference-summary"><p>Filters the attachment fields to edit.</p>
</section>
<section class="wp-block-wporg-code-reference-parameters"><h2 class="is-toc-heading wp-block-heading has-heading-5-font-size" id="parameters" tabindex="-1"><a href="#parameters">Parameters</a></h2> <dl><dt><code>$form_fields</code><span class="type"><span class="array">array</span></span></dt><dd><div class="desc"><span class="description">An array of attachment form fields.</span></div></dd><dt><code>$post</code><span class="type"><span class="WP_Post"><a href="https://developer.notmatt.press/reference/classes/wp_post/" rel="class">WP_Post</a></span></span></dt><dd><div class="desc"><span class="description">The <a href="https://developer.notmatt.press/reference/classes/wp_post/" rel="class">WP_Post</a> attachment object.</span></div></dd></dl></section>
<section class="wporg-has-embedded-code wp-block-wporg-code-reference-explanation"><h2 class="is-toc-heading wp-block-heading has-heading-5-font-size" id="more-information" tabindex="-1"><a href="#more-information">More Information</a></h2>
<ul class="wp-block-list">
<li>WordPress does not pass standard fields through this filter, though this can still be used for adding attachment form fields.</li>
<li>Note that the filter function <strong>must</strong> return an array of attachment form fields after it is finished processing; otherwise, no fields will be displayed when editing an attachment and other plugins also filtering the <code>$form_fields</code> array may generate errors.</li>
</ul>
</section>
<section class="wp-block-wporg-code-reference-source"><h2 class="is-toc-heading wp-block-heading has-heading-5-font-size" id="source" tabindex="-1"><a href="#source">Source</a></h2> <pre aria-label="Function source code" class="wp-block-code" data-start="1509"><code class="language-php line-numbers" id="wporg-source-code" lang="php">$form_fields = apply_filters( 'attachment_fields_to_edit', $form_fields, $post );
</code></pre><p class="wporg-dot-link-list"><a href="https://developer.notmatt.press/reference/files/wp-admin/includes/media.php/">View all references</a> <a href="https://core.trac.notmatt.press/browser/tags/6.7/src/wp-admin/includes/media.php#L1509">View on Trac</a> <a href="https://github.com/WordPress/wordpress-develop/blob/6.7/src/wp-admin/includes/media.php#L1509-L1509">View on GitHub</a></p></section>
<section class="wp-block-wporg-code-reference-related" data-nosnippet="true"><h2 class="is-toc-heading wp-block-heading has-heading-5-font-size" id="related" tabindex="-1"><a href="#related">Related</a></h2> <section class="wp-block-wporg-code-table" id="used-by" style="margin-top:var(--wp--preset--spacing--20);"><figure class="wp-block-table"><table><thead><tr><th scope="col">Used by</th><th scope="col">Description</th></tr></thead><tbody><tr class=""><td><a href="https://developer.notmatt.press/reference/functions/get_attachment_fields_to_edit/">get_attachment_fields_to_edit()</a><code>wp-admin/includes/media.php</code></td><td><p>Retrieves the attachment fields to edit form fields.</p>
</td></tr><tr class=""><td><a href="https://developer.notmatt.press/reference/functions/get_compat_media_markup/">get_compat_media_markup()</a><code>wp-admin/includes/media.php</code></td><td></td></tr></tbody></table></figure></section> </section>
<section class="wp-block-wporg-code-reference-changelog"><h2 class="is-toc-heading wp-block-heading has-heading-5-font-size" id="changelog" tabindex="-1"><a href="#changelog">Changelog</a></h2> <section class="wp-block-wporg-code-table" style="margin-top:var(--wp--preset--spacing--20);"><figure class="wp-block-table"><table><thead><tr><th scope="col">Version</th><th scope="col">Description</th></tr></thead><tbody><tr class=""><td><a href="https://developer.notmatt.press/reference/since/2.5.0/">2.5.0</a></td><td>Introduced.</td></tr></tbody></table></figure></section> </section>
<section class="wp-block-wporg-code-reference-comments" data-nosnippet="true"><h2 class="is-toc-heading wp-block-heading" id="user-contributed-notes" tabindex="-1"><a href="#user-contributed-notes">User Contributed Notes</a></h2> <ol class="comment-list"> <li class="comment byuser comment-author-raazon even thread-even depth-1" data-comment-id="2713" id="comment-2713">
<article class="comment-body" id="div-comment-2713">
<a class="screen-reader-text" href="#comment-content-2713">Skip to note 5 content</a>

<!-- .comment-metadata -->
<div class="wporg-has-embedded-code comment-content" id="comment-content-2713">
<p>This is the way to add custom fields to attachments:</p>
<pre class="wp-block-code"><code class="language-php line-numbers" lang="php">// Add custom text/textarea attachment field
function add_custom_text_field_to_attachment_fields_to_edit( $form_fields, $post ) {
    $text_field = get_post_meta($post-&gt;ID, 'text_field', true);
    $form_fields['text_field'] = array(
        'label' =&gt; 'Custom text field',
        'input' =&gt; 'text', // you may alos use 'textarea' field
        'value' =&gt; $text_field,
        'helps' =&gt; 'This is help text'
    );
    return $form_fields;
}
add_filter('attachment_fields_to_edit', 'add_custom_text_field_to_attachment_fields_to_edit', null, 2); 

// Save custom text/textarea attachment field
function save_custom_text_attachment_field($post, $attachment) {  
    if( isset($attachment['text_field']) ){  
        update_post_meta($post['ID'], 'text_field', sanitize_text_field( $attachment['text_field'] ) );  
    }else{
         delete_post_meta($post['ID'], 'text_field' );
    }
    return $post;  
}
add_filter('attachment_fields_to_save', 'save_custom_text_attachment_field', null, 2);


// Add custom checkbox attachment field
function add_custom_checkbox_field_to_attachment_fields_to_edit( $form_fields, $post ) {
    $checkbox_field = (bool) get_post_meta($post-&gt;ID, 'checkbox_field', true);
    $form_fields['checkbox_field'] = array(
        'label' =&gt; 'Checkbox',
        'input' =&gt; 'html',
        'html' =&gt; '&lt;input type="checkbox" id="attachments-'.$post-&gt;ID.'-checkbox_field" name="attachments['.$post-&gt;ID.'][checkbox_field]" value="1"'.($checkbox_field ? ' checked="checked"' : '').' /&gt; ',
        'value' =&gt; $checkbox_field,
        'helps' =&gt; ''
    );
	return $form_fields;
}
add_filter('attachment_fields_to_edit', 'add_custom_checkbox_field_to_attachment_fields_to_edit', null, 2); 

// Save custom checkbox attachment field
function save_custom_checkbox_attachment_field($post, $attachment) {  
    if( isset($attachment['checkbox_field']) ){  
        update_post_meta($post['ID'], 'checkbox_field', sanitize_text_field( $attachment['checkbox_field'] ) );  
    }else{
         delete_post_meta($post['ID'], 'checkbox_field' );
    }
    return $post;  
}
add_filter('attachment_fields_to_save', 'save_custom_checkbox_attachment_field', null, 2);</code></pre>
</div><!-- .comment-content -->
<section class="wporg-has-embedded-code feedback hide-if-js" data-comment-count="0" id="feedback-2713">
</section><!-- .feedback -->

</article><!-- .comment-body -->
</li>
<li class="comment byuser comment-author-stevenlinx odd alt thread-odd thread-alt depth-1" data-comment-id="4744" id="comment-4744">
<article class="comment-body" id="div-comment-4744">
<a class="screen-reader-text" href="#comment-content-4744">Skip to note 6 content</a>

<!-- .comment-metadata -->
<div class="wporg-has-embedded-code comment-content" id="comment-content-4744">
<p>Example migrated from Codex:</p>
<p>The following example adds a “Location” field for all attachments. This example also uses the “<a href="https://developer.notmatt.press/reference/hooks/edit_attachment/">edit_attachment</a>” action hook to save the submitted custom attachment form fields value to the post meta of the post in which the attachment belongs.</p>
<pre class="wp-block-code"><code class="language-php line-numbers" lang="php">add_filter( 'attachment_fields_to_edit', 'my_add_attachment_location_field', 10, 2 );

function my_add_attachment_location_field( $form_fields, $post ) {
    $field_value = get_post_meta( $post-&gt;ID, 'location', true );
    $form_fields['location'] = array(
        'value' =&gt; $field_value ? $field_value : '',
        'label' =&gt; __( 'Location' ),
        'helps' =&gt; __( 'Set a location for this attachment' )
    );
    return $form_fields;
}

add_action( 'edit_attachment', 'my_save_attachment_location' );

function my_save_attachment_location( $attachment_id ) {
    if ( isset( $_REQUEST['attachments'][$attachment_id]['location'] ) ) {
        $location = $_REQUEST['attachments'][$attachment_id]['location'];
        update_post_meta( $attachment_id, 'location', $location );
    }
}</code></pre>
</div><!-- .comment-content -->
<section class="wporg-has-embedded-code feedback hide-if-js" data-comment-count="0" id="feedback-4744">
</section><!-- .feedback -->

</article><!-- .comment-body -->
</li>
<li class="comment byuser comment-author-dionysous even thread-even depth-1" data-comment-id="4856" id="comment-4856">
<article class="comment-body" id="div-comment-4856">
<a class="screen-reader-text" href="#comment-content-4856">Skip to note 7 content</a>

<!-- .comment-metadata -->
<div class="wporg-has-embedded-code comment-content" id="comment-content-4856">
<p>If you add a custom field to attachments as described above, the field will be displayed and saved as well. <strong>But:</strong> There is no complete Ajax feedback to the user: the save icon appears in the top-right corner. “attachment-details” gets the class “save-waiting”, then again “save-ready”. The class “save-complete” is omitted. For the standard fields again this status is displayed. The text “Saved.” appears. This should be displayed for custom fields, too!</p>
</div><!-- .comment-content -->
<section class="wporg-has-embedded-code feedback hide-if-js" data-comment-count="0" id="feedback-4856">
</section><!-- .feedback -->

</article><!-- .comment-body -->
</li>
<li class="comment byuser comment-author-_smartik_ odd alt thread-odd thread-alt depth-1" data-comment-id="6980" id="comment-6980">
<article class="comment-body" id="div-comment-6980">
<a class="screen-reader-text" href="#comment-content-6980">Skip to note 8 content</a>

<!-- .comment-metadata -->
<div class="wporg-has-embedded-code comment-content" id="comment-content-6980">
<p>There are “text” and “textarea” field types that can be used by default. To have another field type, you can simply use the “html” type. Here is an example of how to add a button: </p>
<pre class="wp-block-code"><code class="language-php line-numbers" lang="php">// Add the custom meta field to the media file settings
function wpdocs_button_attachment_ui( $form_fields ) {
    // Add your custom meta field
    $form_fields['custom_meta_field'] = array(
        'label' =&gt; __( 'My Button' ),
        'input' =&gt; 'html',
        'html'  =&gt; 'My Button Name',
        'helps' =&gt; __( 'Some help here if you need it.' ),
    );

    return $form_fields;
}

add_filter( 'attachment_fields_to_edit', 'wpdocs_button_attachment_ui' );</code></pre>
</div><!-- .comment-content -->
<section class="wporg-has-embedded-code feedback hide-if-js" data-comment-count="0" id="feedback-6980">
</section><!-- .feedback -->

</article><!-- .comment-body -->
</li>
</ol></section>
</div></div>
    </div>
<footer class="text-center mt-10 py-5">
    <p class="text-sm"><a href="https://notmatt.press">NotMattPress</a>.</p>
</footer>
</body>
</html>
