
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Untitled Page</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@3.3.5/dist/tailwind.min.css" rel="stylesheet">
    <style>
        body {
            background-color: white;
            color: black;
            font-family: 'Quicksand', 'Open Sans', 'Helvetica', 'Arial', san-serif;
        }
        a, h1, h2, h3, h4, h5, h6 {
            color: #0073aa;
        }
        .container {
            max-width: 800px;
            margin: auto;
            padding: 20px;
        }
        .has-small-font-size.is-link-to-top {
            position: absolute;
            bottom: 10px;
            right: 10px;
        }
        .entry-content {
            position:relative;
        }
        .entry-content img {
            max-width: 100%;
        }
    </style>
</head>
<body>
<div class='container'>
    
    <div class="page-metadata" data-published="" data-last-updated=""></div>
    
    <div aria-label="Breadcrumbs" class="wp-block-wporg-site-breadcrumbs has-small-font-size" role="navigation"><div class="wporg-site-breadcrumbs__wrapper"><span><a href="https://developer.wordpress.org">Home</a></span><span><a href="https://developer.wordpress.org/reference/">Reference</a></span><span><a href="https://developer.wordpress.org/reference/classes/">Classes</a></span><span class="is-current-page">Session</span></div></div>  <!-- Full breadcrumbs HTML -->
    <h1>Session</h1>
    <h1 class="wp-block-wporg-code-reference-title" style="margin-bottom:40px;"><span class="keyword">class</span> Session {}</h1>
    
    <div class="content"><div class="entry-content wp-block-post-content is-layout-flow wp-container-core-post-content-is-layout-1 wp-block-post-content-is-layout-flow">
<section class="wp-block-wporg-code-reference-summary"><p>Session handler for persistent requests and default parameters</p>
</section>
<section class="wp-block-wporg-code-reference-description"><h2 class="is-toc-heading wp-block-heading has-heading-5-font-size" id="description" tabindex="-1"><a href="#description">Description</a></h2> <p>Allows various options to be set as default values, and merges both the options and URL properties together. A base URL can be set for all requests, with all subrequests resolved from this. Base options can be set (including a shared cookie jar), then overridden for individual requests.</p>
</section>
<section class="wp-block-wporg-code-reference-methods"><h2 class="is-toc-heading wp-block-heading has-heading-5-font-size" id="methods" tabindex="-1"><a href="#methods">Methods</a></h2> <section class="wp-block-wporg-code-table" id="uses" style="margin-top:var(--wp--preset--spacing--20);"><figure class="wp-block-table"><table><thead><tr><th scope="col">Name</th><th scope="col">Description</th></tr></thead><tbody><tr class=""><td><a href="https://developer.notmatt.press/reference/classes/wporg-requests-session/__construct/">Session::__construct</a></td><td>Create a new session</td></tr><tr class=""><td><a href="https://developer.notmatt.press/reference/classes/wporg-requests-session/__get/">Session::__get</a></td><td>Get a property’s value</td></tr><tr class=""><td><a href="https://developer.notmatt.press/reference/classes/wporg-requests-session/__isset/">Session::__isset</a></td><td>Remove a property’s value</td></tr><tr class=""><td><a href="https://developer.notmatt.press/reference/classes/wporg-requests-session/__set/">Session::__set</a></td><td>Set a property’s value</td></tr><tr class=""><td><a href="https://developer.notmatt.press/reference/classes/wporg-requests-session/__unset/">Session::__unset</a></td><td>Remove a property’s value</td></tr><tr class=""><td><a href="https://developer.notmatt.press/reference/classes/wporg-requests-session/__wakeup/">Session::__wakeup</a></td><td>–</td></tr><tr class=""><td><a href="https://developer.notmatt.press/reference/classes/wporg-requests-session/delete/">Session::delete</a></td><td>Send a DELETE request</td></tr><tr class=""><td><a href="https://developer.notmatt.press/reference/classes/wporg-requests-session/get/">Session::get</a></td><td>Send a GET request</td></tr><tr class=""><td><a href="https://developer.notmatt.press/reference/classes/wporg-requests-session/head/">Session::head</a></td><td>Send a HEAD request</td></tr><tr class=""><td><a href="https://developer.notmatt.press/reference/classes/wporg-requests-session/merge_request/">Session::merge_request</a></td><td>Merge a request’s data with the default data</td></tr><tr class=""><td><a href="https://developer.notmatt.press/reference/classes/wporg-requests-session/patch/">Session::patch</a></td><td>Send a PATCH request</td></tr><tr class=""><td><a href="https://developer.notmatt.press/reference/classes/wporg-requests-session/post/">Session::post</a></td><td>Send a POST request</td></tr><tr class=""><td><a href="https://developer.notmatt.press/reference/classes/wporg-requests-session/put/">Session::put</a></td><td>Send a PUT request</td></tr><tr class=""><td><a href="https://developer.notmatt.press/reference/classes/wporg-requests-session/request/">Session::request</a></td><td>Main interface for HTTP requests</td></tr><tr class=""><td><a href="https://developer.notmatt.press/reference/classes/wporg-requests-session/request_multiple/">Session::request_multiple</a></td><td>Send multiple HTTP requests simultaneously</td></tr></tbody></table></figure></section> </section>
<section class="wp-block-wporg-code-reference-source"><h2 class="is-toc-heading wp-block-heading has-heading-5-font-size" id="source" tabindex="-1"><a href="#source">Source</a></h2> <pre aria-label="Function source code" class="wp-block-code" data-start="26"><code class="language-php line-numbers" id="wporg-source-code" lang="php">class Session {
	/**
	 * Base URL for requests
	 *
	 * URLs will be made absolute using this as the base
	 *
	 * @var string|null
	 */
	public $url = null;

	/**
	 * Base headers for requests
	 *
	 * @var array
	 */
	public $headers = [];

	/**
	 * Base data for requests
	 *
	 * If both the base data and the per-request data are arrays, the data will
	 * be merged before sending the request.
	 *
	 * @var array
	 */
	public $data = [];

	/**
	 * Base options for requests
	 *
	 * The base options are merged with the per-request data for each request.
	 * The only default option is a shared cookie jar between requests.
	 *
	 * Values here can also be set directly via properties on the Session
	 * object, e.g. `$session-&gt;useragent = 'X';`
	 *
	 * @var array
	 */
	public $options = [];

	/**
	 * Create a new session
	 *
	 * @param string|Stringable|null $url Base URL for requests
	 * @param array $headers Default headers for requests
	 * @param array $data Default data for requests
	 * @param array $options Default options for requests
	 *
	 * @throws \WpOrg\Requests\Exception\InvalidArgument When the passed $url argument is not a string, Stringable or null.
	 * @throws \WpOrg\Requests\Exception\InvalidArgument When the passed $headers argument is not an array.
	 * @throws \WpOrg\Requests\Exception\InvalidArgument When the passed $data argument is not an array.
	 * @throws \WpOrg\Requests\Exception\InvalidArgument When the passed $options argument is not an array.
	 */
	public function __construct($url = null, $headers = [], $data = [], $options = []) {
		if ($url !== null &amp;&amp; InputValidator::is_string_or_stringable($url) === false) {
			throw InvalidArgument::create(1, '$url', 'string|Stringable|null', gettype($url));
		}

		if (is_array($headers) === false) {
			throw InvalidArgument::create(2, '$headers', 'array', gettype($headers));
		}

		if (is_array($data) === false) {
			throw InvalidArgument::create(3, '$data', 'array', gettype($data));
		}

		if (is_array($options) === false) {
			throw InvalidArgument::create(4, '$options', 'array', gettype($options));
		}

		$this-&gt;url     = $url;
		$this-&gt;headers = $headers;
		$this-&gt;data    = $data;
		$this-&gt;options = $options;

		if (empty($this-&gt;options['cookies'])) {
			$this-&gt;options['cookies'] = new Jar();
		}
	}

	/**
	 * Get a property's value
	 *
	 * @param string $name Property name.
	 * @return mixed|null Property value, null if none found
	 */
	public function __get($name) {
		if (isset($this-&gt;options[$name])) {
			return $this-&gt;options[$name];
		}

		return null;
	}

	/**
	 * Set a property's value
	 *
	 * @param string $name Property name.
	 * @param mixed $value Property value
	 */
	public function __set($name, $value) {
		$this-&gt;options[$name] = $value;
	}

	/**
	 * Remove a property's value
	 *
	 * @param string $name Property name.
	 */
	public function __isset($name) {
		return isset($this-&gt;options[$name]);
	}

	/**
	 * Remove a property's value
	 *
	 * @param string $name Property name.
	 */
	public function __unset($name) {
		unset($this-&gt;options[$name]);
	}

	/**#@+
	 * @see \WpOrg\Requests\Session::request()
	 * @param string $url
	 * @param array $headers
	 * @param array $options
	 * @return \WpOrg\Requests\Response
	 */
	/**
	 * Send a GET request
	 */
	public function get($url, $headers = [], $options = []) {
		return $this-&gt;request($url, $headers, null, Requests::GET, $options);
	}

	/**
	 * Send a HEAD request
	 */
	public function head($url, $headers = [], $options = []) {
		return $this-&gt;request($url, $headers, null, Requests::HEAD, $options);
	}

	/**
	 * Send a DELETE request
	 */
	public function delete($url, $headers = [], $options = []) {
		return $this-&gt;request($url, $headers, null, Requests::DELETE, $options);
	}
	/**#@-*/

	/**#@+
	 * @see \WpOrg\Requests\Session::request()
	 * @param string $url
	 * @param array $headers
	 * @param array $data
	 * @param array $options
	 * @return \WpOrg\Requests\Response
	 */
	/**
	 * Send a POST request
	 */
	public function post($url, $headers = [], $data = [], $options = []) {
		return $this-&gt;request($url, $headers, $data, Requests::POST, $options);
	}

	/**
	 * Send a PUT request
	 */
	public function put($url, $headers = [], $data = [], $options = []) {
		return $this-&gt;request($url, $headers, $data, Requests::PUT, $options);
	}

	/**
	 * Send a PATCH request
	 *
	 * Note: Unlike <a href="https://developer.notmatt.press/reference/classes/WpOrgRequestsSession/post">\WpOrg\Requests\Session::post()</a> and <a href="https://developer.notmatt.press/reference/classes/WpOrgRequestsSession/put">\WpOrg\Requests\Session::put()</a>,
	 * `$headers` is required, as the specification recommends that should send an ETag
	 *
	 * @link https://tools.ietf.org/html/rfc5789
	 */
	public function patch($url, $headers, $data = [], $options = []) {
		return $this-&gt;request($url, $headers, $data, Requests::PATCH, $options);
	}
	/**#@-*/

	/**
	 * Main interface for HTTP requests
	 *
	 * This method initiates a request and sends it via a transport before
	 * parsing.
	 *
	 * @see \WpOrg\Requests\Requests::request()
	 *
	 * @param string $url URL to request
	 * @param array $headers Extra headers to send with the request
	 * @param array|null $data Data to send either as a query string for GET/HEAD requests, or in the body for POST requests
	 * @param string $type HTTP request type (use \WpOrg\Requests\Requests constants)
	 * @param array $options Options for the request (see <a href="https://developer.notmatt.press/reference/classes/WpOrgRequestsRequests/request">\WpOrg\Requests\Requests::request()</a>)
	 * @return \WpOrg\Requests\Response
	 *
	 * @throws \WpOrg\Requests\Exception On invalid URLs (`nonhttp`)
	 */
	public function request($url, $headers = [], $data = [], $type = Requests::GET, $options = []) {
		$request = $this-&gt;merge_request(compact('url', 'headers', 'data', 'options'));

		return Requests::request($request['url'], $request['headers'], $request['data'], $type, $request['options']);
	}

	/**
	 * Send multiple HTTP requests simultaneously
	 *
	 * @see \WpOrg\Requests\Requests::request_multiple()
	 *
	 * @param array $requests Requests data (see <a href="https://developer.notmatt.press/reference/classes/WpOrgRequestsRequests/request_multiple">\WpOrg\Requests\Requests::request_multiple()</a>)
	 * @param array $options Global and default options (see <a href="https://developer.notmatt.press/reference/classes/WpOrgRequestsRequests/request">\WpOrg\Requests\Requests::request()</a>)
	 * @return array Responses (either \WpOrg\Requests\Response or a \WpOrg\Requests\Exception object)
	 *
	 * @throws \WpOrg\Requests\Exception\InvalidArgument When the passed $requests argument is not an array or iterable object with array access.
	 * @throws \WpOrg\Requests\Exception\InvalidArgument When the passed $options argument is not an array.
	 */
	public function request_multiple($requests, $options = []) {
		if (InputValidator::has_array_access($requests) === false || InputValidator::is_iterable($requests) === false) {
			throw InvalidArgument::create(1, '$requests', 'array|ArrayAccess&amp;Traversable', gettype($requests));
		}

		if (is_array($options) === false) {
			throw InvalidArgument::create(2, '$options', 'array', gettype($options));
		}

		foreach ($requests as $key =&gt; $request) {
			$requests[$key] = $this-&gt;merge_request($request, false);
		}

		$options = array_merge($this-&gt;options, $options);

		// Disallow forcing the type, as that's a per request setting
		unset($options['type']);

		return Requests::request_multiple($requests, $options);
	}

	public function __wakeup() {
		throw new \LogicException( __CLASS__ . ' should never be unserialized' );
	}

	/**
	 * Merge a request's data with the default data
	 *
	 * @param array $request Request data (same form as <a href="https://developer.notmatt.press/reference/classes/WpOrgRequestsSession/request_multiple">\WpOrg\Requests\Session::request_multiple()</a>)
	 * @param boolean $merge_options Should we merge options as well?
	 * @return array Request data
	 */
	protected function merge_request($request, $merge_options = true) {
		if ($this-&gt;url !== null) {
			$request['url'] = Iri::absolutize($this-&gt;url, $request['url']);
			$request['url'] = $request['url']-&gt;uri;
		}

		if (empty($request['headers'])) {
			$request['headers'] = [];
		}

		$request['headers'] = array_merge($this-&gt;headers, $request['headers']);

		if (empty($request['data'])) {
			if (is_array($this-&gt;data)) {
				$request['data'] = $this-&gt;data;
			}
		} elseif (is_array($request['data']) &amp;&amp; is_array($this-&gt;data)) {
			$request['data'] = array_merge($this-&gt;data, $request['data']);
		}

		if ($merge_options === true) {
			$request['options'] = array_merge($this-&gt;options, $request['options']);

			// Disallow forcing the type, as that's a per request setting
			unset($request['options']['type']);
		}

		return $request;
	}
}
</code></pre><p class="wporg-dot-link-list"><a href="https://developer.notmatt.press/reference/files/wp-includes/requests/src/session.php/">View all references</a> <a href="https://core.trac.wordpress.org/browser/tags/6.7/src/wp-includes/Requests/src/Session.php#L26">View on Trac</a> <a href="https://github.com/WordPress/wordpress-develop/blob/6.7/src/wp-includes/Requests/src/Session.php#L26-L308">View on GitHub</a></p></section>
</div></div>
    </div>
<footer class="text-center mt-10 py-5">
    <p class="text-sm"><a href="https://notmatt.press">NotMattPress</a>.</p>
</footer>
</body>
</html>
