
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Untitled Page</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@3.3.5/dist/tailwind.min.css" rel="stylesheet">
    <style>
        body {
            background-color: white;
            color: black;
            font-family: 'Quicksand', 'Open Sans', 'Helvetica', 'Arial', san-serif;
        }
        a, h1, h2, h3, h4, h5, h6 {
            color: #0073aa;
        }
        .container {
            max-width: 800px;
            margin: auto;
            padding: 20px;
        }
        .has-small-font-size.is-link-to-top {
            position: absolute;
            bottom: 10px;
            right: 10px;
        }
        .entry-content {
            position:relative;
        }
        .entry-content img {
            max-width: 100%;
        }
    </style>
</head>
<body>
<div class='container'>
    
    <div class="page-metadata" data-published="" data-last-updated=""></div>
    
    <div aria-label="Breadcrumbs" class="wp-block-wporg-site-breadcrumbs has-small-font-size" role="navigation"><div class="wporg-site-breadcrumbs__wrapper"><span><a href="https://developer.wordpress.org">Home</a></span><span><a href="https://developer.wordpress.org/reference/">Reference</a></span><span><a href="https://developer.wordpress.org/reference/classes/">Classes</a></span><span class="is-current-page">WP_REST_Response</span></div></div>  <!-- Full breadcrumbs HTML -->
    <h1>WP_REST_Response</h1>
    <h1 class="wp-block-wporg-code-reference-title" style="margin-bottom:40px;"><span class="keyword">class</span> WP_REST_Response {}</h1>
    
    <div class="content"><div class="entry-content wp-block-post-content is-layout-flow wp-container-core-post-content-is-layout-1 wp-block-post-content-is-layout-flow">
<section class="wp-block-wporg-code-reference-summary"><p>Core class used to implement a REST response object.</p>
</section>
<section class="wp-block-wporg-code-reference-description"><h2 class="is-toc-heading wp-block-heading has-heading-5-font-size" id="description" tabindex="-1"><a href="#description">Description</a></h2> <h3 class="is-toc-heading has-heading-5-font-size" id="see-also" tabindex="-1"><a href="#see-also">See also</a></h3><ul><li><a href="https://developer.notmatt.press/reference/classes/wp_http_response">WP_HTTP_Response</a></li>
</ul></section>
<section class="wp-block-wporg-code-reference-methods"><h2 class="is-toc-heading wp-block-heading has-heading-5-font-size" id="methods" tabindex="-1"><a href="#methods">Methods</a></h2> <section class="wp-block-wporg-code-table" id="uses" style="margin-top:var(--wp--preset--spacing--20);"><figure class="wp-block-table"><table><thead><tr><th scope="col">Name</th><th scope="col">Description</th></tr></thead><tbody><tr class=""><td><a href="https://developer.notmatt.press/reference/classes/wp_rest_response/add_link/">WP_REST_Response::add_link</a></td><td>Adds a link to the response.</td></tr><tr class=""><td><a href="https://developer.notmatt.press/reference/classes/wp_rest_response/add_links/">WP_REST_Response::add_links</a></td><td>Adds multiple links to the response.</td></tr><tr class=""><td><a href="https://developer.notmatt.press/reference/classes/wp_rest_response/as_error/">WP_REST_Response::as_error</a></td><td>Retrieves a <a href="https://developer.notmatt.press/reference/classes/wp_error/" rel="class">WP_Error</a> object from the response.</td></tr><tr class=""><td><a href="https://developer.notmatt.press/reference/classes/wp_rest_response/get_curies/">WP_REST_Response::get_curies</a></td><td>Retrieves the CURIEs (compact URIs) used for relations.</td></tr><tr class=""><td><a href="https://developer.notmatt.press/reference/classes/wp_rest_response/get_links/">WP_REST_Response::get_links</a></td><td>Retrieves links for the response.</td></tr><tr class=""><td><a href="https://developer.notmatt.press/reference/classes/wp_rest_response/get_matched_handler/">WP_REST_Response::get_matched_handler</a></td><td>Retrieves the handler that was used to generate the response.</td></tr><tr class=""><td><a href="https://developer.notmatt.press/reference/classes/wp_rest_response/get_matched_route/">WP_REST_Response::get_matched_route</a></td><td>Retrieves the route that was used.</td></tr><tr class=""><td><a href="https://developer.notmatt.press/reference/classes/wp_rest_response/is_error/">WP_REST_Response::is_error</a></td><td>Checks if the response is an error, i.e. &gt;= 400 response code.</td></tr><tr class=""><td><a href="https://developer.notmatt.press/reference/classes/wp_rest_response/link_header/">WP_REST_Response::link_header</a></td><td>Sets a single link header.</td></tr><tr class=""><td><a href="https://developer.notmatt.press/reference/classes/wp_rest_response/remove_link/">WP_REST_Response::remove_link</a></td><td>Removes a link from the response.</td></tr><tr class=""><td><a href="https://developer.notmatt.press/reference/classes/wp_rest_response/set_matched_handler/">WP_REST_Response::set_matched_handler</a></td><td>Sets the handler that was responsible for generating the response.</td></tr><tr class=""><td><a href="https://developer.notmatt.press/reference/classes/wp_rest_response/set_matched_route/">WP_REST_Response::set_matched_route</a></td><td>Sets the route (regex for path) that caused the response.</td></tr></tbody></table></figure></section> </section>
<section class="wp-block-wporg-code-reference-source"><h2 class="is-toc-heading wp-block-heading has-heading-5-font-size" id="source" tabindex="-1"><a href="#source">Source</a></h2> <pre aria-label="Function source code" class="wp-block-code" data-start="17"><code class="language-php line-numbers" id="wporg-source-code" lang="php">class WP_REST_Response extends WP_HTTP_Response {

	/**
	 * Links related to the response.
	 *
	 * @since 4.4.0
	 * @var array
	 */
	protected $links = array();

	/**
	 * The route that was to create the response.
	 *
	 * @since 4.4.0
	 * @var string
	 */
	protected $matched_route = '';

	/**
	 * The handler that was used to create the response.
	 *
	 * @since 4.4.0
	 * @var null|array
	 */
	protected $matched_handler = null;

	/**
	 * Adds a link to the response.
	 *
	 * @internal The $rel parameter is first, as this looks nicer when sending multiple.
	 *
	 * @since 4.4.0
	 *
	 * @link https://tools.ietf.org/html/rfc5988
	 * @link https://www.iana.org/assignments/link-relations/link-relations.xml
	 *
	 * @param string $rel        Link relation. Either an IANA registered type,
	 *                           or an absolute URL.
	 * @param string $href       Target URI for the link.
	 * @param array  $attributes Optional. Link parameters to send along with the URL. Default empty array.
	 */
	public function add_link( $rel, $href, $attributes = array() ) {
		if ( empty( $this-&gt;links[ $rel ] ) ) {
			$this-&gt;links[ $rel ] = array();
		}

		if ( isset( $attributes['href'] ) ) {
			// Remove the href attribute, as it's used for the main URL.
			unset( $attributes['href'] );
		}

		$this-&gt;links[ $rel ][] = array(
			'href'       =&gt; $href,
			'attributes' =&gt; $attributes,
		);
	}

	/**
	 * Removes a link from the response.
	 *
	 * @since 4.4.0
	 *
	 * @param string $rel  Link relation. Either an IANA registered type, or an absolute URL.
	 * @param string $href Optional. Only remove links for the relation matching the given href.
	 *                     Default null.
	 */
	public function remove_link( $rel, $href = null ) {
		if ( ! isset( $this-&gt;links[ $rel ] ) ) {
			return;
		}

		if ( $href ) {
			$this-&gt;links[ $rel ] = wp_list_filter( $this-&gt;links[ $rel ], array( 'href' =&gt; $href ), 'NOT' );
		} else {
			$this-&gt;links[ $rel ] = array();
		}

		if ( ! $this-&gt;links[ $rel ] ) {
			unset( $this-&gt;links[ $rel ] );
		}
	}

	/**
	 * Adds multiple links to the response.
	 *
	 * Link data should be an associative array with link relation as the key.
	 * The value can either be an associative array of link attributes
	 * (including `href` with the URL for the response), or a list of these
	 * associative arrays.
	 *
	 * @since 4.4.0
	 *
	 * @param array $links Map of link relation to list of links.
	 */
	public function add_links( $links ) {
		foreach ( $links as $rel =&gt; $set ) {
			// If it's a single link, wrap with an array for consistent handling.
			if ( isset( $set['href'] ) ) {
				$set = array( $set );
			}

			foreach ( $set as $attributes ) {
				$this-&gt;add_link( $rel, $attributes['href'], $attributes );
			}
		}
	}

	/**
	 * Retrieves links for the response.
	 *
	 * @since 4.4.0
	 *
	 * @return array List of links.
	 */
	public function get_links() {
		return $this-&gt;links;
	}

	/**
	 * Sets a single link header.
	 *
	 * @internal The $rel parameter is first, as this looks nicer when sending multiple.
	 *
	 * @since 4.4.0
	 *
	 * @link https://tools.ietf.org/html/rfc5988
	 * @link https://www.iana.org/assignments/link-relations/link-relations.xml
	 *
	 * @param string $rel   Link relation. Either an IANA registered type, or an absolute URL.
	 * @param string $link  Target IRI for the link.
	 * @param array  $other Optional. Other parameters to send, as an associative array.
	 *                      Default empty array.
	 */
	public function link_header( $rel, $link, $other = array() ) {
		$header = '&lt;' . $link . '&gt;; rel="' . $rel . '"';

		foreach ( $other as $key =&gt; $value ) {
			if ( 'title' === $key ) {
				$value = '"' . $value . '"';
			}

			$header .= '; ' . $key . '=' . $value;
		}
		$this-&gt;header( 'Link', $header, false );
	}

	/**
	 * Retrieves the route that was used.
	 *
	 * @since 4.4.0
	 *
	 * @return string The matched route.
	 */
	public function get_matched_route() {
		return $this-&gt;matched_route;
	}

	/**
	 * Sets the route (regex for path) that caused the response.
	 *
	 * @since 4.4.0
	 *
	 * @param string $route Route name.
	 */
	public function set_matched_route( $route ) {
		$this-&gt;matched_route = $route;
	}

	/**
	 * Retrieves the handler that was used to generate the response.
	 *
	 * @since 4.4.0
	 *
	 * @return null|array The handler that was used to create the response.
	 */
	public function get_matched_handler() {
		return $this-&gt;matched_handler;
	}

	/**
	 * Sets the handler that was responsible for generating the response.
	 *
	 * @since 4.4.0
	 *
	 * @param array $handler The matched handler.
	 */
	public function set_matched_handler( $handler ) {
		$this-&gt;matched_handler = $handler;
	}

	/**
	 * Checks if the response is an error, i.e. &gt;= 400 response code.
	 *
	 * @since 4.4.0
	 *
	 * @return bool Whether the response is an error.
	 */
	public function is_error() {
		return $this-&gt;get_status() &gt;= 400;
	}

	/**
	 * Retrieves a WP_Error object from the response.
	 *
	 * @since 4.4.0
	 *
	 * @return WP_Error|null WP_Error or null on not an errored response.
	 */
	public function as_error() {
		if ( ! $this-&gt;is_error() ) {
			return null;
		}

		$error = new WP_Error();

		if ( is_array( $this-&gt;get_data() ) ) {
			$data = $this-&gt;get_data();
			$error-&gt;add( $data['code'], $data['message'], $data['data'] );

			if ( ! empty( $data['additional_errors'] ) ) {
				foreach ( $data['additional_errors'] as $err ) {
					$error-&gt;add( $err['code'], $err['message'], $err['data'] );
				}
			}
		} else {
			$error-&gt;add( $this-&gt;get_status(), '', array( 'status' =&gt; $this-&gt;get_status() ) );
		}

		return $error;
	}

	/**
	 * Retrieves the CURIEs (compact URIs) used for relations.
	 *
	 * @since 4.5.0
	 *
	 * @return array Compact URIs.
	 */
	public function get_curies() {
		$curies = array(
			array(
				'name'      =&gt; 'wp',
				'href'      =&gt; 'https://api.w.org/{rel}',
				'templated' =&gt; true,
			),
		);

		/**
		 * Filters extra CURIEs available on REST API responses.
		 *
		 * CURIEs allow a shortened version of URI relations. This allows a more
		 * usable form for custom relations than using the full URI. These work
		 * similarly to how XML namespaces work.
		 *
		 * Registered CURIES need to specify a name and URI template. This will
		 * automatically transform URI relations into their shortened version.
		 * The shortened relation follows the format `{name}:{rel}`. `{rel}` in
		 * the URI template will be replaced with the `{rel}` part of the
		 * shortened relation.
		 *
		 * For example, a CURIE with name `example` and URI template
		 * `https://w.org/{rel}` would transform a `https://w.org/term` relation
		 * into `example:term`.
		 *
		 * Well-behaved clients should expand and normalize these back to their
		 * full URI relation, however some naive clients may not resolve these
		 * correctly, so adding new CURIEs may break backward compatibility.
		 *
		 * @since 4.5.0
		 *
		 * @param array $additional Additional CURIEs to register with the REST API.
		 */
		$additional = apply_filters( 'rest_response_link_curies', array() );

		return array_merge( $curies, $additional );
	}
}
</code></pre><p class="wporg-dot-link-list"><a href="https://developer.notmatt.press/reference/files/wp-includes/rest-api/class-wp-rest-response.php/">View all references</a> <a href="https://core.trac.wordpress.org/browser/tags/6.7/src/wp-includes/rest-api/class-wp-rest-response.php#L17">View on Trac</a> <a href="https://github.com/WordPress/wordpress-develop/blob/6.7/src/wp-includes/rest-api/class-wp-rest-response.php#L17-L293">View on GitHub</a></p></section>
<section class="wp-block-wporg-code-reference-related" data-nosnippet="true"><h2 class="is-toc-heading wp-block-heading has-heading-5-font-size" id="related" tabindex="-1"><a href="#related">Related</a></h2> <section class="wp-block-wporg-code-table" id="uses" style="margin-top:var(--wp--preset--spacing--20);"><figure class="wp-block-table"><table><thead><tr><th scope="col">Uses</th><th scope="col">Description</th></tr></thead><tbody><tr class=""><td><a href="https://developer.notmatt.press/reference/classes/wp_http_response/">WP_HTTP_Response</a><code>wp-includes/class-wp-http-response.php</code></td><td><p>Core class used to prepare HTTP responses.</p>
</td></tr></tbody></table></figure></section> </section>
<section class="wp-block-wporg-code-reference-changelog"><h2 class="is-toc-heading wp-block-heading has-heading-5-font-size" id="changelog" tabindex="-1"><a href="#changelog">Changelog</a></h2> <section class="wp-block-wporg-code-table" style="margin-top:var(--wp--preset--spacing--20);"><figure class="wp-block-table"><table><thead><tr><th scope="col">Version</th><th scope="col">Description</th></tr></thead><tbody><tr class=""><td><a href="https://developer.notmatt.press/reference/since/4.4.0/">4.4.0</a></td><td>Introduced.</td></tr></tbody></table></figure></section> </section>
<section class="wp-block-wporg-code-reference-comments" data-nosnippet="true"><h2 class="is-toc-heading wp-block-heading" id="user-contributed-notes" tabindex="-1"><a href="#user-contributed-notes">User Contributed Notes</a></h2> <ol class="comment-list"> <li class="comment byuser comment-author-khoipro even thread-even depth-1" data-comment-id="3264" id="comment-3264">
<article class="comment-body" id="div-comment-3264">
<a class="screen-reader-text" href="#comment-content-3264">Skip to note 3 content</a>

<!-- .comment-metadata -->
<div class="wporg-has-embedded-code comment-content" id="comment-content-3264">
<p>When you call to a remote url, it’s better to response using this class than <code>WP_Error()</code>.</p>
<pre class="wp-block-code"><code class="language-php line-numbers" lang="php">function load_request() {
  $token = '&lt;your_api_key&gt;';
  $url = '&lt;your_api_url&gt;';
  $args = array(
    'headers' =&gt; array(
      'Authentication' =&gt; "Basic $token"
    )
  );

  // Send remote request
  $request = wp_remote_get($url, $args);

  // Retrieve information
  $response_code = wp_remote_retrieve_response_code($request);
  $response_message = wp_remote_retrieve_response_message($request);
  $response_body = wp_remote_retrieve_body($request);

  if (!is_wp_error($request) ) {
    return new WP_REST_Response(
      array(
        'status' =&gt; $response_code,
        'response' =&gt; $response_message,
        'body_response' =&gt; $response_body
      );
    );
  } else {
    return new WP_Error($response_code, $response_message, $response_body);
  }
}</code></pre>
</div><!-- .comment-content -->
<section class="wporg-has-embedded-code feedback hide-if-js" data-comment-count="0" id="feedback-3264">
</section><!-- .feedback -->

</article><!-- .comment-body -->
</li>
<li class="comment byuser comment-author-michelleblanchette odd alt thread-odd thread-alt depth-1" data-comment-id="6687" id="comment-6687">
<article class="comment-body" id="div-comment-6687">
<a class="screen-reader-text" href="#comment-content-6687">Skip to note 4 content</a>

<!-- .comment-metadata -->
<div class="wporg-has-embedded-code comment-content" id="comment-content-6687">
<p>You can create a redirect response like so:</p>
<pre class="wp-block-code"><code class="language-php line-numbers" lang="php">return new \WP_REST_Response(
	null, // No response body content.
	303, // HTTP 303 See Other.
	array(
		'Location' =&gt; site_url( '/thank-you/' ), // Redirect to success page.
	)
);</code></pre>
<p>This HTTP response has no body content, status code <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/303" rel="nofollow ugc"><code>HTTP 303 See Other</code></a>, and the <code>Location</code> header to redirect the user to a confirmation page.</p>
<p>This is especially useful when <a href="https://developer.notmatt.press/rest-api/extending-the-rest-api/adding-custom-endpoints/" rel="ugc">adding custom WordPress REST API endpoints</a> which do some processing. Since the WordPress REST API always returns JSON, you can instead redirect the user to a success or error page after processing completes to view the result in HTML. This provides an accessible user experience without the need for implementing AJAX request handling in JavaScript to use the WordPress REST API.</p>
<p>Then you can use REST URLs as simple links to do some processing:</p>
<pre class="wp-block-code"><code class="language-php line-numbers" lang="php">// Get the REST API endpoint URL to subscribe the user to email notifications.
$rest_endpoint_url = rest_url( 'my-plugin/v1/subscribe' );

// Display the link with WordPress REST API user authentication nonce.
// Redirects the user to a success or error page after processing the request.
printf(
	'&lt;a href="%s" rel="nofollow ugc"&gt;Enable Notifications&lt;/a&gt;',
	wp_nonce_url( $rest_endpoint_url, 'wp_rest', '_wpnonce' )
);</code></pre>
</div><!-- .comment-content -->
<section class="wporg-has-embedded-code feedback hide-if-js" data-comment-count="0" id="feedback-6687">
</section><!-- .feedback -->

</article><!-- .comment-body -->
</li>
</ol></section>
</div></div>
    </div>
<footer class="text-center mt-10 py-5">
    <p class="text-sm"><a href="https://notmatt.press">NotMattPress</a>.</p>
</footer>
</body>
</html>
