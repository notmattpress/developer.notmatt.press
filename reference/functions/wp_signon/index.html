
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Untitled Page</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@3.3.5/dist/tailwind.min.css" rel="stylesheet">
    <style>
        body {
            background-color: white;
            color: black;
            font-family: 'Quicksand', 'Open Sans', 'Helvetica', 'Arial', san-serif;
        }
        a, h1, h2, h3, h4, h5, h6 {
            color: #0073aa;
        }
        .container {
            max-width: 800px;
            margin: auto;
            padding: 20px;
        }
        .has-small-font-size.is-link-to-top {
            position: absolute;
            bottom: 10px;
            right: 10px;
        }
        .entry-content {
            position:relative;
        }
        .entry-content img {
            max-width: 100%;
        }
    </style>
</head>
<body>
<div class='container'>
    
    <div class="page-metadata" data-published="" data-last-updated=""></div>
    
    <div aria-label="Breadcrumbs" class="wp-block-wporg-site-breadcrumbs has-small-font-size" role="navigation"><div class="wporg-site-breadcrumbs__wrapper"><span><a href="https://developer.wordpress.org">Home</a></span><span><a href="https://developer.wordpress.org/reference/">Reference</a></span><span><a href="https://developer.wordpress.org/reference/functions/">Functions</a></span><span class="is-current-page">wp_signon()</span></div></div>  <!-- Full breadcrumbs HTML -->
    <h1>wp_signon()</h1>
    <h1 class="wp-block-wporg-code-reference-title" style="margin-bottom:40px;">wp_signon( <span class="arg-type">array</span> <span class="arg-name">$credentials</span> = <span class="arg-default">array()</span>,  <span class="arg-type">string|bool</span> <span class="arg-name">$secure_cookie</span> = <span class="arg-default">''</span> ): <span class="return-type"><a href="https://developer.wordpress.org/reference/classes/wp_user/" rel="class">WP_User</a>|<a href="https://developer.wordpress.org/reference/classes/wp_error/" rel="class">WP_Error</a></span></h1>
    
    <div class="content"><div class="entry-content wp-block-post-content is-layout-flow wp-container-core-post-content-is-layout-1 wp-block-post-content-is-layout-flow">
<section class="wp-block-wporg-code-reference-summary"><p>Authenticates and logs a user in with ‘remember’ capability.</p>
</section>
<section class="wp-block-wporg-code-reference-description"><h2 class="is-toc-heading wp-block-heading has-heading-5-font-size" id="description" tabindex="-1"><a href="#description">Description</a></h2> <p>The credentials is an array that has ‘user_login’, ‘user_password’, and ‘remember’ indices. If the credentials is not given, then the log in form will be assumed and used if set.</p>
<p>The various authentication cookies will be set by this function and will be set for a longer period depending on if the ‘remember’ credential is set to true.</p>
<p>Note: <a href="https://developer.notmatt.press/reference/functions/wp_signon/" rel="function">wp_signon()</a>  doesn’t handle setting the current user. This means that if the function is called before the <a href="https://developer.notmatt.press/reference/hooks/init/">‘init’</a> hook is fired, <a href="https://developer.notmatt.press/reference/functions/is_user_logged_in/" rel="function">is_user_logged_in()</a>  will evaluate as false until that point. If <a href="https://developer.notmatt.press/reference/functions/is_user_logged_in/" rel="function">is_user_logged_in()</a>  is needed in conjunction with <a href="https://developer.notmatt.press/reference/functions/wp_signon/" rel="function">wp_signon()</a> , <a href="https://developer.notmatt.press/reference/functions/wp_set_current_user/" rel="function">wp_set_current_user()</a>  should be called explicitly.</p>
</section>
<section class="wp-block-wporg-code-reference-parameters"><h2 class="is-toc-heading wp-block-heading has-heading-5-font-size" id="parameters" tabindex="-1"><a href="#parameters">Parameters</a></h2> <dl><dt><code>$credentials</code><span class="type"><span class="array">array</span></span><span class="required">optional</span></dt><dd><div class="desc"><span class="description">User info in order to sign on.<br/>
<ul class="param-hash"><li><code>user_login</code> <span class="type">string</span><div class="desc">Username.</div></li>
<li><code>user_password</code> <span class="type">string</span><div class="desc">User password.</div></li>
<li><code>remember</code> <span class="type">bool</span><div class="desc">Whether to <code>'remember'</code> the user. Increases the time that the cookie will be kept. Default false.</div></li>
</ul>
</span></div><p class="default">Default:<code>array()</code></p></dd><dt><code>$secure_cookie</code><span class="type"><span class="string">string</span>|<span class="bool">bool</span></span><span class="required">optional</span></dt><dd><div class="desc"><span class="description">Whether to use secure cookie.</span></div><p class="default">Default:<code>''</code></p></dd></dl></section>
<section class="wporg-has-embedded-code wp-block-wporg-code-reference-return-value"><h2 class="is-toc-heading wp-block-heading has-heading-5-font-size" id="return" tabindex="-1"><a href="#return">Return</a></h2> <span class="return-type"><a href="https://developer.notmatt.press/reference/classes/wp_user/" rel="class">WP_User</a>|<a href="https://developer.notmatt.press/reference/classes/wp_error/" rel="class">WP_Error</a></span> <a href="https://developer.notmatt.press/reference/classes/wp_user/" rel="class">WP_User</a> on success, <a href="https://developer.notmatt.press/reference/classes/wp_error/" rel="class">WP_Error</a> on failure.</section>
<section class="wporg-has-embedded-code wp-block-wporg-code-reference-explanation"><h2 class="is-toc-heading wp-block-heading has-heading-5-font-size" id="more-information" tabindex="-1"><a href="#more-information">More Information</a></h2>
<p>If you don’t provide $credentials, wp_signon uses the $_POST variable (the keys being “log”, “pwd” and “rememberme”).</p>
<p>This function sends headers to the page. It must be run before any content is returned.</p>
<p>This function sets an authentication cookie. Users will not be logged in if it is not sent.</p>
</section>
<section class="wp-block-wporg-code-reference-source"><h2 class="is-toc-heading wp-block-heading has-heading-5-font-size" id="source" tabindex="-1"><a href="#source">Source</a></h2> <pre aria-label="Function source code" class="wp-block-code" data-start="41"><code class="language-php line-numbers" id="wporg-source-code" lang="php">function wp_signon( $credentials = array(), $secure_cookie = '' ) {
	global $auth_secure_cookie, $wpdb;

	if ( empty( $credentials ) ) {
		$credentials = array(
			'user_login'    =&gt; '',
			'user_password' =&gt; '',
			'remember'      =&gt; false,
		);

		if ( ! empty( $_POST['log'] ) ) {
			$credentials['user_login'] = wp_unslash( $_POST['log'] );
		}
		if ( ! empty( $_POST['pwd'] ) ) {
			$credentials['user_password'] = $_POST['pwd'];
		}
		if ( ! empty( $_POST['rememberme'] ) ) {
			$credentials['remember'] = $_POST['rememberme'];
		}
	}

	if ( ! empty( $credentials['remember'] ) ) {
		$credentials['remember'] = true;
	} else {
		$credentials['remember'] = false;
	}

	/**
	 * Fires before the user is authenticated.
	 *
	 * The variables passed to the callbacks are passed by reference,
	 * and can be modified by callback functions.
	 *
	 * @since 1.5.1
	 *
	 * @todo Decide whether to deprecate the wp_authenticate action.
	 *
	 * @param string $user_login    Username (passed by reference).
	 * @param string $user_password User password (passed by reference).
	 */
	do_action_ref_array( 'wp_authenticate', array( &amp;$credentials['user_login'], &amp;$credentials['user_password'] ) );

	if ( '' === $secure_cookie ) {
		$secure_cookie = is_ssl();
	}

	/**
	 * Filters whether to use a secure sign-on cookie.
	 *
	 * @since 3.1.0
	 *
	 * @param bool  $secure_cookie Whether to use a secure sign-on cookie.
	 * @param array $credentials {
	 *     Array of entered sign-on data.
	 *
	 *     @type string $user_login    Username.
	 *     @type string $user_password Password entered.
	 *     @type bool   $remember      Whether to 'remember' the user. Increases the time
	 *                                 that the cookie will be kept. Default false.
	 * }
	 */
	$secure_cookie = apply_filters( 'secure_signon_cookie', $secure_cookie, $credentials );

	// XXX ugly hack to pass this to wp_authenticate_cookie().
	$auth_secure_cookie = $secure_cookie;

	add_filter( 'authenticate', 'wp_authenticate_cookie', 30, 3 );

	$user = wp_authenticate( $credentials['user_login'], $credentials['user_password'] );

	if ( is_wp_error( $user ) ) {
		return $user;
	}

	wp_set_auth_cookie( $user-&gt;ID, $credentials['remember'], $secure_cookie );

	// Clear `user_activation_key` after a successful login.
	if ( ! empty( $user-&gt;user_activation_key ) ) {
		$wpdb-&gt;update(
			$wpdb-&gt;users,
			array(
				'user_activation_key' =&gt; '',
			),
			array( 'ID' =&gt; $user-&gt;ID )
		);

		$user-&gt;user_activation_key = '';
	}

	/**
	 * Fires after the user has successfully logged in.
	 *
	 * @since 1.5.0
	 *
	 * @param string  $user_login Username.
	 * @param WP_User $user       WP_User object of the logged-in user.
	 */
	do_action( 'wp_login', $user-&gt;user_login, $user );

	return $user;
}
</code></pre><p class="wporg-dot-link-list"><a href="https://developer.notmatt.press/reference/files/wp-includes/user.php/">View all references</a> <a href="https://core.trac.wordpress.org/browser/tags/6.7/src/wp-includes/user.php#L41">View on Trac</a> <a href="https://github.com/WordPress/wordpress-develop/blob/6.7/src/wp-includes/user.php#L41-L141">View on GitHub</a></p></section>
<section class="wp-block-wporg-code-reference-hooks"><h2 class="is-toc-heading wp-block-heading has-heading-5-font-size" id="hooks" tabindex="-1"><a href="#hooks">Hooks</a></h2> <dl><dt class="wp-block-wporg-code-reference-title has-normal-font-size"><a href="https://developer.notmatt.press/reference/hooks/secure_signon_cookie/"><span class="hook-func">apply_filters</span>( ‘secure_signon_cookie’,  <nobr><span class="arg-type">bool</span> <span class="arg-name">$secure_cookie</span></nobr>,  <nobr><span class="arg-type">array</span> <span class="arg-name">$credentials</span></nobr> )</a></dt><dd><p>Filters whether to use a secure sign-on cookie.</p>
</dd><dt class="wp-block-wporg-code-reference-title has-normal-font-size"><a href="https://developer.notmatt.press/reference/hooks/wp_authenticate/"><span class="hook-func">do_action_ref_array</span>( ‘wp_authenticate’,  <nobr><span class="arg-type">string</span> <span class="arg-name">$user_login</span></nobr>,  <nobr><span class="arg-type">string</span> <span class="arg-name">$user_password</span></nobr> )</a></dt><dd><p>Fires before the user is authenticated.</p>
</dd><dt class="wp-block-wporg-code-reference-title has-normal-font-size"><a href="https://developer.notmatt.press/reference/hooks/wp_login/"><span class="hook-func">do_action</span>( ‘wp_login’,  <nobr><span class="arg-type">string</span> <span class="arg-name">$user_login</span></nobr>,  <nobr><span class="arg-type">WP_User</span> <span class="arg-name">$user</span></nobr> )</a></dt><dd><p>Fires after the user has successfully logged in.</p>
</dd></dl></section>
<section class="wp-block-wporg-code-reference-related" data-nosnippet="true"><h2 class="is-toc-heading wp-block-heading has-heading-5-font-size" id="related" tabindex="-1"><a href="#related">Related</a></h2> <section class="wp-block-wporg-code-table" id="uses" style="margin-top:var(--wp--preset--spacing--20);"><figure class="wp-block-table"><table><thead><tr><th scope="col">Uses</th><th scope="col">Description</th></tr></thead><tbody><tr class=""><td><a href="https://developer.notmatt.press/reference/functions/wp_set_auth_cookie/">wp_set_auth_cookie()</a><code>wp-includes/pluggable.php</code></td><td><p>Sets the authentication cookies based on user ID.</p>
</td></tr><tr class=""><td><a href="https://developer.notmatt.press/reference/functions/wp_authenticate/">wp_authenticate()</a><code>wp-includes/pluggable.php</code></td><td><p>Authenticates a user, confirming the login credentials are valid.</p>
</td></tr><tr class=""><td><a href="https://developer.notmatt.press/reference/functions/is_ssl/">is_ssl()</a><code>wp-includes/load.php</code></td><td><p>Determines if SSL is used.</p>
</td></tr><tr class=""><td><a href="https://developer.notmatt.press/reference/functions/do_action_ref_array/">do_action_ref_array()</a><code>wp-includes/plugin.php</code></td><td><p>Calls the callback functions that have been added to an action hook, specifying arguments in an array.</p>
</td></tr><tr class=""><td><a href="https://developer.notmatt.press/reference/classes/wpdb/update/">wpdb::update()</a><code>wp-includes/class-wpdb.php</code></td><td><p>Updates a row in the table.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/wp_unslash/">wp_unslash()</a><code>wp-includes/formatting.php</code></td><td><p>Removes slashes from a string or recursively removes slashes from strings within an array.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/apply_filters/">apply_filters()</a><code>wp-includes/plugin.php</code></td><td><p>Calls the callback functions that have been added to a filter hook.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/add_filter/">add_filter()</a><code>wp-includes/plugin.php</code></td><td><p>Adds a callback function to a filter hook.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/do_action/">do_action()</a><code>wp-includes/plugin.php</code></td><td><p>Calls the callback functions that have been added to an action hook.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/is_wp_error/">is_wp_error()</a><code>wp-includes/load.php</code></td><td><p>Checks whether the given variable is a WordPress Error.</p>
</td></tr></tbody></table></figure><a class="wp-block-wporg-code-table-show-more" href="#">Show 5 more</a><a class="wp-block-wporg-code-table-show-less" href="#">Show less</a></section> </section>
<section class="wp-block-wporg-code-reference-changelog"><h2 class="is-toc-heading wp-block-heading has-heading-5-font-size" id="changelog" tabindex="-1"><a href="#changelog">Changelog</a></h2> <section class="wp-block-wporg-code-table" style="margin-top:var(--wp--preset--spacing--20);"><figure class="wp-block-table"><table><thead><tr><th scope="col">Version</th><th scope="col">Description</th></tr></thead><tbody><tr class=""><td><a href="https://developer.notmatt.press/reference/since/2.5.0/">2.5.0</a></td><td>Introduced.</td></tr></tbody></table></figure></section> </section>
<section class="wp-block-wporg-code-reference-comments" data-nosnippet="true"><h2 class="is-toc-heading wp-block-heading" id="user-contributed-notes" tabindex="-1"><a href="#user-contributed-notes">User Contributed Notes</a></h2> <ol class="comment-list"> <li class="comment byuser comment-author-codex odd alt thread-odd thread-alt depth-1" data-comment-id="804" id="comment-804">
<article class="comment-body" id="div-comment-804">
<a class="screen-reader-text" href="#comment-content-804">Skip to note 4 content</a>

<!-- .comment-metadata -->
<div class="wporg-has-embedded-code comment-content" id="comment-content-804">
<p><strong>This function and action can be placed in functions.php of the theme.</strong></p>
<p>Using the hook after_setup_theme will make it run before the headers and cookies are sent, so it can set the needed cookie for login.</p>
<pre class="wp-block-code"><code class="language-php line-numbers" lang="php">/**
 * Perform automatic login.
 */
function wpdocs_custom_login() {
	$creds = array(
		'user_login'    =&gt; 'example',
		'user_password' =&gt; 'plaintextpw',
		'remember'      =&gt; true
	);

	$user = wp_signon( $creds, false );

	if ( is_wp_error( $user ) ) {
		echo $user-&gt;get_error_message();
	}
}

// Run before the headers and cookies are sent.
add_action( 'after_setup_theme', 'wpdocs_custom_login' );</code></pre>
</div><!-- .comment-content -->
<section class="wporg-has-embedded-code feedback hide-if-js" data-comment-count="0" id="feedback-804">
</section><!-- .feedback -->

</article><!-- .comment-body -->
</li>
<li class="comment byuser comment-author-cogdog even thread-even depth-1" data-comment-id="2410" id="comment-2410">
<article class="comment-body" id="div-comment-2410">
<a class="screen-reader-text" href="#comment-content-2410">Skip to note 5 content</a>

<!-- .comment-metadata -->
<div class="wporg-has-embedded-code comment-content" id="comment-content-2410">
<p>If you want to cover your bases for SSL sites that need a secure cookie, I use  (where <code>$creds</code> is the array of login credentials)</p>
<p><code><br>
		$autologin_user = wp_signon( $creds, is_ssl() );<br/>
</br></code></p>
</div><!-- .comment-content -->
<section class="wporg-has-embedded-code feedback hide-if-js" data-comment-count="1" id="feedback-2410">
<ul class="children">
<li class="comment byuser comment-author-pigbot odd alt depth-2" data-comment-id="4277" id="comment-4277">
<article class="comment-body" id="div-comment-4277">
<div class="wporg-has-embedded-code comment-content" id="comment-content-4277">
<div>If you’re not explicitly setting the usage of secure cookies, not passing a second argument will default to setting based on the <code>is_ssl</code> method.</div>
<div><a class="url" href="https://profiles.wordpress.org/pigbot/" rel="external nofollow">Brad Cavanaugh</a> <a class="comment-date" href="https://developer.notmatt.press/reference/functions/wp_signon/#comment-4277"><time datetime="2020-09-20T01:38:27+00:00">4 years ago</time></a></div>
</div><!-- .comment-content -->
</article>
</li>
</ul>
</section><!-- .feedback -->

</article><!-- .comment-body -->
</li>
<li class="comment byuser comment-author-cogdog even thread-odd thread-alt depth-1" data-comment-id="1876" id="comment-1876">
<article class="comment-body" id="div-comment-1876">
<a class="screen-reader-text" href="#comment-content-1876">Skip to note 6 content</a>

<!-- .comment-metadata -->
<div class="wporg-has-embedded-code comment-content" id="comment-content-1876">
<p>I have some sites where in code I log in a visitor to a hidden account (to enable media uploads form front end form), admin bar is hidden, and access to dashboard is blocked. But I have a report where <code>wp_signon()</code> fails and my hunch is because it is on site with SSL. I am guessing I need to use the <code>$secure_cookie</code> option, but I cannot find any info on how to do this.</p>
<p>My guess is I need to set the cookie first with <code>wp_set_auth_cookie()</code> ?? The option there for <code>$secure</code> too is unclear. </p>
<p>And if this is a case, do I need to test first if the host is running SSL? Will setting this cookie on an http:// site break the universe?</p>
</div><!-- .comment-content -->
<section class="wporg-has-embedded-code feedback hide-if-js" data-comment-count="1" id="feedback-1876">
<ul class="children">
<li class="comment byuser comment-author-wpdevjoakim odd alt depth-2" data-comment-id="6321" id="comment-6321">
<article class="comment-body" id="div-comment-6321">
<div class="wporg-has-embedded-code comment-content" id="comment-content-6321">
<div>If your website is using SSL (Secure Socket Layer), then it is recommended to set the secure flag on the authentication cookie by setting the ‘secure’ argument to true when calling <code>wp_set_auth_cookie()</code>. However, since you’re using <code>wp_signon()</code> which already sets the authentication cookie, you can pass the ‘secure’ argument directly to <code>wp_signon()</code>, for example: 
<pre class="wp-block-code"><code class="language-php" lang="php">$user = wp_signon( array( ..., 'secure' =&gt; is_ssl() ), false ); </code></pre>
<p> The second argument of <code>wp_signon()</code> (<code>$secure_cookie</code>) is used to determine whether the WordPress’ default authentication actions should be run or not. By setting it to <code>false</code>, you are indicating that you don’t want the default authentication actions to run, but you still want the authentication cookie to be set. If you set it to true, the default authentication actions will run, but it will also make WordPress start a new session and overwrite any existing authentication cookie, effectively logging out the user.</p></div>
<div><a class="url" href="https://profiles.wordpress.org/wpdevjoakim/" rel="external nofollow">wpdevlol</a> <a class="comment-date" href="https://developer.notmatt.press/reference/functions/wp_signon/#comment-6321"><time datetime="2023-02-02T13:37:47+00:00">2 years ago</time></a></div>
</div><!-- .comment-content -->
</article>
</li>
</ul>
</section><!-- .feedback -->

</article><!-- .comment-body -->
</li>
</ol></section>
</div></div>
    </div>
<footer class="text-center mt-10 py-5">
    <p class="text-sm"><a href="https://notmatt.press">NotMattPress</a>.</p>
</footer>
</body>
</html>
