
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Untitled Page</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@3.3.5/dist/tailwind.min.css" rel="stylesheet">
    <style>
        body {
            background-color: white;
            color: black;
            font-family: 'Quicksand', 'Open Sans', 'Helvetica', 'Arial', san-serif;
        }
        a, h1, h2, h3, h4, h5, h6 {
            color: #0073aa;
        }
        .container {
            max-width: 800px;
            margin: auto;
            padding: 20px;
        }
        .has-small-font-size.is-link-to-top {
            position: absolute;
            bottom: 10px;
            right: 10px;
        }
        .entry-content {
            position:relative;
        }
        .entry-content img {
            max-width: 100%;
        }
    </style>
</head>
<body>
<div class='container'>
    
    <div class="page-metadata" data-published="" data-last-updated=""></div>
    
    <div aria-label="Breadcrumbs" class="wp-block-wporg-site-breadcrumbs has-small-font-size" role="navigation"><div class="wporg-site-breadcrumbs__wrapper"><span><a href="https://developer.notmatt.press">Home</a></span><span><a href="https://developer.notmatt.press/reference/">Reference</a></span><span><a href="https://developer.notmatt.press/reference/functions/">Functions</a></span><span class="is-current-page">wp_update_post()</span></div></div>  <!-- Full breadcrumbs HTML -->
    <h1>wp_update_post()</h1>
    <h1 class="wp-block-wporg-code-reference-title" style="margin-bottom:40px;">wp_update_post( <span class="arg-type">array|object</span> <span class="arg-name">$postarr</span> = <span class="arg-default">array()</span>,  <span class="arg-type">bool</span> <span class="arg-name">$wp_error</span> = <span class="arg-default">false</span>,  <span class="arg-type">bool</span> <span class="arg-name">$fire_after_hooks</span> = <span class="arg-default">true</span> ): <span class="return-type">int|<a href="https://developer.notmatt.press/reference/classes/wp_error/" rel="class">WP_Error</a></span></h1>
    
    <div class="content"><div class="entry-content wp-block-post-content is-layout-flow wp-container-core-post-content-is-layout-1 wp-block-post-content-is-layout-flow">
<section class="wp-block-wporg-code-reference-summary"><p>Updates a post with new post data.</p>
</section>
<section class="wp-block-wporg-code-reference-description"><h2 class="is-toc-heading wp-block-heading has-heading-5-font-size" id="description" tabindex="-1"><a href="#description">Description</a></h2> <p>The date does not have to be set for drafts. You can set the date and it will not be overridden.</p>
</section>
<section class="wp-block-wporg-code-reference-parameters"><h2 class="is-toc-heading wp-block-heading has-heading-5-font-size" id="parameters" tabindex="-1"><a href="#parameters">Parameters</a></h2> <dl><dt><code>$postarr</code><span class="type"><span class="array">array</span>|<span class="object">object</span></span><span class="required">optional</span></dt><dd><div class="desc"><span class="description">Post data. Arrays are expected to be escaped,                                       objects are not. See <a href="https://developer.notmatt.press/reference/functions/wp_insert_post/" rel="function">wp_insert_post()</a>  for accepted arguments.<br/>
Default array.</span><details class="extended-description"><summary>More Arguments from wp_insert_post( … $postarr )</summary><span class="description">An array of elements that make up a post to update or insert.<br/>
<ul class="param-hash"><li><code>ID</code> <span class="type">int</span><div class="desc">The post ID. If equal to something other than 0, the post with that ID will be updated. Default 0.</div></li>
<li><code>post_author</code> <span class="type">int</span><div class="desc">The ID of the user who added the post. Default is the current user ID.</div></li>
<li><code>post_date</code> <span class="type">string</span><div class="desc">The date of the post. Default is the current time.</div></li>
<li><code>post_date_gmt</code> <span class="type">string</span><div class="desc">The date of the post in the GMT timezone. Default is the value of <code>$post_date</code>.</div></li>
<li><code>post_content</code> <span class="type">string</span><div class="desc">The post content. Default empty.</div></li>
<li><code>post_content_filtered</code> <span class="type">string</span><div class="desc">The filtered post content. Default empty.</div></li>
<li><code>post_title</code> <span class="type">string</span><div class="desc">The post title. Default empty.</div></li>
<li><code>post_excerpt</code> <span class="type">string</span><div class="desc">The post excerpt. Default empty.</div></li>
<li><code>post_status</code> <span class="type">string</span><div class="desc">The post status. Default <code>'draft'</code>.</div></li>
<li><code>post_type</code> <span class="type">string</span><div class="desc">The post type. Default <code>'post'</code>.</div></li>
<li><code>comment_status</code> <span class="type">string</span><div class="desc">Whether the post can accept comments. Accepts <code>'open'</code> or <code>'closed'</code>.<br/>
Default is the value of <code>'default_comment_status'</code> option.</div></li>
<li><code>ping_status</code> <span class="type">string</span><div class="desc">Whether the post can accept pings. Accepts <code>'open'</code> or <code>'closed'</code>.<br/>
Default is the value of <code>'default_ping_status'</code> option.</div></li>
<li><code>post_password</code> <span class="type">string</span><div class="desc">The password to access the post. Default empty.</div></li>
<li><code>post_name</code> <span class="type">string</span><div class="desc">The post name. Default is the sanitized post title when creating a new post.</div></li>
<li><code>to_ping</code> <span class="type">string</span><div class="desc">Space or carriage return-separated list of URLs to ping.<br/>
Default empty.</div></li>
<li><code>pinged</code> <span class="type">string</span><div class="desc">Space or carriage return-separated list of URLs that have been pinged. Default empty.</div></li>
<li><code>post_parent</code> <span class="type">int</span><div class="desc">Set this for the post it belongs to, if any. Default 0.</div></li>
<li><code>menu_order</code> <span class="type">int</span><div class="desc">The order the post should be displayed in. Default 0.</div></li>
<li><code>post_mime_type</code> <span class="type">string</span><div class="desc">The mime type of the post. Default empty.</div></li>
<li><code>guid</code> <span class="type">string</span><div class="desc">Global Unique ID for referencing the post. Default empty.</div></li>
<li><code>import_id</code> <span class="type">int</span><div class="desc">The post ID to be used when inserting a new post.<br/>
If specified, must not match any existing post ID. Default 0.</div></li>
<li><code>post_category</code> <span class="type">int[]</span><div class="desc">Array of category IDs.<br/>
Defaults to value of the <code>'default_category'</code> option.</div></li>
<li><code>tags_input</code> <span class="type">array</span><div class="desc">Array of tag names, slugs, or IDs. Default empty.</div></li>
<li><code>tax_input</code> <span class="type">array</span><div class="desc">An array of taxonomy terms keyed by their taxonomy name.<br/>
If the taxonomy is hierarchical, the term list needs to be either an array of term IDs or a comma-separated string of IDs.<br/>
If the taxonomy is non-hierarchical, the term list can be an array that contains term names or slugs, or a comma-separated string of names or slugs. This is because, in hierarchical taxonomy, child terms can have the same names with different parent terms, so the only way to connect them is using ID. Default empty.</div></li>
<li><code>meta_input</code> <span class="type">array</span><div class="desc">Array of post meta values keyed by their post meta key. Default empty.</div></li>
<li><code>page_template</code> <span class="type">string</span><div class="desc">Page template to use.</div></li>
</ul>
</span></details></div><p class="default">Default:<code>array()</code></p></dd><dt><code>$wp_error</code><span class="type"><span class="bool">bool</span></span><span class="required">optional</span></dt><dd><div class="desc"><span class="description">Whether to return a <a href="https://developer.notmatt.press/reference/classes/wp_error/" rel="class">WP_Error</a> on failure. </span></div><p class="default">Default:<code>false</code></p></dd><dt><code>$fire_after_hooks</code><span class="type"><span class="bool">bool</span></span><span class="required">optional</span></dt><dd><div class="desc"><span class="description">Whether to fire the after insert hooks. </span></div><p class="default">Default:<code>true</code></p></dd></dl></section>
<section class="wporg-has-embedded-code wp-block-wporg-code-reference-return-value"><h2 class="is-toc-heading wp-block-heading has-heading-5-font-size" id="return" tabindex="-1"><a href="#return">Return</a></h2> <span class="return-type">int|<a href="https://developer.notmatt.press/reference/classes/wp_error/" rel="class">WP_Error</a></span> The post ID on success. The value 0 or <a href="https://developer.notmatt.press/reference/classes/wp_error/" rel="class">WP_Error</a> on failure.</section>
<section class="wp-block-wporg-code-reference-source"><h2 class="is-toc-heading wp-block-heading has-heading-5-font-size" id="source" tabindex="-1"><a href="#source">Source</a></h2> <pre aria-label="Function source code" class="wp-block-code" data-start="5097"><code class="language-php line-numbers" id="wporg-source-code" lang="php">function wp_update_post( $postarr = array(), $wp_error = false, $fire_after_hooks = true ) {
	if ( is_object( $postarr ) ) {
		// Non-escaped post was passed.
		$postarr = get_object_vars( $postarr );
		$postarr = wp_slash( $postarr );
	}

	// First, get all of the original fields.
	$post = get_post( $postarr['ID'], ARRAY_A );

	if ( is_null( $post ) ) {
		if ( $wp_error ) {
			return new WP_Error( 'invalid_post', __( 'Invalid post ID.' ) );
		}
		return 0;
	}

	// Escape data pulled from DB.
	$post = wp_slash( $post );

	// Passed post category list overwrites existing category list if not empty.
	if ( isset( $postarr['post_category'] ) &amp;&amp; is_array( $postarr['post_category'] )
		&amp;&amp; count( $postarr['post_category'] ) &gt; 0
	) {
		$post_cats = $postarr['post_category'];
	} else {
		$post_cats = $post['post_category'];
	}

	// Drafts shouldn't be assigned a date unless explicitly done so by the user.
	if ( isset( $post['post_status'] )
		&amp;&amp; in_array( $post['post_status'], array( 'draft', 'pending', 'auto-draft' ), true )
		&amp;&amp; empty( $postarr['edit_date'] ) &amp;&amp; ( '0000-00-00 00:00:00' === $post['post_date_gmt'] )
	) {
		$clear_date = true;
	} else {
		$clear_date = false;
	}

	// Merge old and new fields with new fields overwriting old ones.
	$postarr                  = array_merge( $post, $postarr );
	$postarr['post_category'] = $post_cats;
	if ( $clear_date ) {
		$postarr['post_date']     = current_time( 'mysql' );
		$postarr['post_date_gmt'] = '';
	}

	if ( 'attachment' === $postarr['post_type'] ) {
		return wp_insert_attachment( $postarr, false, 0, $wp_error );
	}

	// Discard 'tags_input' parameter if it's the same as existing post tags.
	if ( isset( $postarr['tags_input'] ) &amp;&amp; is_object_in_taxonomy( $postarr['post_type'], 'post_tag' ) ) {
		$tags      = get_the_terms( $postarr['ID'], 'post_tag' );
		$tag_names = array();

		if ( $tags &amp;&amp; ! is_wp_error( $tags ) ) {
			$tag_names = wp_list_pluck( $tags, 'name' );
		}

		if ( $postarr['tags_input'] === $tag_names ) {
			unset( $postarr['tags_input'] );
		}
	}

	return wp_insert_post( $postarr, $wp_error, $fire_after_hooks );
}
</code></pre><p class="wporg-dot-link-list"><a href="https://developer.notmatt.press/reference/files/wp-includes/post.php/">View all references</a> <a href="https://core.trac.notmatt.press/browser/tags/6.7/src/wp-includes/post.php#L5097">View on Trac</a> <a href="https://github.com/WordPress/wordpress-develop/blob/6.7/src/wp-includes/post.php#L5097-L5163">View on GitHub</a></p></section>
<section class="wp-block-wporg-code-reference-related" data-nosnippet="true"><h2 class="is-toc-heading wp-block-heading has-heading-5-font-size" id="related" tabindex="-1"><a href="#related">Related</a></h2> <section class="wp-block-wporg-code-table" id="uses" style="margin-top:var(--wp--preset--spacing--20);"><figure class="wp-block-table"><table><thead><tr><th scope="col">Uses</th><th scope="col">Description</th></tr></thead><tbody><tr class=""><td><a href="https://developer.notmatt.press/reference/functions/get_the_terms/">get_the_terms()</a><code>wp-includes/category-template.php</code></td><td><p>Retrieves the terms of the taxonomy that are attached to the post.</p>
</td></tr><tr class=""><td><a href="https://developer.notmatt.press/reference/functions/wp_list_pluck/">wp_list_pluck()</a><code>wp-includes/functions.php</code></td><td><p>Plucks a certain field out of each object or array in an array.</p>
</td></tr><tr class=""><td><a href="https://developer.notmatt.press/reference/functions/current_time/">current_time()</a><code>wp-includes/functions.php</code></td><td><p>Retrieves the current time based on specified type.</p>
</td></tr><tr class=""><td><a href="https://developer.notmatt.press/reference/functions/is_object_in_taxonomy/">is_object_in_taxonomy()</a><code>wp-includes/taxonomy.php</code></td><td><p>Determines if the given object type is associated with the given taxonomy.</p>
</td></tr><tr class=""><td><a href="https://developer.notmatt.press/reference/functions/wp_insert_attachment/">wp_insert_attachment()</a><code>wp-includes/post.php</code></td><td><p>Inserts an attachment.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/wp_insert_post/">wp_insert_post()</a><code>wp-includes/post.php</code></td><td><p>Inserts or update a post.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/wp_slash/">wp_slash()</a><code>wp-includes/formatting.php</code></td><td><p>Adds slashes to a string or recursively adds slashes to strings within an array.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/get_post/">get_post()</a><code>wp-includes/post.php</code></td><td><p>Retrieves post data given a post ID or post object.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/is_wp_error/">is_wp_error()</a><code>wp-includes/load.php</code></td><td><p>Checks whether the given variable is a WordPress Error.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/classes/wp_error/__construct/">WP_Error::__construct()</a><code>wp-includes/class-wp-error.php</code></td><td><p>Initializes the error.</p>
</td></tr></tbody></table></figure><a class="wp-block-wporg-code-table-show-more" href="#">Show 5 more</a><a class="wp-block-wporg-code-table-show-less" href="#">Show less</a></section> <section class="wp-block-wporg-code-table" id="used-by" style="margin-top:var(--wp--preset--spacing--20);"><figure class="wp-block-table"><table><thead><tr><th scope="col">Used by</th><th scope="col">Description</th></tr></thead><tbody><tr class=""><td><a href="https://developer.notmatt.press/reference/functions/wp_set_unique_slug_on_create_template_part/">wp_set_unique_slug_on_create_template_part()</a><code>wp-includes/theme-templates.php</code></td><td><p>Sets a custom slug when creating auto-draft template parts.</p>
</td></tr><tr class=""><td><a href="https://developer.notmatt.press/reference/classes/wp_rest_templates_controller/update_item/">WP_REST_Templates_Controller::update_item()</a><code>wp-includes/rest-api/endpoints/class-wp-rest-templates-controller.php</code></td><td><p>Updates a single template.</p>
</td></tr><tr class=""><td><a href="https://developer.notmatt.press/reference/classes/wp_rest_autosaves_controller/create_item/">WP_REST_Autosaves_Controller::create_item()</a><code>wp-includes/rest-api/endpoints/class-wp-rest-autosaves-controller.php</code></td><td><p>Creates, updates or deletes an autosave revision.</p>
</td></tr><tr class=""><td><a href="https://developer.notmatt.press/reference/classes/wp_rest_autosaves_controller/create_post_autosave/">WP_REST_Autosaves_Controller::create_post_autosave()</a><code>wp-includes/rest-api/endpoints/class-wp-rest-autosaves-controller.php</code></td><td><p>Creates autosave for the specified post.</p>
</td></tr><tr class=""><td><a href="https://developer.notmatt.press/reference/functions/wp_generate_user_request_key/">wp_generate_user_request_key()</a><code>wp-includes/user.php</code></td><td><p>Returns a confirmation key for a user action and stores the hashed version for future comparison.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/_wp_privacy_account_request_confirmed/">_wp_privacy_account_request_confirmed()</a><code>wp-includes/user.php</code></td><td><p>Updates log when privacy request is confirmed.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/_wp_privacy_completed_request/">_wp_privacy_completed_request()</a><code>wp-admin/includes/privacy-tools.php</code></td><td><p>Marks a request as completed by the admin and logs the current timestamp.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/_wp_personal_data_cleanup_requests/">_wp_personal_data_cleanup_requests()</a><code>wp-admin/includes/privacy-tools.php</code></td><td><p>Cleans up failed and expired requests before displaying the list table.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/classes/wp_customize_manager/save_changeset_post/">WP_Customize_Manager::save_changeset_post()</a><code>wp-includes/class-wp-customize-manager.php</code></td><td><p>Saves the post for the loaded changeset.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/wp_update_custom_css_post/">wp_update_custom_css_post()</a><code>wp-includes/theme.php</code></td><td><p>Updates the <code>custom_css</code> post for a given theme.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/classes/wp_rest_posts_controller/update_item/">WP_REST_Posts_Controller::update_item()</a><code>wp-includes/rest-api/endpoints/class-wp-rest-posts-controller.php</code></td><td><p>Updates a single post.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/classes/wp_customize_nav_menus/save_nav_menus_created_posts/">WP_Customize_Nav_Menus::save_nav_menus_created_posts()</a><code>wp-includes/class-wp-customize-nav-menus.php</code></td><td><p>Publishes the auto-draft posts that were created for nav menu items.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/media_upload_form_handler/">media_upload_form_handler()</a><code>wp-admin/includes/media.php</code></td><td><p>Handles form submissions for the legacy media uploader.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/wp_create_post_autosave/">wp_create_post_autosave()</a><code>wp-admin/includes/post.php</code></td><td><p>Creates autosave data for the specified post from <code>$_POST</code> data.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/_fix_attachment_links/">_fix_attachment_links()</a><code>wp-admin/includes/post.php</code></td><td><p>Replaces hrefs of attachment anchors with up-to-date permalinks.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/edit_post/">edit_post()</a><code>wp-admin/includes/post.php</code></td><td><p>Updates an existing post with values provided in <code>$_POST</code>.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/bulk_edit_posts/">bulk_edit_posts()</a><code>wp-admin/includes/post.php</code></td><td><p>Processes the post data for the bulk editing of posts.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/wp_ajax_save_attachment_order/">wp_ajax_save_attachment_order()</a><code>wp-admin/includes/ajax-actions.php</code></td><td><p>Handles saving the attachment order via AJAX.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/wp_ajax_send_attachment_to_editor/">wp_ajax_send_attachment_to_editor()</a><code>wp-admin/includes/ajax-actions.php</code></td><td><p>Handles sending an attachment to the editor via AJAX.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/wp_ajax_save_attachment/">wp_ajax_save_attachment()</a><code>wp-admin/includes/ajax-actions.php</code></td><td><p>Handles updating attachment attributes via AJAX.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/wp_ajax_save_attachment_compat/">wp_ajax_save_attachment_compat()</a><code>wp-admin/includes/ajax-actions.php</code></td><td><p>Handles saving backward compatible attachment attributes via AJAX.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/classes/wp_embed/shortcode/">WP_Embed::shortcode()</a><code>wp-includes/class-wp-embed.php</code></td><td><p>The <a href="https://developer.notmatt.press/reference/functions/do_shortcode/" rel="function">do_shortcode()</a>  callback function.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/wp_check_post_hierarchy_for_loops/">wp_check_post_hierarchy_for_loops()</a><code>wp-includes/post.php</code></td><td><p>Checks the given subset of the post hierarchy for hierarchy loops.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/wp_trash_post/">wp_trash_post()</a><code>wp-includes/post.php</code></td><td><p>Moves a post or page to the Trash</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/wp_untrash_post/">wp_untrash_post()</a><code>wp-includes/post.php</code></td><td><p>Restores a post from the Trash.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/wp_restore_post_revision/">wp_restore_post_revision()</a><code>wp-includes/revision.php</code></td><td><p>Restores a post to the specified revision.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/wp_update_nav_menu_item/">wp_update_nav_menu_item()</a><code>wp-includes/nav-menu.php</code></td><td><p>Saves the properties of a menu item or create a new one.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/classes/wp_xmlrpc_server/mt_publishpost/">wp_xmlrpc_server::mt_publishPost()</a><code>wp-includes/class-wp-xmlrpc-server.php</code></td><td><p>Sets a post’s publish status to ‘publish’.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/classes/wp_xmlrpc_server/mw_editpost/">wp_xmlrpc_server::mw_editPost()</a><code>wp-includes/class-wp-xmlrpc-server.php</code></td><td><p>Edits a post.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/classes/wp_xmlrpc_server/blogger_editpost/">wp_xmlrpc_server::blogger_editPost()</a><code>wp-includes/class-wp-xmlrpc-server.php</code></td><td><p>Edits a post.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/classes/wp_xmlrpc_server/_insert_post/">wp_xmlrpc_server::_insert_post()</a><code>wp-includes/class-wp-xmlrpc-server.php</code></td><td><p>Helper method for wp_newPost() and wp_editPost(), containing shared logic.</p>
</td></tr></tbody></table></figure><a class="wp-block-wporg-code-table-show-more" href="#">Show 26 more</a><a class="wp-block-wporg-code-table-show-less" href="#">Show less</a></section> </section>
<section class="wp-block-wporg-code-reference-changelog"><h2 class="is-toc-heading wp-block-heading has-heading-5-font-size" id="changelog" tabindex="-1"><a href="#changelog">Changelog</a></h2> <section class="wp-block-wporg-code-table" style="margin-top:var(--wp--preset--spacing--20);"><figure class="wp-block-table"><table><thead><tr><th scope="col">Version</th><th scope="col">Description</th></tr></thead><tbody><tr class=""><td><a href="https://developer.notmatt.press/reference/since/5.6.0/">5.6.0</a></td><td><span class="since-description">Added the <code>$fire_after_hooks</code> parameter.</span></td></tr><tr class=""><td><a href="https://developer.notmatt.press/reference/since/3.5.0/">3.5.0</a></td><td><span class="since-description">Added the <code>$wp_error</code> parameter to allow a <a href="https://developer.notmatt.press/reference/classes/wp_error/" rel="class">WP_Error</a> to be returned on failure.</span></td></tr><tr class=""><td><a href="https://developer.notmatt.press/reference/since/1.0.0/">1.0.0</a></td><td>Introduced.</td></tr></tbody></table></figure></section> </section>
<section class="wp-block-wporg-code-reference-comments" data-nosnippet="true"><h2 class="is-toc-heading wp-block-heading" id="user-contributed-notes" tabindex="-1"><a href="#user-contributed-notes">User Contributed Notes</a></h2> <ol class="comment-list"> <li class="comment byuser comment-author-codex odd alt thread-even depth-1" data-comment-id="843" id="comment-843">
<article class="comment-body" id="div-comment-843">
<a class="screen-reader-text" href="#comment-content-843">Skip to note 9 content</a>

<!-- .comment-metadata -->
<div class="wporg-has-embedded-code comment-content" id="comment-content-843">
<p><strong>Examples</strong></p>
<p>Before calling <a href="https://developer.notmatt.press/reference/functions/wp_update_post/" rel="function">wp_update_post()</a>  it is necessary to create an array to pass the necessary elements. Unlike <a href="https://developer.notmatt.press/reference/functions/wp_insert_post/" rel="function">wp_insert_post()</a> , it is only necessary to pass the ID of the post to be updated and the elements to be updated. The names of the elements should match those in the database.</p>
<pre class="wp-block-code"><code class="language-php line-numbers" lang="php">// Update post 37
  $my_post = array(
      'ID'           =&gt; 37,
      'post_title'   =&gt; 'This is the post title.',
      'post_content' =&gt; 'This is the updated content.',
  );

// Update the post into the database
  wp_update_post( $my_post );
Processing $wp_error</code></pre>
<p>If your updates are not working, there could be an error. It is a good idea to set $wp_error to true and display the error immediately after.</p>
<pre class="wp-block-code"><code class="language-php line-numbers" lang="php">&lt;?php
// Of course, this should be done in an development environment only and commented out or removed after deploying to your production site.

wp_update_post( $current_item, true );						  
if (is_wp_error($post_id)) {
	$errors = $post_id-&gt;get_error_messages();
	foreach ($errors as $error) {
		echo $error;
	}
}
?&gt;</code></pre>
<p><strong>Categories</strong><br>
Categories need to be passed as an array of integers that match the category IDs in the database. This is the case even where only one category is assigned to the post.</br></p>
<p><strong>Caution – Infinite loop</strong><br>
When executed by an action hooked into save_post (e.g. a custom metabox), <a href="https://developer.notmatt.press/reference/functions/wp_update_post/" rel="function">wp_update_post()</a>  has the potential to create an infinite loop. This happens because (1) <a href="https://developer.notmatt.press/reference/functions/wp_update_post/" rel="function">wp_update_post()</a>  results in save_post being fired and (2) save_post is called twice when revisions are enabled (first when creating the revision, then when updating the original post—resulting in the creation of endless revisions).</br></p>
<p>If you must update a post from code called by save_post, make sure to verify the post_type is not set to ‘revision’ and that the $post object does indeed need to be updated.</p>
<p>Likewise, an action hooked into edit_attachment can cause an infinite loop if it contains a function call to wp_update_post passing an array parameter with a key value of “ID” and an associated value that corresponds to an Attachment.</p>
<p>Note you will need to remove then add the hook, code sample modified from the API/Action reference: save_post</p>
<pre class="wp-block-code"><code class="language-php line-numbers" lang="php">&lt;?php
function my_function( $post_id ){
	if ( ! wp_is_post_revision( $post_id ) ){
	
		// unhook this function so it doesn't loop infinitely
		remove_action('save_post', 'my_function');
	
		// update the post, which calls save_post again
		wp_update_post( $my_args );

		// re-hook this function
		add_action('save_post', 'my_function');
	}
}
add_action('save_post', 'my_function');
?&gt;</code></pre>
</div><!-- .comment-content -->
<section class="wporg-has-embedded-code feedback hide-if-js" data-comment-count="0" id="feedback-843">
</section><!-- .feedback -->

</article><!-- .comment-body -->
</li>
<li class="comment byuser comment-author-chadreitsma even thread-odd thread-alt depth-1" data-comment-id="4168" id="comment-4168">
<article class="comment-body" id="div-comment-4168">
<a class="screen-reader-text" href="#comment-content-4168">Skip to note 10 content</a>

<!-- .comment-metadata -->
<div class="wporg-has-embedded-code comment-content" id="comment-content-4168">
<p>You can also update the meta at the same time (if needed)</p>
<pre class="wp-block-code"><code class="language-php line-numbers" lang="php">$data = array(
  'ID' =&gt; $post_id,
  'post_content' =&gt; $content,
  'meta_input' =&gt; array(
    'meta_key' =&gt; $meta_value,
	'another_meta_key' =&gt; $another_meta_value
   )
 );

wp_update_post( $data );</code></pre>
</div><!-- .comment-content -->
<section class="wporg-has-embedded-code feedback hide-if-js" data-comment-count="0" id="feedback-4168">
</section><!-- .feedback -->

</article><!-- .comment-body -->
</li>
<li class="comment byuser comment-author-azamat88 odd alt thread-even depth-1" data-comment-id="4021" id="comment-4021">
<article class="comment-body" id="div-comment-4021">
<a class="screen-reader-text" href="#comment-content-4021">Skip to note 11 content</a>

<!-- .comment-metadata -->
<div class="wporg-has-embedded-code comment-content" id="comment-content-4021">
<p>Programmatically change “publish” (or “draft”) to “future” and schedule the post to be published tomorrow:</p>
<pre class="wp-block-code"><code class="language-php line-numbers" lang="php">$time = strtotime( 'tomorrow' );
$my_post = array(
    'ID'            =&gt; 1,
    'post_status'   =&gt; 'future',
    'post_date'     =&gt; date( 'Y-m-d H:i:s', $time ),
    'post_date_gmt' =&gt; gmdate( 'Y-m-d H:i:s', $time ),
);
wp_update_post( $my_post );</code></pre>
</div><!-- .comment-content -->
<section class="wporg-has-embedded-code feedback hide-if-js" data-comment-count="0" id="feedback-4021">
</section><!-- .feedback -->

</article><!-- .comment-body -->
</li>
<li class="comment byuser comment-author-_smartik_ even thread-odd thread-alt depth-1" data-comment-id="3889" id="comment-3889">
<article class="comment-body" id="div-comment-3889">
<a class="screen-reader-text" href="#comment-content-3889">Skip to note 12 content</a>

<!-- .comment-metadata -->
<div class="wporg-has-embedded-code comment-content" id="comment-content-3889">
<p>If you are losing <strong>backslashes</strong> from <code>post_content</code> field, use <code>wp_slash</code> function to prepare the data: </p>
<pre class="wp-block-code"><code class="language-php" lang="php">wp_update_post( wp_slash( array(
    'ID' =&gt; $postId,
    'post_content' =&gt; $newContent,
) ) );</code></pre>
</div><!-- .comment-content -->
<section class="wporg-has-embedded-code feedback hide-if-js" data-comment-count="0" id="feedback-3889">
</section><!-- .feedback -->

</article><!-- .comment-body -->
</li>
<li class="comment byuser comment-author-irian odd alt thread-even depth-1" data-comment-id="4418" id="comment-4418">
<article class="comment-body" id="div-comment-4418">
<a class="screen-reader-text" href="#comment-content-4418">Skip to note 13 content</a>

<!-- .comment-metadata -->
<div class="wporg-has-embedded-code comment-content" id="comment-content-4418">
<p>When setting the <code>post_date</code>, make sure to also set the <code>post_date_gmt</code>.</p>
<pre class="wp-block-code"><code class="language-php line-numbers" lang="php">// Change the post date on a post with a status other than 'draft', 'pending' or 'auto-draft'
$arg = array(
	'ID'            =&gt; $post_id,
	'post_date'     =&gt; $post_date,
	'post_date_gmt' =&gt; get_gmt_from_date( $post_date ),
);
wp_update_post( $arg );</code></pre>
<p>When you are setting the post date on a ‘draft’, ‘pending’ or ‘auto-draft’ post status, also set <code>edit_date</code> to true, otherwise the post date won’t be changed.</p>
<pre class="wp-block-code"><code class="language-php line-numbers" lang="php">// Change the post date on a post with a status 'draft', 'pending' or 'auto-draft'
$arg = array(
	'ID'            =&gt; $post_id,
	'post_date'     =&gt; $post_date,
	'post_date_gmt' =&gt; get_gmt_from_date( $post_date ),
	'edit_date'     =&gt; true,
);
wp_update_post( $arg );</code></pre>
</div><!-- .comment-content -->
<section class="wporg-has-embedded-code feedback hide-if-js" data-comment-count="0" id="feedback-4418">
</section><!-- .feedback -->

</article><!-- .comment-body -->
</li>
<li class="comment byuser comment-author-knowingart_com even thread-odd thread-alt depth-1" data-comment-id="2628" id="comment-2628">
<article class="comment-body" id="div-comment-2628">
<a class="screen-reader-text" href="#comment-content-2628">Skip to note 14 content</a>

<!-- .comment-metadata -->
<div class="wporg-has-embedded-code comment-content" id="comment-content-2628">
<p>If you’re importing and then applying some updates with this function, it doesn’t recognize ‘import_id’ so remember to also use ‘ID’ too. </p>
<p>In any case, if you “import” with wp_insert_post and then use wp_update_post, you’re going to lose all your featured images and any additional categories you added between import/update will be lost. (The plugin “Featured Image From URL” solves the featured images problem, if it’s activated.)</p>
<p>Also, some of the documentation suggests that you can use an author’s name or a category’s name, but as far as I can tell, you can only use the id numbers for authors and categories when importing/updating content.</p>
</div><!-- .comment-content -->
<section class="wporg-has-embedded-code feedback hide-if-js" data-comment-count="0" id="feedback-2628">
</section><!-- .feedback -->

</article><!-- .comment-body -->
</li>
<li class="comment byuser comment-author-aurovrata odd alt thread-even depth-1 bad-note" data-comment-id="2450" id="comment-2450">
<article class="comment-body" id="div-comment-2450">
<a class="screen-reader-text" href="#comment-content-2450">Skip to note 15 content</a>

<!-- .comment-metadata -->
<div class="wporg-has-embedded-code comment-content" id="comment-content-2450">
<p>programmatically publish a post,</p>
<pre class="wp-block-code"><code class="language-php line-numbers" lang="php">// Puslish post 37
  $my_post = array(
      'ID'           =&gt; 37,
      'post_status'   =&gt; 'publish',
  );
 
// Update the post into the database
  wp_update_post( $my_post );</code></pre>
</div><!-- .comment-content -->
<section class="wporg-has-embedded-code feedback hide-if-js" data-comment-count="0" id="feedback-2450">
</section><!-- .feedback -->

</article><!-- .comment-body -->
</li>
<li class="comment byuser comment-author-ztvmark even thread-odd thread-alt depth-1 bad-note" data-comment-id="2925" id="comment-2925">
<article class="comment-body" id="div-comment-2925">
<a class="screen-reader-text" href="#comment-content-2925">Skip to note 16 content</a>

<!-- .comment-metadata -->
<div class="wporg-has-embedded-code comment-content" id="comment-content-2925">
<pre class="wp-block-code"><code class="language-php line-numbers" lang="php">//Example with acf <a href="https://advancedcustomfields.com" rel="nofollow ugc">https://advancedcustomfields.com</a>
add_action( 'acf/save_post', 'add_category_acf', 20 );

function add_category_acf( $post_id ) {

    //uncomment if a specific post is required example post 490
    //$post_id = 490;
    $post_type = get_post_type( $post_id );

    if ( 'post' == $post_type ) {
        
        //add the default category with id 3
        $data = array(
            'post_category' =&gt; [3],
        );

        wp_update_post( $data );
    }
}</code></pre>
</div><!-- .comment-content -->
<section class="wporg-has-embedded-code feedback hide-if-js" data-comment-count="1" id="feedback-2925">
<ul class="children">
<li class="comment byuser comment-author-aurovrata odd alt depth-2" data-comment-id="4071" id="comment-4071">
<article class="comment-body" id="div-comment-4071">
<div class="wporg-has-embedded-code comment-content" id="comment-content-4071">
<div>this is missing the post ID to update, so it will not work.</div>
<div><a class="url" href="https://profiles.notmatt.press/aurovrata/" rel="external nofollow">Aurovrata Venet</a> <a class="comment-date" href="https://developer.notmatt.press/reference/functions/wp_update_post/#comment-4071"><time datetime="2020-07-22T08:03:03+00:00">5 years ago</time></a></div>
</div><!-- .comment-content -->
</article>
</li>
</ul>
</section><!-- .feedback -->

</article><!-- .comment-body -->
</li>
</ol></section>
</div></div>
    </div>
<footer class="text-center mt-10 py-5">
    <p class="text-sm"><a href="https://notmatt.press">NotMattPress</a>.</p>
</footer>
</body>
</html>
