
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Untitled Page</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@3.3.5/dist/tailwind.min.css" rel="stylesheet">
    <style>
        body {
            background-color: white;
            color: black;
            font-family: 'Quicksand', 'Open Sans', 'Helvetica', 'Arial', san-serif;
        }
        a, h1, h2, h3, h4, h5, h6 {
            color: #0073aa;
        }
        .container {
            max-width: 800px;
            margin: auto;
            padding: 20px;
        }
        .has-small-font-size.is-link-to-top {
            position: absolute;
            bottom: 10px;
            right: 10px;
        }
        .entry-content {
            position:relative;
        }
        .entry-content img {
            max-width: 100%;
        }
    </style>
</head>
<body>
<div class='container'>
    
    <div class="page-metadata" data-published="" data-last-updated=""></div>
    
    <div aria-label="Breadcrumbs" class="wp-block-wporg-site-breadcrumbs has-small-font-size" role="navigation"><div class="wporg-site-breadcrumbs__wrapper"><span><a href="https://developer.notmatt.press">Home</a></span><span><a href="https://developer.notmatt.press/reference/">Reference</a></span><span><a href="https://developer.notmatt.press/reference/functions/">Functions</a></span><span class="is-current-page">register_rest_route()</span></div></div>  <!-- Full breadcrumbs HTML -->
    <h1>register_rest_route()</h1>
    <h1 class="wp-block-wporg-code-reference-title" style="margin-bottom:40px;">register_rest_route( <span class="arg-type">string</span> <span class="arg-name">$route_namespace</span>,  <span class="arg-type">string</span> <span class="arg-name">$route</span>,  <span class="arg-type">array</span> <span class="arg-name">$args</span> = <span class="arg-default">array()</span>,  <span class="arg-type">bool</span> <span class="arg-name">$override</span> = <span class="arg-default">false</span> ): <span class="return-type">bool</span></h1>
    
    <div class="content"><div class="entry-content wp-block-post-content is-layout-flow wp-container-core-post-content-is-layout-1 wp-block-post-content-is-layout-flow">
<section class="wp-block-wporg-code-reference-summary"><p>Registers a REST API route.</p>
</section>
<section class="wp-block-wporg-code-reference-description"><h2 class="is-toc-heading wp-block-heading has-heading-5-font-size" id="description" tabindex="-1"><a href="#description">Description</a></h2> <p>Note: Do not use before the <a href="https://developer.notmatt.press/reference/hooks/rest_api_init/">‘rest_api_init’</a> hook.</p>
</section>
<section class="wp-block-wporg-code-reference-parameters"><h2 class="is-toc-heading wp-block-heading has-heading-5-font-size" id="parameters" tabindex="-1"><a href="#parameters">Parameters</a></h2> <dl><dt><code>$route_namespace</code><span class="type"><span class="string">string</span></span><span class="required">required</span></dt><dd><div class="desc"><span class="description">The first URL segment after core prefix. Should be unique to your package/plugin.</span></div></dd><dt><code>$route</code><span class="type"><span class="string">string</span></span><span class="required">required</span></dt><dd><div class="desc"><span class="description">The base URL for route you are adding.</span></div></dd><dt><code>$args</code><span class="type"><span class="array">array</span></span><span class="required">optional</span></dt><dd><div class="desc"><span class="description">Either an array of options for the endpoint, or an array of arrays for                                multiple methods. </span></div><p class="default">Default:<code>array()</code></p></dd><dt><code>$override</code><span class="type"><span class="bool">bool</span></span><span class="required">optional</span></dt><dd><div class="desc"><span class="description">If the route already exists, should we override it? True overrides,                                false merges (with newer overriding if duplicate keys exist). </span></div><p class="default">Default:<code>false</code></p></dd></dl></section>
<section class="wporg-has-embedded-code wp-block-wporg-code-reference-return-value"><h2 class="is-toc-heading wp-block-heading has-heading-5-font-size" id="return" tabindex="-1"><a href="#return">Return</a></h2> <span class="return-type">bool</span> True on success, false on error.</section>
<section class="wp-block-wporg-code-reference-source"><h2 class="is-toc-heading wp-block-heading has-heading-5-font-size" id="source" tabindex="-1"><a href="#source">Source</a></h2> <pre aria-label="Function source code" class="wp-block-code" data-start="34"><code class="language-php line-numbers" id="wporg-source-code" lang="php">function register_rest_route( $route_namespace, $route, $args = array(), $override = false ) {
	if ( empty( $route_namespace ) ) {
		/*
		 * Non-namespaced routes are not allowed, with the exception of the main
		 * and namespace indexes. If you really need to register a
		 * non-namespaced route, call `WP_REST_Server::register_route` directly.
		 */
		_doing_it_wrong(
			__FUNCTION__,
			sprintf(
				/* translators: 1: string value of the namespace, 2: string value of the route. */
				__( 'Routes must be namespaced with plugin or theme name and version. Instead there seems to be an empty namespace \'%1$s\' for route \'%2$s\'.' ),
				'&lt;code&gt;' . $route_namespace . '&lt;/code&gt;',
				'&lt;code&gt;' . $route . '&lt;/code&gt;'
			),
			'4.4.0'
		);
		return false;
	} elseif ( empty( $route ) ) {
		_doing_it_wrong(
			__FUNCTION__,
			sprintf(
				/* translators: 1: string value of the namespace, 2: string value of the route. */
				__( 'Route must be specified. Instead within the namespace \'%1$s\', there seems to be an empty route \'%2$s\'.' ),
				'&lt;code&gt;' . $route_namespace . '&lt;/code&gt;',
				'&lt;code&gt;' . $route . '&lt;/code&gt;'
			),
			'4.4.0'
		);
		return false;
	}

	$clean_namespace = trim( $route_namespace, '/' );

	if ( $clean_namespace !== $route_namespace ) {
		_doing_it_wrong(
			__FUNCTION__,
			sprintf(
				/* translators: 1: string value of the namespace, 2: string value of the route. */
				__( 'Namespace must not start or end with a slash. Instead namespace \'%1$s\' for route \'%2$s\' seems to contain a slash.' ),
				'&lt;code&gt;' . $route_namespace . '&lt;/code&gt;',
				'&lt;code&gt;' . $route . '&lt;/code&gt;'
			),
			'5.4.2'
		);
	}

	if ( ! did_action( 'rest_api_init' ) ) {
		_doing_it_wrong(
			__FUNCTION__,
			sprintf(
				/* translators: 1: rest_api_init, 2: string value of the route, 3: string value of the namespace. */
				__( 'REST API routes must be registered on the %1$s action. Instead route \'%2$s\' with namespace \'%3$s\' was not registered on this action.' ),
				'&lt;code&gt;rest_api_init&lt;/code&gt;',
				'&lt;code&gt;' . $route . '&lt;/code&gt;',
				'&lt;code&gt;' . $route_namespace . '&lt;/code&gt;'
			),
			'5.1.0'
		);
	}

	if ( isset( $args['args'] ) ) {
		$common_args = $args['args'];
		unset( $args['args'] );
	} else {
		$common_args = array();
	}

	if ( isset( $args['callback'] ) ) {
		// Upgrade a single set to multiple.
		$args = array( $args );
	}

	$defaults = array(
		'methods'  =&gt; 'GET',
		'callback' =&gt; null,
		'args'     =&gt; array(),
	);

	foreach ( $args as $key =&gt; &amp;$arg_group ) {
		if ( ! is_numeric( $key ) ) {
			// Route option, skip here.
			continue;
		}

		$arg_group         = array_merge( $defaults, $arg_group );
		$arg_group['args'] = array_merge( $common_args, $arg_group['args'] );

		if ( ! isset( $arg_group['permission_callback'] ) ) {
			_doing_it_wrong(
				__FUNCTION__,
				sprintf(
					/* translators: 1: The REST API route being registered, 2: The argument name, 3: The suggested function name. */
					__( 'The REST API route definition for %1$s is missing the required %2$s argument. For REST API routes that are intended to be public, use %3$s as the permission callback.' ),
					'&lt;code&gt;' . $clean_namespace . '/' . trim( $route, '/' ) . '&lt;/code&gt;',
					'&lt;code&gt;permission_callback&lt;/code&gt;',
					'&lt;code&gt;__return_true&lt;/code&gt;'
				),
				'5.5.0'
			);
		}

		foreach ( $arg_group['args'] as $arg ) {
			if ( ! is_array( $arg ) ) {
				_doing_it_wrong(
					__FUNCTION__,
					sprintf(
						/* translators: 1: $args, 2: The REST API route being registered. */
						__( 'REST API %1$s should be an array of arrays. Non-array value detected for %2$s.' ),
						'&lt;code&gt;$args&lt;/code&gt;',
						'&lt;code&gt;' . $clean_namespace . '/' . trim( $route, '/' ) . '&lt;/code&gt;'
					),
					'6.1.0'
				);
				break; // Leave the foreach loop once a non-array argument was found.
			}
		}
	}

	$full_route = '/' . $clean_namespace . '/' . trim( $route, '/' );
	rest_get_server()-&gt;register_route( $clean_namespace, $full_route, $args, $override );
	return true;
}
</code></pre><p class="wporg-dot-link-list"><a href="https://developer.notmatt.press/reference/files/wp-includes/rest-api.php/">View all references</a> <a href="https://core.trac.notmatt.press/browser/tags/6.7/src/wp-includes/rest-api.php#L34">View on Trac</a> <a href="https://github.com/WordPress/wordpress-develop/blob/6.7/src/wp-includes/rest-api.php#L34-L156">View on GitHub</a></p></section>
<section class="wp-block-wporg-code-reference-related" data-nosnippet="true"><h2 class="is-toc-heading wp-block-heading has-heading-5-font-size" id="related" tabindex="-1"><a href="#related">Related</a></h2> <section class="wp-block-wporg-code-table" id="uses" style="margin-top:var(--wp--preset--spacing--20);"><figure class="wp-block-table"><table><thead><tr><th scope="col">Uses</th><th scope="col">Description</th></tr></thead><tbody><tr class=""><td><a href="https://developer.notmatt.press/reference/functions/rest_get_server/">rest_get_server()</a><code>wp-includes/rest-api.php</code></td><td><p>Retrieves the current REST server instance.</p>
</td></tr><tr class=""><td><a href="https://developer.notmatt.press/reference/functions/did_action/">did_action()</a><code>wp-includes/plugin.php</code></td><td><p>Retrieves the number of times an action has been fired during the current request.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/_doing_it_wrong/">_doing_it_wrong()</a><code>wp-includes/functions.php</code></td><td><p>Marks something as being incorrectly called.</p>
</td></tr></tbody></table></figure><a class="wp-block-wporg-code-table-show-more" href="#">Show 1 more</a><a class="wp-block-wporg-code-table-show-less" href="#">Show less</a></section> <section class="wp-block-wporg-code-table" id="used-by" style="margin-top:var(--wp--preset--spacing--20);"><figure class="wp-block-table"><table><thead><tr><th scope="col">Used by</th><th scope="col">Description</th></tr></thead><tbody><tr class=""><td><a href="https://developer.notmatt.press/reference/classes/wp_rest_font_faces_controller/register_routes/">WP_REST_Font_Faces_Controller::register_routes()</a><code>wp-includes/rest-api/endpoints/class-wp-rest-font-faces-controller.php</code></td><td><p>Registers the routes for posts.</p>
</td></tr><tr class=""><td><a href="https://developer.notmatt.press/reference/classes/wp_rest_font_collections_controller/register_routes/">WP_REST_Font_Collections_Controller::register_routes()</a><code>wp-includes/rest-api/endpoints/class-wp-rest-font-collections-controller.php</code></td><td><p>Registers the routes for the objects of the controller.</p>
</td></tr><tr class=""><td><a href="https://developer.notmatt.press/reference/classes/wp_rest_template_autosaves_controller/register_routes/">WP_REST_Template_Autosaves_Controller::register_routes()</a><code>wp-includes/rest-api/endpoints/class-wp-rest-template-autosaves-controller.php</code></td><td><p>Registers the routes for autosaves.</p>
</td></tr><tr class=""><td><a href="https://developer.notmatt.press/reference/classes/wp_rest_template_revisions_controller/register_routes/">WP_REST_Template_Revisions_Controller::register_routes()</a><code>wp-includes/rest-api/endpoints/class-wp-rest-template-revisions-controller.php</code></td><td><p>Registers the routes for revisions based on post types supporting revisions.</p>
</td></tr><tr class=""><td><a href="https://developer.notmatt.press/reference/classes/wp_rest_navigation_fallback_controller/register_routes/">WP_REST_Navigation_Fallback_Controller::register_routes()</a><code>wp-includes/rest-api/endpoints/class-wp-rest-navigation-fallback-controller.php</code></td><td><p>Registers the controllers routes.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/classes/wp_rest_global_styles_revisions_controller/register_routes/">WP_REST_Global_Styles_Revisions_Controller::register_routes()</a><code>wp-includes/rest-api/endpoints/class-wp-rest-global-styles-revisions-controller.php</code></td><td><p>Registers the controller’s routes.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/classes/wp_rest_block_patterns_controller/register_routes/">WP_REST_Block_Patterns_Controller::register_routes()</a><code>wp-includes/rest-api/endpoints/class-wp-rest-block-patterns-controller.php</code></td><td><p>Registers the routes for the objects of the controller.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/classes/wp_rest_block_pattern_categories_controller/register_routes/">WP_REST_Block_Pattern_Categories_Controller::register_routes()</a><code>wp-includes/rest-api/endpoints/class-wp-rest-block-pattern-categories-controller.php</code></td><td><p>Registers the routes for the objects of the controller.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/classes/wp_rest_global_styles_controller/register_routes/">WP_REST_Global_Styles_Controller::register_routes()</a><code>wp-includes/rest-api/endpoints/class-wp-rest-global-styles-controller.php</code></td><td><p>Registers the controllers routes.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/classes/wp_rest_url_details_controller/register_routes/">WP_REST_URL_Details_Controller::register_routes()</a><code>wp-includes/rest-api/endpoints/class-wp-rest-url-details-controller.php</code></td><td><p>Registers the necessary REST API routes.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/classes/wp_rest_menu_locations_controller/register_routes/">WP_REST_Menu_Locations_Controller::register_routes()</a><code>wp-includes/rest-api/endpoints/class-wp-rest-menu-locations-controller.php</code></td><td><p>Registers the routes for the objects of the controller.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/classes/wp_rest_edit_site_export_controller/register_routes/">WP_REST_Edit_Site_Export_Controller::register_routes()</a><code>wp-includes/rest-api/endpoints/class-wp-rest-edit-site-export-controller.php</code></td><td><p>Registers the site export route.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/classes/wp_rest_widgets_controller/register_routes/">WP_REST_Widgets_Controller::register_routes()</a><code>wp-includes/rest-api/endpoints/class-wp-rest-widgets-controller.php</code></td><td><p>Registers the widget routes for the controller.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/classes/wp_rest_sidebars_controller/register_routes/">WP_REST_Sidebars_Controller::register_routes()</a><code>wp-includes/rest-api/endpoints/class-wp-rest-sidebars-controller.php</code></td><td><p>Registers the controllers routes.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/classes/wp_rest_templates_controller/register_routes/">WP_REST_Templates_Controller::register_routes()</a><code>wp-includes/rest-api/endpoints/class-wp-rest-templates-controller.php</code></td><td><p>Registers the controllers routes.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/classes/wp_rest_pattern_directory_controller/register_routes/">WP_REST_Pattern_Directory_Controller::register_routes()</a><code>wp-includes/rest-api/endpoints/class-wp-rest-pattern-directory-controller.php</code></td><td><p>Registers the necessary REST API routes.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/classes/wp_rest_widget_types_controller/register_routes/">WP_REST_Widget_Types_Controller::register_routes()</a><code>wp-includes/rest-api/endpoints/class-wp-rest-widget-types-controller.php</code></td><td><p>Registers the widget type routes.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/classes/wp_rest_site_health_controller/register_routes/">WP_REST_Site_Health_Controller::register_routes()</a><code>wp-includes/rest-api/endpoints/class-wp-rest-site-health-controller.php</code></td><td><p>Registers API routes.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/classes/wp_rest_application_passwords_controller/register_routes/">WP_REST_Application_Passwords_Controller::register_routes()</a><code>wp-includes/rest-api/endpoints/class-wp-rest-application-passwords-controller.php</code></td><td><p>Registers the REST API routes for the application passwords controller.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/classes/wp_rest_block_directory_controller/register_routes/">WP_REST_Block_Directory_Controller::register_routes()</a><code>wp-includes/rest-api/endpoints/class-wp-rest-block-directory-controller.php</code></td><td><p>Registers the necessary REST API routes.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/classes/wp_rest_plugins_controller/register_routes/">WP_REST_Plugins_Controller::register_routes()</a><code>wp-includes/rest-api/endpoints/class-wp-rest-plugins-controller.php</code></td><td><p>Registers the routes for the plugins controller.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/classes/wp_rest_block_types_controller/register_routes/">WP_REST_Block_Types_Controller::register_routes()</a><code>wp-includes/rest-api/endpoints/class-wp-rest-block-types-controller.php</code></td><td><p>Registers the routes for block types.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/classes/wp_rest_attachments_controller/register_routes/">WP_REST_Attachments_Controller::register_routes()</a><code>wp-includes/rest-api/endpoints/class-wp-rest-attachments-controller.php</code></td><td><p>Registers the routes for attachments.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/classes/wp_rest_search_controller/register_routes/">WP_REST_Search_Controller::register_routes()</a><code>wp-includes/rest-api/endpoints/class-wp-rest-search-controller.php</code></td><td><p>Registers the routes for the search controller.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/classes/wp_rest_themes_controller/register_routes/">WP_REST_Themes_Controller::register_routes()</a><code>wp-includes/rest-api/endpoints/class-wp-rest-themes-controller.php</code></td><td><p>Registers the routes for themes.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/classes/wp_rest_autosaves_controller/register_routes/">WP_REST_Autosaves_Controller::register_routes()</a><code>wp-includes/rest-api/endpoints/class-wp-rest-autosaves-controller.php</code></td><td><p>Registers the routes for autosaves.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/classes/wp_rest_block_renderer_controller/register_routes/">WP_REST_Block_Renderer_Controller::register_routes()</a><code>wp-includes/rest-api/endpoints/class-wp-rest-block-renderer-controller.php</code></td><td><p>Registers the necessary REST API routes, one for each dynamic block.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/classes/wp_rest_users_controller/register_routes/">WP_REST_Users_Controller::register_routes()</a><code>wp-includes/rest-api/endpoints/class-wp-rest-users-controller.php</code></td><td><p>Registers the routes for users.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/classes/wp_rest_revisions_controller/register_routes/">WP_REST_Revisions_Controller::register_routes()</a><code>wp-includes/rest-api/endpoints/class-wp-rest-revisions-controller.php</code></td><td><p>Registers the routes for revisions based on post types supporting revisions.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/classes/wp_rest_post_statuses_controller/register_routes/">WP_REST_Post_Statuses_Controller::register_routes()</a><code>wp-includes/rest-api/endpoints/class-wp-rest-post-statuses-controller.php</code></td><td><p>Registers the routes for post statuses.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/classes/wp_rest_settings_controller/register_routes/">WP_REST_Settings_Controller::register_routes()</a><code>wp-includes/rest-api/endpoints/class-wp-rest-settings-controller.php</code></td><td><p>Registers the routes for the site’s settings.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/classes/wp_rest_terms_controller/register_routes/">WP_REST_Terms_Controller::register_routes()</a><code>wp-includes/rest-api/endpoints/class-wp-rest-terms-controller.php</code></td><td><p>Registers the routes for terms.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/classes/wp_rest_posts_controller/register_routes/">WP_REST_Posts_Controller::register_routes()</a><code>wp-includes/rest-api/endpoints/class-wp-rest-posts-controller.php</code></td><td><p>Registers the routes for posts.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/classes/wp_rest_taxonomies_controller/register_routes/">WP_REST_Taxonomies_Controller::register_routes()</a><code>wp-includes/rest-api/endpoints/class-wp-rest-taxonomies-controller.php</code></td><td><p>Registers the routes for taxonomies.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/classes/wp_rest_post_types_controller/register_routes/">WP_REST_Post_Types_Controller::register_routes()</a><code>wp-includes/rest-api/endpoints/class-wp-rest-post-types-controller.php</code></td><td><p>Registers the routes for post types.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/classes/wp_rest_comments_controller/register_routes/">WP_REST_Comments_Controller::register_routes()</a><code>wp-includes/rest-api/endpoints/class-wp-rest-comments-controller.php</code></td><td><p>Registers the routes for comments.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/classes/wp_oembed_controller/register_routes/">WP_oEmbed_Controller::register_routes()</a><code>wp-includes/class-wp-oembed-controller.php</code></td><td><p>Register the oEmbed REST API route.</p>
</td></tr></tbody></table></figure><a class="wp-block-wporg-code-table-show-more" href="#">Show 32 more</a><a class="wp-block-wporg-code-table-show-less" href="#">Show less</a></section> </section>
<section class="wp-block-wporg-code-reference-changelog"><h2 class="is-toc-heading wp-block-heading has-heading-5-font-size" id="changelog" tabindex="-1"><a href="#changelog">Changelog</a></h2> <section class="wp-block-wporg-code-table" style="margin-top:var(--wp--preset--spacing--20);"><figure class="wp-block-table"><table><thead><tr><th scope="col">Version</th><th scope="col">Description</th></tr></thead><tbody><tr class=""><td><a href="https://developer.notmatt.press/reference/since/5.5.0/">5.5.0</a></td><td><span class="since-description">Added a <code>_doing_it_wrong()</code> notice when the required <code>permission_callback</code> argument is not set.</span></td></tr><tr class=""><td><a href="https://developer.notmatt.press/reference/since/5.1.0/">5.1.0</a></td><td><span class="since-description">Added a <code>_doing_it_wrong()</code> notice when not called on or after the <code>rest_api_init</code> hook.</span></td></tr><tr class=""><td><a href="https://developer.notmatt.press/reference/since/4.4.0/">4.4.0</a></td><td>Introduced.</td></tr></tbody></table></figure></section> </section>
<section class="wp-block-wporg-code-reference-comments" data-nosnippet="true"><h2 class="is-toc-heading wp-block-heading" id="user-contributed-notes" tabindex="-1"><a href="#user-contributed-notes">User Contributed Notes</a></h2> <ol class="comment-list"> <li class="comment byuser comment-author-alordiel odd alt thread-even depth-1" data-comment-id="4379" id="comment-4379">
<article class="comment-body" id="div-comment-4379">
<a class="screen-reader-text" href="#comment-content-4379">Skip to note 9 content</a>

<!-- .comment-metadata -->
<div class="wporg-has-embedded-code comment-content" id="comment-content-4379">
<p>Since WP 5.5.0 there is a notice if your registration of REST API route is not including the `<code>permission_callback</code>`. You may get some notice in debug.log like the following one:</p>
<p><em>PHP Notice:  register_rest_route was called <strong>incorrectly</strong>. The REST API route definition for <code>/foo</code> is missing the required <code>permission_callback</code> argument. For REST API routes that are intended to be public, use <code>__return_true</code> as the permission callback.</em></p>
<p>To solve this problem you will need to add the `<code>permission_callback</code>` in arguments like the example from the <strong>“Routes and Endpoints Handbook”</strong>: <a href="https://developer.notmatt.press/rest-api/extending-the-rest-api/routes-and-endpoints/#permissions-callback">https://developer.notmatt.press/rest-api/extending-the-rest-api/routes-and-endpoints/#permissions-callback</a></p>
</div><!-- .comment-content -->
<section class="wporg-has-embedded-code feedback hide-if-js" data-comment-count="0" id="feedback-4379">
</section><!-- .feedback -->

</article><!-- .comment-body -->
</li>
<li class="comment byuser comment-author-charlestonsw even thread-odd thread-alt depth-1" data-comment-id="1459" id="comment-1459">
<article class="comment-body" id="div-comment-1459">
<a class="screen-reader-text" href="#comment-content-1459">Skip to note 10 content</a>

<!-- .comment-metadata -->
<div class="wporg-has-embedded-code comment-content" id="comment-content-1459">
<p>Args is a named array that usually includes the keys ‘methods’ and ‘callback’.</p>
<p>‘method’ defines which HTTP methods are to be processed by the function defined by ‘callback’.</p>
<p>‘method’ can be a string of comma-separated HTTP methods or an array of strings of HTTP methods.</p>
<p>A common practice is to use the <a href="https://developer.notmatt.press/reference/classes/wp_rest_server/" rel="class">WP_REST_Server</a> constants to set the ‘method’.</p>
<p>WP_REST_Server::READABLE = ‘GET’</p>
<p>WP_REST_Server::EDITABLE = ‘POST, PUT, PATCH’</p>
<p>WP_REST_Server::DELETABLE = ‘DELETE’</p>
<p>WP_REST_Server::ALLMETHODS = ‘GET, POST, PUT, PATCH, DELETE’</p>
<p><strong>Example</strong></p>
<p><code><br/>
// Get a list of locations.<br/>
// Method GET via wp-json/store-locator-plus//locations/<br/>
//<br/>
// Calls the get_locations method of the current class when the route is matched.<br/>
//<br/>
register_rest_route( 'my-plugin-slug/v2' , '/locations/', array(<br/>
    'methods'  =&gt; 'GET',<br/>
    'callback' =&gt; array(<br/>
        $this,<br/>
        'get_locations'<br/>
    )<br/>
) );<br/>
</code></p>
</div><!-- .comment-content -->
<section class="wporg-has-embedded-code feedback hide-if-js" data-comment-count="1" id="feedback-1459">
<ul class="children">
<li class="comment byuser comment-author-bgoewert odd alt depth-2" data-comment-id="5946" id="comment-5946">
<article class="comment-body" id="div-comment-5946">
<div class="wporg-has-embedded-code comment-content" id="comment-content-5946">
<div>The CREATABLE constant was also added in same version 4.4.0. <code>WP_REST_Server::CREATABLE</code> = ‘POST’</div>
<div><a class="url" href="https://profiles.notmatt.press/bgoewert/" rel="external nofollow">Brennan Goewert</a> <a class="comment-date" href="https://developer.notmatt.press/reference/functions/register_rest_route/#comment-5946"><time datetime="2022-07-29T14:03:06+00:00">3 years ago</time></a></div>
</div><!-- .comment-content -->
</article>
</li>
</ul>
</section><!-- .feedback -->

</article><!-- .comment-body -->
</li>
<li class="comment byuser comment-author-abellowins even thread-even depth-1" data-comment-id="1663" id="comment-1663">
<article class="comment-body" id="div-comment-1663">
<a class="screen-reader-text" href="#comment-content-1663">Skip to note 11 content</a>

<!-- .comment-metadata -->
<div class="wporg-has-embedded-code comment-content" id="comment-content-1663">
<pre class="wp-block-code"><code class="language-php line-numbers" lang="php">//The Following registers an api route with multiple parameters. 
add_action( 'rest_api_init', 'add_custom_users_api');

<pre class="wp-block-code"><code class="language-php" lang="php"></code></pre>function add_custom_users_api(){
    register_rest_route( 'mmw/v1', '/users/market=(?P&lt;market&gt;[a-zA-Z0-9-]+)/lat=(?P&lt;lat&gt;[a-z0-9 .\-]+)/long=(?P&lt;long&gt;[a-z0-9 .\-]+)', array(
        'methods' =&gt; 'GET',
        'callback' =&gt; 'get_custom_users_data',
    ));
}</code></pre>
<p>Make sure that your regex expressions are fine. If the data does not match then the URL will return a 404.<br/>
Some examples are: </p>
<p>(?P[a-zA-Z0-9-]+) for slug (you can change slug for your custom name)<br/>
(?P\d+) for id<br/>
(?P[a-z0-9 .\-]+) for longitude or latitude</p>
<pre class="wp-block-code"><code class="language-php line-numbers" lang="php">//Customize the callback to your liking
function get_custom_users_data($data){
    //get users by market
    $users = mmw_get_custom_users();
    foreach ($users as $key =&gt; $user) {
        $market = $user['Market'];
        $long = $user['long'];
        $lat = $user['lat'];

        if( intval($market) === intval(trim($data['market'])) ){
            $result[] = array(
                'user_login' =&gt; $user-&gt;user_login,
                'avatar_url' =&gt; get_avatar_url($user-&gt;ID),
                'lat' =&gt; $lat,
                'long' =&gt; $long
            );
        }
    }
    return $result;
}</code></pre>
<p><em>Edited to remove an extra <code>)</code> in one of the regexes. – DevHub Team</em></p>
</div><!-- .comment-content -->
<section class="wporg-has-embedded-code feedback hide-if-js" data-comment-count="1" id="feedback-1663">
<ul class="children">
<li class="comment byuser comment-author-jagirbahesh odd alt depth-2" data-comment-id="4398" id="comment-4398">
<article class="comment-body" id="div-comment-4398">
<div class="wporg-has-embedded-code comment-content" id="comment-content-4398">
<div>After version 5.5.0 <strong>permission callback</strong> is <strong>required</strong>. If you did not pass the permission callback in $args  Then you can see the below error.  <em>register_rest_route was called incorrectly. The REST API route definition for $route is missing the required permission_callback argument. For REST API routes that are intended to be public, use __return_true as the permission callback. Please see Debugging in WordPress for more information. (This message was added in version 5.5.0.)</em> <strong>Here I have shared the example for your reference:</strong> 
<pre class="wp-block-code"><code class="language-php" lang="php">// Pass this action in your __construct of your class. add_action( 'rest_api_init', array( $this, 'action__rest_api_init' ) );  /**  * [action__rest_api_init description]  *  * @return {[type]} [description]  */ function action__rest_api_init() { 	register_rest_route( 		'licences', // $namespace  		'/removed', // $route 		array( 			'callback' =&amp;gt;  array( $this, 'api__removed' ), 			'permission_callback' =&amp;gt; '__return_true', 		) 	); }  /**  * [api__removed description]  *  * @return {[type]} [description]  */ function api__removed() { 	// do you code }</code></pre>
<p> <strong>Note:</strong> – licences and /removed only use for example.</p></div>
<div><a class="url" href="https://profiles.notmatt.press/jagirbahesh/" rel="external nofollow">Jagir Bahesh</a> <a class="comment-date" href="https://developer.notmatt.press/reference/functions/register_rest_route/#comment-4398"><time datetime="2020-10-15T17:22:36+00:00">4 years ago</time></a></div>
</div><!-- .comment-content -->
</article>
</li>
</ul>
</section><!-- .feedback -->

</article><!-- .comment-body -->
</li>
<li class="comment byuser comment-author-derhans even thread-odd thread-alt depth-1" data-comment-id="4782" id="comment-4782">
<article class="comment-body" id="div-comment-4782">
<a class="screen-reader-text" href="#comment-content-4782">Skip to note 12 content</a>

<!-- .comment-metadata -->
<div class="wporg-has-embedded-code comment-content" id="comment-content-4782">
<p>In case you are a friend of type hinting and are wondering what is being passed to your <code>callback</code> method, it’s a <code>WP_REST_Request</code> object. It might help you with autocompletion and discovering other methods provided.</p>
<pre class="wp-block-code"><code class="language-php" lang="php">public function wpdocs_get_lineitems( WP_REST_Request $data ) {
	$params = $data-&gt;get_url_params();
	// etc.
}</code></pre>
</div><!-- .comment-content -->
<section class="wporg-has-embedded-code feedback hide-if-js" data-comment-count="0" id="feedback-4782">
</section><!-- .feedback -->

</article><!-- .comment-body -->
</li>
<li class="comment byuser comment-author-charlestonsw odd alt thread-even depth-1" data-comment-id="1460" id="comment-1460">
<article class="comment-body" id="div-comment-1460">
<a class="screen-reader-text" href="#comment-content-1460">Skip to note 13 content</a>

<!-- .comment-metadata -->
<div class="wporg-has-embedded-code comment-content" id="comment-content-1460">
<p>Args , the named array cited above, can also contain an optional ‘args’ array of its own.</p>
<p>The second args array contains the default arguments, required arguments, validation callback, and sanitization callback that are in place for each argument passed in with the REST request.    The key name of this array is the name of the parameter being passed.</p>
<p>See <a href="http://v2.wp-api.org/extending/adding/" rel="nofollow ugc">http://v2.wp-api.org/extending/adding/</a> under the “Arguments” section for more information and examples.</p>
<p><strong>Example</strong><br/>
<code><br/>
&lt;?php<br/>
add_action( 'rest_api_init', function () {<br/>
    register_rest_route( 'myplugin/v1', '/author/(?P\d+)', array(<br/>
        'methods' =&gt; 'GET',<br/>
        'callback' =&gt; 'my_awesome_func',<br/>
        'args' =&gt; array(<br/>
            'id' =&gt; array(<br/>
                'validate_callback' =&gt; function($param, $request, $key) {<br/>
                    return is_numeric( $param );<br/>
                }<br/>
            ),<br/>
        ),<br/>
    ) );<br/>
} );<br/>
</code></p>
</div><!-- .comment-content -->
<section class="wporg-has-embedded-code feedback hide-if-js" data-comment-count="0" id="feedback-1460">
</section><!-- .feedback -->

</article><!-- .comment-body -->
</li>
<li class="comment byuser comment-author-sourav926 even thread-odd thread-alt depth-1" data-comment-id="4788" id="comment-4788">
<article class="comment-body" id="div-comment-4788">
<a class="screen-reader-text" href="#comment-content-4788">Skip to note 14 content</a>

<!-- .comment-metadata -->
<div class="wporg-has-embedded-code comment-content" id="comment-content-4788">
<p>1. You can not use <code>/</code> (slash) at the beginning or end of the namespace, for example: <code>plugin_name/api/</code>.<br/>
2. <code>permission_callback</code> is required argument of <code>register_rest_route</code>.</p>
<pre class="wp-block-code"><code class="language-php line-numbers" lang="php">function plugin_name_create_route() {
        add_action( 'rest_api_init', function() {
            register_rest_route( 'plugin_name/api', '/token/', array(
                'methods' =&gt; 'POST',
                'callback' =&gt;  'plugin_name_route_api',
                ‘permission_callback' =&gt; function() { return ''; }
            ) );
        } );
 }</code></pre>
<p>1. Callback takes the request object as a parameter.<br/>
2. You can set the response headers with <code>WP_Error</code> class.</p>
<pre class="wp-block-code"><code class="language-php line-numbers" lang="php">function plugin_name_route_api( \WP_REST_Request $req ) {
	$token = get_option('bearer_token');
	$headers = $req-&gt;get_headers();
	$auth_token = $headers['authorization'][0];

	if ( $token != $auth_token ) {
		return new WP_Error( '401', esc_html__( 'Not Authorized', 'text_domain' ), array( 'status' =&gt; 401 ) );
	}

	return json_encode(["message" =&gt; "Authorized"]);
}</code></pre>
</div><!-- .comment-content -->
<section class="wporg-has-embedded-code feedback hide-if-js" data-comment-count="1" id="feedback-4788">
<ul class="children">
<li class="comment byuser comment-author-lev0 odd alt depth-2" data-comment-id="6526" id="comment-6526">
<article class="comment-body" id="div-comment-6526">
<div class="wporg-has-embedded-code comment-content" id="comment-content-6526">
<div>Returning the empty string in the <code>permission_callback</code> is equivalent to granting access. Using <code>'__return_true'</code> is preferred if the intention is to make an API public.</div>
<div><a class="url" href="https://profiles.notmatt.press/lev0/" rel="external nofollow">Roy Orbitson</a> <a class="comment-date" href="https://developer.notmatt.press/reference/functions/register_rest_route/#comment-6526"><time datetime="2023-06-26T07:16:23+00:00">2 years ago</time></a></div>
</div><!-- .comment-content -->
</article>
</li>
</ul>
</section><!-- .feedback -->

</article><!-- .comment-body -->
</li>
<li class="comment byuser comment-author-m_uysl even thread-even depth-1" data-comment-id="2272" id="comment-2272">
<article class="comment-body" id="div-comment-2272">
<a class="screen-reader-text" href="#comment-content-2272">Skip to note 15 content</a>

<!-- .comment-metadata -->
<div class="wporg-has-embedded-code comment-content" id="comment-content-2272">
<p>for the non-namespaced routing, call <code>WP_REST_Server::register_route</code> directly.<br/>
<strong>Example</strong></p>
<pre class="wp-block-code"><code class="language-php line-numbers" lang="php">add_action( 'rest_api_init', function ( $server ) {
	$server-&gt;register_route( 'foo', '/foo', array(
		'methods'  =&gt; 'GET',
		'callback' =&gt; function () {
			return 'baz';
		},
	) );
} );</code></pre>
<p>will register <code>foo</code> endpoint without namespace. You can access <code>http://example.com/wp-json/foo</code><br/>
As a reminder, please ensure before registering non-namespaced routes. They can be useful for backward compatibility only.</p>
</div><!-- .comment-content -->
<section class="wporg-has-embedded-code feedback hide-if-js" data-comment-count="0" id="feedback-2272">
</section><!-- .feedback -->

</article><!-- .comment-body -->
</li>
<li class="comment byuser comment-author-lev0 odd alt thread-odd thread-alt depth-1" data-comment-id="6525" id="comment-6525">
<article class="comment-body" id="div-comment-6525">
<a class="screen-reader-text" href="#comment-content-6525">Skip to note 16 content</a>

<!-- .comment-metadata -->
<div class="wporg-has-embedded-code comment-content" id="comment-content-6525">
<p>The <code>permission_callback</code> should return one of <code>false</code>, <code>null</code>, or a <code>WP_Error</code> if access is to be disallowed. Anything else, including other “falsey” values, will grant access.</p>
</div><!-- .comment-content -->
<section class="wporg-has-embedded-code feedback hide-if-js" data-comment-count="0" id="feedback-6525">
</section><!-- .feedback -->

</article><!-- .comment-body -->
</li>
</ol></section>
</div></div>
    </div>
<footer class="text-center mt-10 py-5">
    <p class="text-sm"><a href="https://notmatt.press">NotMattPress</a>.</p>
</footer>
</body>
</html>
