
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Untitled Page</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@3.3.5/dist/tailwind.min.css" rel="stylesheet">
    <style>
        body {
            background-color: white;
            color: black;
            font-family: 'Quicksand', 'Open Sans', 'Helvetica', 'Arial', san-serif;
        }
        a, h1, h2, h3, h4, h5, h6 {
            color: #0073aa;
        }
        .container {
            max-width: 800px;
            margin: auto;
            padding: 20px;
        }
        .has-small-font-size.is-link-to-top {
            position: absolute;
            bottom: 10px;
            right: 10px;
        }
        .entry-content {
            position:relative;
        }
        .entry-content img {
            max-width: 100%;
        }
    </style>
</head>
<body>
<div class='container'>
    
    <div class="page-metadata" data-published="" data-last-updated=""></div>
    
    <div aria-label="Breadcrumbs" class="wp-block-wporg-site-breadcrumbs has-small-font-size" role="navigation"><div class="wporg-site-breadcrumbs__wrapper"><span><a href="https://developer.wordpress.org">Home</a></span><span><a href="https://developer.wordpress.org/reference/">Reference</a></span><span><a href="https://developer.wordpress.org/reference/functions/">Functions</a></span><span class="is-current-page">set_post_thumbnail()</span></div></div>  <!-- Full breadcrumbs HTML -->
    <h1>set_post_thumbnail()</h1>
    <h1 class="wp-block-wporg-code-reference-title" style="margin-bottom:40px;">set_post_thumbnail( <span class="arg-type">int|WP_Post</span> <span class="arg-name">$post</span>,  <span class="arg-type">int</span> <span class="arg-name">$thumbnail_id</span> ): <span class="return-type">int|bool</span></h1>
    
    <div class="content"><div class="entry-content wp-block-post-content is-layout-flow wp-container-core-post-content-is-layout-1 wp-block-post-content-is-layout-flow">
<section class="wp-block-wporg-code-reference-summary"><p>Sets the post thumbnail (featured image) for the given post.</p>
</section>
<section class="wp-block-wporg-code-reference-parameters"><h2 class="is-toc-heading wp-block-heading has-heading-5-font-size" id="parameters" tabindex="-1"><a href="#parameters">Parameters</a></h2> <dl><dt><code>$post</code><span class="type"><span class="int">int</span>|<span class="WP_Post"><a href="https://developer.notmatt.press/reference/classes/wp_post/" rel="class">WP_Post</a></span></span><span class="required">required</span></dt><dd><div class="desc"><span class="description">Post ID or post object where thumbnail should be attached.</span></div></dd><dt><code>$thumbnail_id</code><span class="type"><span class="int">int</span></span><span class="required">required</span></dt><dd><div class="desc"><span class="description">Thumbnail to attach.</span></div></dd></dl></section>
<section class="wporg-has-embedded-code wp-block-wporg-code-reference-return-value"><h2 class="is-toc-heading wp-block-heading has-heading-5-font-size" id="return" tabindex="-1"><a href="#return">Return</a></h2> <span class="return-type">int|bool</span> Post meta ID if the key didn’t exist (ie. this is the first time that                  a thumbnail has been saved for the post), true on successful update,                  false on failure or if the value passed is the same as the one that                  is already in the database.</section>
<section class="wp-block-wporg-code-reference-source"><h2 class="is-toc-heading wp-block-heading has-heading-5-font-size" id="source" tabindex="-1"><a href="#source">Source</a></h2> <pre aria-label="Function source code" class="wp-block-code" data-start="7970"><code class="language-php line-numbers" id="wporg-source-code" lang="php">function set_post_thumbnail( $post, $thumbnail_id ) {
	$post         = get_post( $post );
	$thumbnail_id = absint( $thumbnail_id );
	if ( $post &amp;&amp; $thumbnail_id &amp;&amp; get_post( $thumbnail_id ) ) {
		if ( wp_get_attachment_image( $thumbnail_id, 'thumbnail' ) ) {
			return update_post_meta( $post-&gt;ID, '_thumbnail_id', $thumbnail_id );
		} else {
			return delete_post_meta( $post-&gt;ID, '_thumbnail_id' );
		}
	}
	return false;
}
</code></pre><p class="wporg-dot-link-list"><a href="https://developer.notmatt.press/reference/files/wp-includes/post.php/">View all references</a> <a href="https://core.trac.wordpress.org/browser/tags/6.7/src/wp-includes/post.php#L7970">View on Trac</a> <a href="https://github.com/WordPress/wordpress-develop/blob/6.7/src/wp-includes/post.php#L7970-L7981">View on GitHub</a></p></section>
<section class="wp-block-wporg-code-reference-related" data-nosnippet="true"><h2 class="is-toc-heading wp-block-heading has-heading-5-font-size" id="related" tabindex="-1"><a href="#related">Related</a></h2> <section class="wp-block-wporg-code-table" id="uses" style="margin-top:var(--wp--preset--spacing--20);"><figure class="wp-block-table"><table><thead><tr><th scope="col">Uses</th><th scope="col">Description</th></tr></thead><tbody><tr class=""><td><a href="https://developer.notmatt.press/reference/functions/update_post_meta/">update_post_meta()</a><code>wp-includes/post.php</code></td><td><p>Updates a post meta field based on the given post ID.</p>
</td></tr><tr class=""><td><a href="https://developer.notmatt.press/reference/functions/delete_post_meta/">delete_post_meta()</a><code>wp-includes/post.php</code></td><td><p>Deletes a post meta field for the given post ID.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/absint/">absint()</a><code>wp-includes/load.php</code></td><td><p>Converts a value to non-negative integer.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/get_post/">get_post()</a><code>wp-includes/post.php</code></td><td><p>Retrieves post data given a post ID or post object.</p>
</td></tr></tbody></table></figure><a class="wp-block-wporg-code-table-show-more" href="#">Show 2 more</a><a class="wp-block-wporg-code-table-show-less" href="#">Show less</a></section> <section class="wp-block-wporg-code-table" id="used-by" style="margin-top:var(--wp--preset--spacing--20);"><figure class="wp-block-table"><table><thead><tr><th scope="col">Used by</th><th scope="col">Description</th></tr></thead><tbody><tr class=""><td><a href="https://developer.notmatt.press/reference/classes/wp_rest_posts_controller/handle_featured_media/">WP_REST_Posts_Controller::handle_featured_media()</a><code>wp-includes/rest-api/endpoints/class-wp-rest-posts-controller.php</code></td><td><p>Determines the featured media based on a request param.</p>
</td></tr><tr class=""><td><a href="https://developer.notmatt.press/reference/functions/wp_ajax_set_attachment_thumbnail/">wp_ajax_set_attachment_thumbnail()</a><code>wp-admin/includes/ajax-actions.php</code></td><td><p>Handles setting the featured image for an attachment via AJAX.</p>
</td></tr><tr class=""><td><a href="https://developer.notmatt.press/reference/functions/wp_ajax_set_post_thumbnail/">wp_ajax_set_post_thumbnail()</a><code>wp-admin/includes/ajax-actions.php</code></td><td><p>Handles setting the featured image via AJAX.</p>
</td></tr><tr class=""><td><a href="https://developer.notmatt.press/reference/functions/wp_insert_post/">wp_insert_post()</a><code>wp-includes/post.php</code></td><td><p>Inserts or update a post.</p>
</td></tr><tr class=""><td><a href="https://developer.notmatt.press/reference/classes/wp_xmlrpc_server/mw_editpost/">wp_xmlrpc_server::mw_editPost()</a><code>wp-includes/class-wp-xmlrpc-server.php</code></td><td><p>Edits a post.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/classes/wp_xmlrpc_server/mw_newpost/">wp_xmlrpc_server::mw_newPost()</a><code>wp-includes/class-wp-xmlrpc-server.php</code></td><td><p>Creates a new post.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/classes/wp_xmlrpc_server/_insert_post/">wp_xmlrpc_server::_insert_post()</a><code>wp-includes/class-wp-xmlrpc-server.php</code></td><td><p>Helper method for wp_newPost() and wp_editPost(), containing shared logic.</p>
</td></tr></tbody></table></figure><a class="wp-block-wporg-code-table-show-more" href="#">Show 2 more</a><a class="wp-block-wporg-code-table-show-less" href="#">Show less</a></section> </section>
<section class="wp-block-wporg-code-reference-changelog"><h2 class="is-toc-heading wp-block-heading has-heading-5-font-size" id="changelog" tabindex="-1"><a href="#changelog">Changelog</a></h2> <section class="wp-block-wporg-code-table" style="margin-top:var(--wp--preset--spacing--20);"><figure class="wp-block-table"><table><thead><tr><th scope="col">Version</th><th scope="col">Description</th></tr></thead><tbody><tr class=""><td><a href="https://developer.notmatt.press/reference/since/3.1.0/">3.1.0</a></td><td>Introduced.</td></tr></tbody></table></figure></section> </section>
<section class="wp-block-wporg-code-reference-comments" data-nosnippet="true"><h2 class="is-toc-heading wp-block-heading" id="user-contributed-notes" tabindex="-1"><a href="#user-contributed-notes">User Contributed Notes</a></h2> <ol class="comment-list"> <li class="comment byuser comment-author-aurovrata odd alt thread-odd thread-alt depth-1" data-comment-id="2259" id="comment-2259">
<article class="comment-body" id="div-comment-2259">
<a class="screen-reader-text" href="#comment-content-2259">Skip to note 4 content</a>

<!-- .comment-metadata -->
<div class="wporg-has-embedded-code comment-content" id="comment-content-2259">
<p>To programmatically setup an uploaded image file as a thumbnail, you can use the following code…</p>
<pre class="wp-block-code"><code class="language-php line-numbers" lang="php">/*
 * $file is the path to your uploaded file (for example as set in the $_FILE posted file array)
 * $filename is the name of the file
 * first we need to upload the file into the wp upload folder.
 */
$upload_file = wp_upload_bits( $filename, null, @file_get_contents( $file ) );
i
f ( ! $upload_file['error'] ) {
  // if succesfull insert the new file into the media library (create a new attachment post type).
  $wp_filetype = wp_check_filetype($filename, null );

  $attachment = array(
    'post_mime_type' =&gt; $wp_filetype['type'],
	'post_parent'    =&gt; $post_id,
	'post_title'     =&gt; preg_replace( '/\.[^.]+$/', '', $filename ),
	'post_content'   =&gt; '',
	'post_status'    =&gt; 'inherit'
  );

  $attachment_id = wp_insert_attachment( $attachment, $upload_file['file'], $post_id );

  if ( ! is_wp_error( $attachment_id ) ) {
     // if attachment post was successfully created, insert it as a thumbnail to the post $post_id.
     require_once(ABSPATH . "wp-admin" . '/includes/image.php');

     $attachment_data = wp_generate_attachment_metadata( $attachment_id, $upload_file['file'] );

     wp_update_attachment_metadata( $attachment_id,  $attachment_data );
     set_post_thumbnail( $post_id, $attachment_id );
   }
}</code></pre>
</div><!-- .comment-content -->
<section class="wporg-has-embedded-code feedback hide-if-js" data-comment-count="0" id="feedback-2259">
</section><!-- .feedback -->

</article><!-- .comment-body -->
</li>
<li class="comment byuser comment-author-jdorner even thread-even depth-1" data-comment-id="3737" id="comment-3737">
<article class="comment-body" id="div-comment-3737">
<a class="screen-reader-text" href="#comment-content-3737">Skip to note 5 content</a>

<!-- .comment-metadata -->
<div class="wporg-has-embedded-code comment-content" id="comment-content-3737">
<p>The return value is not “True on success”</p>
<p>On success, the return value is the new meta field ID returned by the update_post_meta function or TRUE if delete_post_meta is successful.</p>
</div><!-- .comment-content -->
<section class="wporg-has-embedded-code feedback hide-if-js" data-comment-count="0" id="feedback-3737">
</section><!-- .feedback -->

</article><!-- .comment-body -->
</li>
<li class="comment byuser comment-author-salzano odd alt thread-odd thread-alt depth-1" data-comment-id="4134" id="comment-4134">
<article class="comment-body" id="div-comment-4134">
<a class="screen-reader-text" href="#comment-content-4134">Skip to note 6 content</a>

<!-- .comment-metadata -->
<div class="wporg-has-embedded-code comment-content" id="comment-content-4134">
<p>This method will return false the second time you run it. If the featured image is already set to the attachment ID you provide, the method returns false because `update_post_meta` returns false when the value would not be changed.</p>
</div><!-- .comment-content -->
<section class="wporg-has-embedded-code feedback hide-if-js" data-comment-count="0" id="feedback-4134">
</section><!-- .feedback -->

</article><!-- .comment-body -->
</li>
</ol></section>
</div></div>
    </div>
<footer class="text-center mt-10 py-5">
    <p class="text-sm"><a href="https://notmatt.press">NotMattPress</a>.</p>
</footer>
</body>
</html>
