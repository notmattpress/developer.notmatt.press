
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Untitled Page</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@3.3.5/dist/tailwind.min.css" rel="stylesheet">
    <style>
        body {
            background-color: white;
            color: black;
            font-family: 'Quicksand', 'Open Sans', 'Helvetica', 'Arial', san-serif;
        }
        a, h1, h2, h3, h4, h5, h6 {
            color: #0073aa;
        }
        .container {
            max-width: 800px;
            margin: auto;
            padding: 20px;
        }
        .has-small-font-size.is-link-to-top {
            position: absolute;
            bottom: 10px;
            right: 10px;
        }
        .entry-content {
            position:relative;
        }
        .entry-content img {
            max-width: 100%;
        }
    </style>
</head>
<body>
<div class='container'>
    
    <div class="page-metadata" data-published="" data-last-updated=""></div>
    
    <div aria-label="Breadcrumbs" class="wp-block-wporg-site-breadcrumbs has-small-font-size" role="navigation"><div class="wporg-site-breadcrumbs__wrapper"><span><a href="https://developer.wordpress.org">Home</a></span><span><a href="https://developer.wordpress.org/reference/">Reference</a></span><span><a href="https://developer.wordpress.org/reference/functions/">Functions</a></span><span class="is-current-page">register_rest_field()</span></div></div>  <!-- Full breadcrumbs HTML -->
    <h1>register_rest_field()</h1>
    <h1 class="wp-block-wporg-code-reference-title" style="margin-bottom:40px;">register_rest_field( <span class="arg-type">string|array</span> <span class="arg-name">$object_type</span>,  <span class="arg-type">string</span> <span class="arg-name">$attribute</span>,  <span class="arg-type">array</span> <span class="arg-name">$args</span> = <span class="arg-default">array()</span> )</h1>
    
    <div class="content"><div class="entry-content wp-block-post-content is-layout-flow wp-container-core-post-content-is-layout-1 wp-block-post-content-is-layout-flow">
<section class="wp-block-wporg-code-reference-summary"><p>Registers a new field on an existing WordPress object type.</p>
</section>
<section class="wp-block-wporg-code-reference-parameters"><h2 class="is-toc-heading wp-block-heading has-heading-5-font-size" id="parameters" tabindex="-1"><a href="#parameters">Parameters</a></h2> <dl><dt><code>$object_type</code><span class="type"><span class="string">string</span>|<span class="array">array</span></span><span class="required">required</span></dt><dd><div class="desc"><span class="description">Object(s) the field is being registered to,                                  "post"|"term"|"comment" etc.</span></div></dd><dt><code>$attribute</code><span class="type"><span class="string">string</span></span><span class="required">required</span></dt><dd><div class="desc"><span class="description">The attribute name.</span></div></dd><dt><code>$args</code><span class="type"><span class="array">array</span></span><span class="required">optional</span></dt><dd><div class="desc"><span class="description">An array of arguments used to handle the registered field.<br/>
<ul class="param-hash"><li><code>get_callback</code> <span class="type">callable|null</span><div class="desc">Optional. The callback function used to retrieve the field value. Default is <code>'null'</code>, the field will not be returned in the response. The function will be passed the prepared object data.</div></li>
<li><code>update_callback</code> <span class="type">callable|null</span><div class="desc">Optional. The callback function used to set and update the field value. Default is <code>'null'</code>, the value cannot be set or updated. The function will be passed the model object, like <a href="https://developer.notmatt.press/reference/classes/wp_post/" rel="class">WP_Post</a>.</div></li>
<li><code>schema</code> <span class="type">array|null</span><div class="desc">Optional. The schema for this field.<br/>
Default is <code>'null'</code>, no schema entry will be returned.</div></li>
</ul>
</span></div><p class="default">Default:<code>array()</code></p></dd></dl></section>
<section class="wp-block-wporg-code-reference-source"><h2 class="is-toc-heading wp-block-heading has-heading-5-font-size" id="source" tabindex="-1"><a href="#source">Source</a></h2> <pre aria-label="Function source code" class="wp-block-code" data-start="182"><code class="language-php line-numbers" id="wporg-source-code" lang="php">function register_rest_field( $object_type, $attribute, $args = array() ) {
	global $wp_rest_additional_fields;

	$defaults = array(
		'get_callback'    =&gt; null,
		'update_callback' =&gt; null,
		'schema'          =&gt; null,
	);

	$args = wp_parse_args( $args, $defaults );

	$object_types = (array) $object_type;

	foreach ( $object_types as $object_type ) {
		$wp_rest_additional_fields[ $object_type ][ $attribute ] = $args;
	}
}
</code></pre><p class="wporg-dot-link-list"><a href="https://developer.notmatt.press/reference/files/wp-includes/rest-api.php/">View all references</a> <a href="https://core.trac.wordpress.org/browser/tags/6.7/src/wp-includes/rest-api.php#L182">View on Trac</a> <a href="https://github.com/WordPress/wordpress-develop/blob/6.7/src/wp-includes/rest-api.php#L182-L198">View on GitHub</a></p></section>
<section class="wp-block-wporg-code-reference-related" data-nosnippet="true"><h2 class="is-toc-heading wp-block-heading has-heading-5-font-size" id="related" tabindex="-1"><a href="#related">Related</a></h2> <section class="wp-block-wporg-code-table" id="uses" style="margin-top:var(--wp--preset--spacing--20);"><figure class="wp-block-table"><table><thead><tr><th scope="col">Uses</th><th scope="col">Description</th></tr></thead><tbody><tr class=""><td><a href="https://developer.notmatt.press/reference/functions/wp_parse_args/">wp_parse_args()</a><code>wp-includes/functions.php</code></td><td><p>Merges user defined arguments into defaults array.</p>
</td></tr></tbody></table></figure></section> <section class="wp-block-wporg-code-table" id="used-by" style="margin-top:var(--wp--preset--spacing--20);"><figure class="wp-block-table"><table><thead><tr><th scope="col">Used by</th><th scope="col">Description</th></tr></thead><tbody><tr class=""><td><a href="https://developer.notmatt.press/reference/classes/wp_rest_meta_fields/register_field/">WP_REST_Meta_Fields::register_field()</a><code>wp-includes/rest-api/fields/class-wp-rest-meta-fields.php</code></td><td><p>Registers the meta field.</p>
</td></tr></tbody></table></figure></section> </section>
<section class="wp-block-wporg-code-reference-changelog"><h2 class="is-toc-heading wp-block-heading has-heading-5-font-size" id="changelog" tabindex="-1"><a href="#changelog">Changelog</a></h2> <section class="wp-block-wporg-code-table" style="margin-top:var(--wp--preset--spacing--20);"><figure class="wp-block-table"><table><thead><tr><th scope="col">Version</th><th scope="col">Description</th></tr></thead><tbody><tr class=""><td><a href="https://developer.notmatt.press/reference/since/4.7.0/">4.7.0</a></td><td>Introduced.</td></tr></tbody></table></figure></section> </section>
<section class="wp-block-wporg-code-reference-comments" data-nosnippet="true"><h2 class="is-toc-heading wp-block-heading" id="user-contributed-notes" tabindex="-1"><a href="#user-contributed-notes">User Contributed Notes</a></h2> <ol class="comment-list"> <li class="comment byuser comment-author-corradomatt odd alt thread-odd thread-alt depth-1" data-comment-id="2260" id="comment-2260">
<article class="comment-body" id="div-comment-2260">
<a class="screen-reader-text" href="#comment-content-2260">Skip to note 8 content</a>

<!-- .comment-metadata -->
<div class="wporg-has-embedded-code comment-content" id="comment-content-2260">
<p>GET callbacks accept up to 4 arguments in order…</p>
<ul>
<li>$post – (object) Post or custom post type object of the request.</li>
<li>$attr – (string) Rest field/attr string identifier from the second parameter of your <code>register_rest_field()</code> declaration.</li>
<li>$request – (object) Full request payload – as a <a href="https://developer.notmatt.press/reference/classes/wp_rest_request/" rel="class">WP_REST_Request</a> object</li>
<li>$object_type – (string) The object type which the field is registered against. Typically first parameter of your <code>register_rest_field()</code> declaration.</li>
</ul>
<p>Post callbacks accept the above arguments but also a 5th argument in the first position which is the value being passed from the POST request to the attribute/field.</p>
</div><!-- .comment-content -->
<section class="wporg-has-embedded-code feedback hide-if-js" data-comment-count="3" id="feedback-2260">
<ul class="children">
<li class="comment byuser comment-author-aepp even depth-2" data-comment-id="2615" id="comment-2615">
<article class="comment-body" id="div-comment-2615">
<div class="wporg-has-embedded-code comment-content" id="comment-content-2615">
<div>The order for update callback is not correct (anymore?). As of March 2018, WordPress 4.9.4 the order of arguments in <strong>update_callback</strong>: $metaValue, $object, $metaKey.</div>
<div><a class="url" href="https://profiles.wordpress.org/aepp/" rel="external nofollow">aepp</a> <a class="comment-date" href="https://developer.notmatt.press/reference/functions/register_rest_field/#comment-2615"><time datetime="2018-03-28T22:02:33+00:00">7 years ago</time></a></div>
</div><!-- .comment-content -->
</article>
</li>
<li class="comment byuser comment-author-dingo_d odd alt depth-2" data-comment-id="4150" id="comment-4150">
<article class="comment-body" id="div-comment-4150">
<div class="wporg-has-embedded-code comment-content" id="comment-content-4150">
<div>The first argument in the get is post array, not object. Thanks for this tip, I was looking on how to add REST request and this saved me tons of time.</div>
<div><a class="url" href="https://profiles.wordpress.org/dingo_d/" rel="external nofollow">Denis Žoljom</a> <a class="comment-date" href="https://developer.notmatt.press/reference/functions/register_rest_field/#comment-4150"><time datetime="2020-08-17T11:17:48+00:00">4 years ago</time></a></div>
</div><!-- .comment-content -->
</article>
</li>
<li class="comment byuser comment-author-markhowellsmead even depth-2" data-comment-id="6001" id="comment-6001">
<article class="comment-body" id="div-comment-6001">
<div class="wporg-has-embedded-code comment-content" id="comment-content-6001">
<div>The fourth parameter is no longer accepted.</div>
<div><a class="url" href="https://profiles.wordpress.org/markhowellsmead/" rel="external nofollow">Mark Howells-Mead</a> <a class="comment-date" href="https://developer.notmatt.press/reference/functions/register_rest_field/#comment-6001"><time datetime="2022-08-30T09:16:39+00:00">2 years ago</time></a></div>
</div><!-- .comment-content -->
</article>
</li>
</ul>
</section><!-- .feedback -->

</article><!-- .comment-body -->
</li>
<li class="comment byuser comment-author-manzoorwanijk odd alt thread-even depth-1" data-comment-id="3434" id="comment-3434">
<article class="comment-body" id="div-comment-3434">
<a class="screen-reader-text" href="#comment-content-3434">Skip to note 9 content</a>

<!-- .comment-metadata -->
<div class="wporg-has-embedded-code comment-content" id="comment-content-3434">
<p>To make use of <code>sanitize_callback</code> and <code>validate_callback</code>, pass those in <code>arg_options</code> in <code>schema</code></p>
<pre class="wp-block-code"><code class="language-php line-numbers" lang="php">// Make sure to use PHP &gt;= 5.4
add_action(
	'rest_api_init',
	function () {
		// Field name to register.
		$field = 'my_field';
		register_rest_field(
			'post',
			$field,
			array(
				'get_callback'    =&gt; function ( $object ) use ( $field ) {
					// Get field as single value from post meta.
					return get_post_meta( $object['id'], $field, true );
				},
				'update_callback' =&gt; function ( $value, $object ) use ( $field ) {
					// Update the field/meta value.
					update_post_meta( $object-&gt;ID, $field, $value );
				},
				'schema'          =&gt; array(
					'type'        =&gt; 'string',
					'arg_options' =&gt; array(
						'sanitize_callback' =&gt; function ( $value ) {
							// Make the value safe for storage.
							return sanitize_text_field( $value );
						},
						'validate_callback' =&gt; function ( $value ) {
							// Valid if it contains exactly 10 English letters.
							return (bool) preg_match( '/\A[a-z]{10}\Z/', $value );
						},
					),
				),
			)
		);
	}
);</code></pre>
</div><!-- .comment-content -->
<section class="wporg-has-embedded-code feedback hide-if-js" data-comment-count="0" id="feedback-3434">
</section><!-- .feedback -->

</article><!-- .comment-body -->
</li>
<li class="comment byuser comment-author-finchps even thread-odd thread-alt depth-1" data-comment-id="2145" id="comment-2145">
<article class="comment-body" id="div-comment-2145">
<a class="screen-reader-text" href="#comment-content-2145">Skip to note 10 content</a>

<!-- .comment-metadata -->
<div class="wporg-has-embedded-code comment-content" id="comment-content-2145">
<p>An example to add all of the post meta to a <code>post-meta-fields</code> field:</p>
<pre class="wp-block-code"><code class="language-php line-numbers" lang="php">add_action( 'rest_api_init', 'create_api_posts_meta_field' );

function create_api_posts_meta_field() {

	// register_rest_field ( 'name-of-post-type', 'name-of-field-to-return', array-of-callbacks-and-schema() )
	register_rest_field( 'post', 'post-meta-fields', array(
	       'get_callback'    =&gt; 'get_post_meta_for_api',
	       'schema'          =&gt; null,
	    )
	);
}

function get_post_meta_for_api( $object ) {
	//get the id of the post object array
	$post_id = $object['id'];

	//return the post meta
 	return get_post_meta( $post_id );
}</code></pre>
<p>This can be extended or edited. For example, if you don’t want to include all the post meta, you can filter it, or return only the field you need. The options are limitless, but the callback gives you access to the post object, which exposes the <code>id</code> among other parameters, so you can use many different helper functions.</p>
</div><!-- .comment-content -->
<section class="wporg-has-embedded-code feedback hide-if-js" data-comment-count="0" id="feedback-2145">
</section><!-- .feedback -->

</article><!-- .comment-body -->
</li>
<li class="comment byuser comment-author-aepp odd alt thread-even depth-1" data-comment-id="2616" id="comment-2616">
<article class="comment-body" id="div-comment-2616">
<a class="screen-reader-text" href="#comment-content-2616">Skip to note 11 content</a>

<!-- .comment-metadata -->
<div class="wporg-has-embedded-code comment-content" id="comment-content-2616">
<p>This code works (also with shipped Backbone client) in WordPress <strong>4.9.4</strong>:</p>
<pre class="wp-block-code"><code class="language-php line-numbers" lang="php">$meta = [
    'key' =&gt; 'my_post_type_name',
    'description' =&gt; 'This is the name of my post type',
    'type' =&gt; 'string'
];

\register_rest_field('my_post_type', $meta['key'], [
    'get_callback' =&gt; function ($params) use ($meta) {
        return \get_post_meta($params['id'], $meta['key'], true);
    },
    'update_callback' =&gt; function ($value, $object, $fieldName){
        return \update_post_meta($object-&gt;ID, $fieldName, $value);
    }
]);</code></pre>
</div><!-- .comment-content -->
<section class="wporg-has-embedded-code feedback hide-if-js" data-comment-count="0" id="feedback-2616">
</section><!-- .feedback -->

</article><!-- .comment-body -->
</li>
<li class="comment byuser comment-author-talentedaamer even thread-odd thread-alt depth-1" data-comment-id="3065" id="comment-3065">
<article class="comment-body" id="div-comment-3065">
<a class="screen-reader-text" href="#comment-content-3065">Skip to note 12 content</a>

<!-- .comment-metadata -->
<div class="wporg-has-embedded-code comment-content" id="comment-content-3065">
<p>An example to add post featured image src to the ‘featured_image_src’ field.</p>
<pre class="wp-block-code"><code class="language-php line-numbers" lang="php">add_action( 'rest_api_init', function () {
	register_rest_field( 'post', 'featured_image_src', array(
		'get_callback' =&gt; function ( $post_arr ) {
			$image_src_arr = wp_get_attachment_image_src( $post_arr['featured_media'], 'medium' );

			return $image_src_arr[0];
		},
		'update_callback' =&gt; null,
		'schema' =&gt; null
	) );
} );</code></pre>
<p>Helpful for showing featured image in gutenberg block development when posts are fetched with withSelect() function.</p>
</div><!-- .comment-content -->
<section class="wporg-has-embedded-code feedback hide-if-js" data-comment-count="0" id="feedback-3065">
</section><!-- .feedback -->

</article><!-- .comment-body -->
</li>
<li class="comment byuser comment-author-mymonoo odd alt thread-even depth-1" data-comment-id="2737" id="comment-2737">
<article class="comment-body" id="div-comment-2737">
<a class="screen-reader-text" href="#comment-content-2737">Skip to note 13 content</a>

<!-- .comment-metadata -->
<div class="wporg-has-embedded-code comment-content" id="comment-content-2737">
<p>Custom sql queries can be achieved to get whatever value you want from database. The following queries shows how can we modify rest output to show something from our custom table ‘wp_it_job_details’ which is, of course,  inside WordPress database. Put it in your themes/plugins functions.php</p>
<pre class="wp-block-code"><code class="language-php line-numbers" lang="php">function add_last_date_data() {
  //Last date
  register_rest_field( 'post',
    'last_date',
    array(
        'get_callback'  =&gt; 'rest_get_last_date',
        'update_callback'   =&gt; null,
        'schema'            =&gt; null,
     )
  );
}
function rest_get_last_date( $object ) {
    //get the Post Id
    $post_id = $object['id'];
	global $wpdb;
	$sql = "SELECT * FROM wp_it_job_details WHERE post_id = '$post_id'"; //wp_it_job_details is job table
	$results = $wpdb-&gt;get_row($sql);
		if(count($results) &gt; 0) {
			//We have this post_id row in the table
			return $results-&gt;last_date;	//last_date is the column name, change to your's
    
		} else return ""; //return nothing 
		
    
}
add_action( 'rest_api_init', 'add_last_date_data' );</code></pre>
</div><!-- .comment-content -->
<section class="wporg-has-embedded-code feedback hide-if-js" data-comment-count="0" id="feedback-2737">
</section><!-- .feedback -->

</article><!-- .comment-body -->
</li>
<li class="comment byuser comment-author-systemosa even thread-odd thread-alt depth-1 bad-note" data-comment-id="2091" id="comment-2091">
<article class="comment-body" id="div-comment-2091">
<a class="screen-reader-text" href="#comment-content-2091">Skip to note 14 content</a>

<!-- .comment-metadata -->
<div class="wporg-has-embedded-code comment-content" id="comment-content-2091">
<pre class="wp-block-code"><code class="language-php line-numbers" lang="php">// assume there custom post_type named events 
add_action( 'rest_api_init', function() {
    register_rest_field( 'events', 'event_date', array(

        'get_callback' =&amp;gt; function( $comment_arr ) {
            $comment_obj = get_field('event_date', $comment_arr['id'] );
            return $comment_obj;
        },

        'update_callback' =&amp;gt; function( $karma, $comment_obj ) {
            update_field('event_date', $karma, $comment_arr['id'] );
            return true;
        },

        'schema' =&amp;gt; array(
            'event_date' =&amp;gt; __( 'event_date' ),
            'type'        =&amp;gt; 'text'
        ),

    ));

});</code></pre>
</div><!-- .comment-content -->
<section class="wporg-has-embedded-code feedback hide-if-js" data-comment-count="1" id="feedback-2091">
<ul class="children">
<li class="comment byuser comment-author-aepp odd alt depth-2" data-comment-id="2617" id="comment-2617">
<article class="comment-body" id="div-comment-2617">
<div class="wporg-has-embedded-code comment-content" id="comment-content-2617">
<div>This <strong>update_callback</strong> returns an error, since <strong>$comment_obj</strong> is an instance of <strong>\<a href="https://developer.notmatt.press/reference/classes/wp_post/" rel="class">WP_Post</a></strong>. It should be instead $comment_obj-&gt;ID.</div>
<div><a class="url" href="https://profiles.wordpress.org/aepp/" rel="external nofollow">aepp</a> <a class="comment-date" href="https://developer.notmatt.press/reference/functions/register_rest_field/#comment-2617"><time datetime="2018-03-28T22:13:18+00:00">7 years ago</time></a></div>
</div><!-- .comment-content -->
</article>
</li>
</ul>
</section><!-- .feedback -->

</article><!-- .comment-body -->
</li>
</ol></section>
</div></div>
    </div>
<footer class="text-center mt-10 py-5">
    <p class="text-sm"><a href="https://notmatt.press">NotMattPress</a>.</p>
</footer>
</body>
</html>
