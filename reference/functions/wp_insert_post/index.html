
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Untitled Page</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@3.3.5/dist/tailwind.min.css" rel="stylesheet">
    <style>
        body {
            background-color: white;
            color: black;
            font-family: 'Quicksand', 'Open Sans', 'Helvetica', 'Arial', san-serif;
        }
        a, h1, h2, h3, h4, h5, h6 {
            color: #0073aa;
        }
        .container {
            max-width: 800px;
            margin: auto;
            padding: 20px;
        }
        .has-small-font-size.is-link-to-top {
            position: absolute;
            bottom: 10px;
            right: 10px;
        }
        .entry-content {
            position:relative;
        }
        .entry-content img {
            max-width: 100%;
        }
    </style>
</head>
<body>
<div class='container'>
    
    <div class="page-metadata" data-published="" data-last-updated=""></div>
    
    <div aria-label="Breadcrumbs" class="wp-block-wporg-site-breadcrumbs has-small-font-size" role="navigation"><div class="wporg-site-breadcrumbs__wrapper"><span><a href="https://developer.wordpress.org">Home</a></span><span><a href="https://developer.wordpress.org/reference/">Reference</a></span><span><a href="https://developer.wordpress.org/reference/functions/">Functions</a></span><span class="is-current-page">wp_insert_post()</span></div></div>  <!-- Full breadcrumbs HTML -->
    <h1>wp_insert_post()</h1>
    <h1 class="wp-block-wporg-code-reference-title" style="margin-bottom:40px;">wp_insert_post( <span class="arg-type">array</span> <span class="arg-name">$postarr</span>,  <span class="arg-type">bool</span> <span class="arg-name">$wp_error</span> = <span class="arg-default">false</span>,  <span class="arg-type">bool</span> <span class="arg-name">$fire_after_hooks</span> = <span class="arg-default">true</span> ): <span class="return-type">int|<a href="https://developer.wordpress.org/reference/classes/wp_error/" rel="class">WP_Error</a></span></h1>
    
    <div class="content"><div class="entry-content wp-block-post-content is-layout-flow wp-container-core-post-content-is-layout-1 wp-block-post-content-is-layout-flow">
<section class="wp-block-wporg-code-reference-summary"><p>Inserts or update a post.</p>
</section>
<section class="wp-block-wporg-code-reference-description"><h2 class="is-toc-heading wp-block-heading has-heading-5-font-size" id="description" tabindex="-1"><a href="#description">Description</a></h2> <p>If the $postarr parameter has ‘ID’ set to a value, then post will be updated.</p>
<p>You can set the post date manually, by setting the values for ‘post_date’ and ‘post_date_gmt’ keys. You can close the comments or open the comments by setting the value for ‘comment_status’ key.</p>
<h3 class="is-toc-heading has-heading-5-font-size" id="see-also" tabindex="-1"><a href="#see-also">See also</a></h3><ul><li><a href="https://developer.notmatt.press/reference/functions/sanitize_post">sanitize_post()</a></li>
</ul></section>
<section class="wp-block-wporg-code-reference-parameters"><h2 class="is-toc-heading wp-block-heading has-heading-5-font-size" id="parameters" tabindex="-1"><a href="#parameters">Parameters</a></h2> <dl><dt><code>$postarr</code><span class="type"><span class="array">array</span></span><span class="required">required</span></dt><dd><div class="desc"><span class="description">An array of elements that make up a post to update or insert.<br/>
<ul class="param-hash"><li><code>ID</code> <span class="type">int</span><div class="desc">The post ID. If equal to something other than 0, the post with that ID will be updated. Default 0.</div></li>
<li><code>post_author</code> <span class="type">int</span><div class="desc">The ID of the user who added the post. Default is the current user ID.</div></li>
<li><code>post_date</code> <span class="type">string</span><div class="desc">The date of the post. Default is the current time.</div></li>
<li><code>post_date_gmt</code> <span class="type">string</span><div class="desc">The date of the post in the GMT timezone. Default is the value of <code>$post_date</code>.</div></li>
<li><code>post_content</code> <span class="type">string</span><div class="desc">The post content. Default empty.</div></li>
<li><code>post_content_filtered</code> <span class="type">string</span><div class="desc">The filtered post content. Default empty.</div></li>
<li><code>post_title</code> <span class="type">string</span><div class="desc">The post title. Default empty.</div></li>
<li><code>post_excerpt</code> <span class="type">string</span><div class="desc">The post excerpt. Default empty.</div></li>
<li><code>post_status</code> <span class="type">string</span><div class="desc">The post status. Default <code>'draft'</code>.</div></li>
<li><code>post_type</code> <span class="type">string</span><div class="desc">The post type. Default <code>'post'</code>.</div></li>
<li><code>comment_status</code> <span class="type">string</span><div class="desc">Whether the post can accept comments. Accepts <code>'open'</code> or <code>'closed'</code>.<br/>
Default is the value of <code>'default_comment_status'</code> option.</div></li>
<li><code>ping_status</code> <span class="type">string</span><div class="desc">Whether the post can accept pings. Accepts <code>'open'</code> or <code>'closed'</code>.<br/>
Default is the value of <code>'default_ping_status'</code> option.</div></li>
<li><code>post_password</code> <span class="type">string</span><div class="desc">The password to access the post. Default empty.</div></li>
<li><code>post_name</code> <span class="type">string</span><div class="desc">The post name. Default is the sanitized post title when creating a new post.</div></li>
<li><code>to_ping</code> <span class="type">string</span><div class="desc">Space or carriage return-separated list of URLs to ping.<br/>
Default empty.</div></li>
<li><code>pinged</code> <span class="type">string</span><div class="desc">Space or carriage return-separated list of URLs that have been pinged. Default empty.</div></li>
<li><code>post_parent</code> <span class="type">int</span><div class="desc">Set this for the post it belongs to, if any. Default 0.</div></li>
<li><code>menu_order</code> <span class="type">int</span><div class="desc">The order the post should be displayed in. Default 0.</div></li>
<li><code>post_mime_type</code> <span class="type">string</span><div class="desc">The mime type of the post. Default empty.</div></li>
<li><code>guid</code> <span class="type">string</span><div class="desc">Global Unique ID for referencing the post. Default empty.</div></li>
<li><code>import_id</code> <span class="type">int</span><div class="desc">The post ID to be used when inserting a new post.<br/>
If specified, must not match any existing post ID. Default 0.</div></li>
<li><code>post_category</code> <span class="type">int[]</span><div class="desc">Array of category IDs.<br/>
Defaults to value of the <code>'default_category'</code> option.</div></li>
<li><code>tags_input</code> <span class="type">array</span><div class="desc">Array of tag names, slugs, or IDs. Default empty.</div></li>
<li><code>tax_input</code> <span class="type">array</span><div class="desc">An array of taxonomy terms keyed by their taxonomy name.<br/>
If the taxonomy is hierarchical, the term list needs to be either an array of term IDs or a comma-separated string of IDs.<br/>
If the taxonomy is non-hierarchical, the term list can be an array that contains term names or slugs, or a comma-separated string of names or slugs. This is because, in hierarchical taxonomy, child terms can have the same names with different parent terms, so the only way to connect them is using ID. Default empty.</div></li>
<li><code>meta_input</code> <span class="type">array</span><div class="desc">Array of post meta values keyed by their post meta key. Default empty.</div></li>
<li><code>page_template</code> <span class="type">string</span><div class="desc">Page template to use.</div></li>
</ul>
</span></div></dd><dt><code>$wp_error</code><span class="type"><span class="bool">bool</span></span><span class="required">optional</span></dt><dd><div class="desc"><span class="description">Whether to return a <a href="https://developer.notmatt.press/reference/classes/wp_error/" rel="class">WP_Error</a> on failure. </span></div><p class="default">Default:<code>false</code></p></dd><dt><code>$fire_after_hooks</code><span class="type"><span class="bool">bool</span></span><span class="required">optional</span></dt><dd><div class="desc"><span class="description">Whether to fire the after insert hooks. </span></div><p class="default">Default:<code>true</code></p></dd></dl></section>
<section class="wporg-has-embedded-code wp-block-wporg-code-reference-return-value"><h2 class="is-toc-heading wp-block-heading has-heading-5-font-size" id="return" tabindex="-1"><a href="#return">Return</a></h2> <span class="return-type">int|<a href="https://developer.notmatt.press/reference/classes/wp_error/" rel="class">WP_Error</a></span> The post ID on success. The value 0 or <a href="https://developer.notmatt.press/reference/classes/wp_error/" rel="class">WP_Error</a> on failure.</section>
<section class="wporg-has-embedded-code wp-block-wporg-code-reference-explanation"><h2 class="is-toc-heading wp-block-heading has-heading-5-font-size" id="more-information" tabindex="-1"><a href="#more-information">More Information</a></h2>
<h3 class="is-toc-heading wp-block-heading" id="usage" tabindex="-1"><a href="#usage">Usage</a></h3>
<pre class="wp-block-code"><code class="language-php" lang="php">wp_insert_post( $post, $wp_error );</code></pre>
<h3 class="is-toc-heading wp-block-heading" id="notes" tabindex="-1"><a href="#notes">Notes</a></h3>
<ul class="wp-block-list">
<li><tt>post_title</tt> and <tt>post_content</tt> are required</li>
<li><tt>post_status</tt>: If providing a post_status of ‘future’ you must specify the post_date in order for WordPress to know when to publish your post. See also <a href="https://codex.wordpress.org/Post_Status_Transitions" title="Post Status Transitions">Post Status Transitions</a>.</li>
<li><tt>post_category</tt>: Equivalent to calling <a href="https://developer.notmatt.press/reference/functions/wp_set_post_categories/" title="Function Reference/wp set post categories">wp_set_post_categories()</a>.</li>
<li><tt>tags_input</tt>: Equivalent to calling <a href="https://developer.notmatt.press/reference/functions/wp_set_post_tags/" title="Function Reference/wp set post tags">wp_set_post_tags()</a>.</li>
<li><tt>tax_input</tt>: Equivalent to calling <a href="https://developer.notmatt.press/reference/functions/wp_set_post_terms/" title="Function Reference/wp set post terms">wp_set_post_terms()</a> for each custom taxonomy in the array. If the current user doesn’t have the capability to work with a taxonomy, then you must use <a href="https://developer.notmatt.press/reference/functions/wp_set_object_terms/" title="Function Reference/wp set object terms">wp_set_object_terms()</a> instead.</li>
<li><tt>page_template</tt>: If post_type is ‘page’, will attempt to set the <a href="https://codex.wordpress.org/Page_Templates" title="Page Templates">page template</a>. On failure, the function will return either a <a href="https://developer.notmatt.press/reference/classes/wp_error/" rel="class">WP_Error</a> or 0, and stop before the final actions are called. If the post_type is not ‘page’, the parameter is ignored. You can set the page template for a non-page by calling <a href="https://developer.notmatt.press/reference/functions/update_post_meta/" title="Function Reference/update post meta">update_post_meta()</a> with a key of ‘_wp_page_template’.</li>
</ul>
<h3 class="is-toc-heading wp-block-heading" id="categories" tabindex="-1"><a href="#categories">Categories</a></h3>
<p>Categories need to be passed as an array of integers that match the category IDs in the database. This is the case even where only one category is assigned to the post.</p>
<p>See also: <a href="https://developer.notmatt.press/reference/functions/wp_set_post_terms/" title="Function Reference/wp set post terms">wp_set_post_terms()</a></p>
<h3 class="is-toc-heading wp-block-heading" id="security" tabindex="-1"><a href="#security">Security</a></h3>
<p><tt><a href="https://developer.notmatt.press/reference/functions/wp_insert_post/" rel="function">wp_insert_post()</a> </tt> passes data through <a href="_wp_link_placeholder">sanitize_post()</a>, which itself handles all necessary sanitization and validation (kses, etc.).</p>
<p>As such, you don’t need to worry about that.</p>
<p>You may wish, however, to remove HTML, JavaScript, and PHP tags from the post_title and any other fields. Surprisingly, WordPress does not do this automatically. This can be easily done by using the <a href="_wp_link_placeholder">wp_strip_all_tags()</a> function and is especially useful when building front-end post submission forms.</p>
<pre class="wp-block-code"><code class="language-php line-numbers" lang="php">// Create post object
$my_post = array(
'post_title'    =&gt; wp_strip_all_tags( $_POST['post_title'] ),
'post_content'  =&gt; $_POST['post_content'],
'post_status'   =&gt; 'publish',
'post_author'   =&gt; 1,
'post_category' =&gt; array( 8,39 )
);

// Insert the post into the database
wp_insert_post( $my_post );</code></pre>
</section>
<section class="wp-block-wporg-code-reference-source"><h2 class="is-toc-heading wp-block-heading has-heading-5-font-size" id="source" tabindex="-1"><a href="#source">Source</a></h2> <pre aria-label="Function source code" class="wp-block-code" data-start="4382"><code class="language-php line-numbers" id="wporg-source-code" lang="php">function wp_insert_post( $postarr, $wp_error = false, $fire_after_hooks = true ) {
	global $wpdb;

	// Capture original pre-sanitized array for passing into filters.
	$unsanitized_postarr = $postarr;

	$user_id = get_current_user_id();

	$defaults = array(
		'post_author'           =&gt; $user_id,
		'post_content'          =&gt; '',
		'post_content_filtered' =&gt; '',
		'post_title'            =&gt; '',
		'post_excerpt'          =&gt; '',
		'post_status'           =&gt; 'draft',
		'post_type'             =&gt; 'post',
		'comment_status'        =&gt; '',
		'ping_status'           =&gt; '',
		'post_password'         =&gt; '',
		'to_ping'               =&gt; '',
		'pinged'                =&gt; '',
		'post_parent'           =&gt; 0,
		'menu_order'            =&gt; 0,
		'guid'                  =&gt; '',
		'import_id'             =&gt; 0,
		'context'               =&gt; '',
		'post_date'             =&gt; '',
		'post_date_gmt'         =&gt; '',
	);

	$postarr = wp_parse_args( $postarr, $defaults );

	unset( $postarr['filter'] );

	$postarr = sanitize_post( $postarr, 'db' );

	// Are we updating or creating?
	$post_id = 0;
	$update  = false;
	$guid    = $postarr['guid'];

	if ( ! empty( $postarr['ID'] ) ) {
		$update = true;

		// Get the post ID and GUID.
		$post_id     = $postarr['ID'];
		$post_before = get_post( $post_id );

		if ( is_null( $post_before ) ) {
			if ( $wp_error ) {
				return new WP_Error( 'invalid_post', __( 'Invalid post ID.' ) );
			}
			return 0;
		}

		$guid            = get_post_field( 'guid', $post_id );
		$previous_status = get_post_field( 'post_status', $post_id );
	} else {
		$previous_status = 'new';
		$post_before     = null;
	}

	$post_type = empty( $postarr['post_type'] ) ? 'post' : $postarr['post_type'];

	$post_title   = $postarr['post_title'];
	$post_content = $postarr['post_content'];
	$post_excerpt = $postarr['post_excerpt'];

	if ( isset( $postarr['post_name'] ) ) {
		$post_name = $postarr['post_name'];
	} elseif ( $update ) {
		// For an update, don't modify the post_name if it wasn't supplied as an argument.
		$post_name = $post_before-&gt;post_name;
	}

	$maybe_empty = 'attachment' !== $post_type
		&amp;&amp; ! $post_content &amp;&amp; ! $post_title &amp;&amp; ! $post_excerpt
		&amp;&amp; post_type_supports( $post_type, 'editor' )
		&amp;&amp; post_type_supports( $post_type, 'title' )
		&amp;&amp; post_type_supports( $post_type, 'excerpt' );

	/**
	 * Filters whether the post should be considered "empty".
	 *
	 * The post is considered "empty" if both:
	 * 1. The post type supports the title, editor, and excerpt fields
	 * 2. The title, editor, and excerpt fields are all empty
	 *
	 * Returning a truthy value from the filter will effectively short-circuit
	 * the new post being inserted and return 0. If $wp_error is true, a WP_Error
	 * will be returned instead.
	 *
	 * @since 3.3.0
	 *
	 * @param bool  $maybe_empty Whether the post should be considered "empty".
	 * @param array $postarr     Array of post data.
	 */
	if ( apply_filters( 'wp_insert_post_empty_content', $maybe_empty, $postarr ) ) {
		if ( $wp_error ) {
			return new WP_Error( 'empty_content', __( 'Content, title, and excerpt are empty.' ) );
		} else {
			return 0;
		}
	}

	$post_status = empty( $postarr['post_status'] ) ? 'draft' : $postarr['post_status'];

	if ( 'attachment' === $post_type &amp;&amp; ! in_array( $post_status, array( 'inherit', 'private', 'trash', 'auto-draft' ), true ) ) {
		$post_status = 'inherit';
	}

	if ( ! empty( $postarr['post_category'] ) ) {
		// Filter out empty terms.
		$post_category = array_filter( $postarr['post_category'] );
	} elseif ( $update &amp;&amp; ! isset( $postarr['post_category'] ) ) {
		$post_category = $post_before-&gt;post_category;
	}

	// Make sure we set a valid category.
	if ( empty( $post_category ) || 0 === count( $post_category ) || ! is_array( $post_category ) ) {
		// 'post' requires at least one category.
		if ( 'post' === $post_type &amp;&amp; 'auto-draft' !== $post_status ) {
			$post_category = array( get_option( 'default_category' ) );
		} else {
			$post_category = array();
		}
	}

	/*
	 * Don't allow contributors to set the post slug for pending review posts.
	 *
	 * For new posts check the primitive capability, for updates check the meta capability.
	 */
	if ( 'pending' === $post_status ) {
		$post_type_object = get_post_type_object( $post_type );

		if ( ! $update &amp;&amp; $post_type_object &amp;&amp; ! current_user_can( $post_type_object-&gt;cap-&gt;publish_posts ) ) {
			$post_name = '';
		} elseif ( $update &amp;&amp; ! current_user_can( 'publish_post', $post_id ) ) {
			$post_name = '';
		}
	}

	/*
	 * Create a valid post name. Drafts and pending posts are allowed to have
	 * an empty post name.
	 */
	if ( empty( $post_name ) ) {
		if ( ! in_array( $post_status, array( 'draft', 'pending', 'auto-draft' ), true ) ) {
			$post_name = sanitize_title( $post_title );
		} else {
			$post_name = '';
		}
	} else {
		// On updates, we need to check to see if it's using the old, fixed sanitization context.
		$check_name = sanitize_title( $post_name, '', 'old-save' );

		if ( $update
			&amp;&amp; strtolower( urlencode( $post_name ) ) === $check_name
			&amp;&amp; get_post_field( 'post_name', $post_id ) === $check_name
		) {
			$post_name = $check_name;
		} else { // New post, or slug has changed.
			$post_name = sanitize_title( $post_name );
		}
	}

	/*
	 * Resolve the post date from any provided post date or post date GMT strings;
	 * if none are provided, the date will be set to now.
	 */
	$post_date = wp_resolve_post_date( $postarr['post_date'], $postarr['post_date_gmt'] );

	if ( ! $post_date ) {
		if ( $wp_error ) {
			return new WP_Error( 'invalid_date', __( 'Invalid date.' ) );
		} else {
			return 0;
		}
	}

	if ( empty( $postarr['post_date_gmt'] ) || '0000-00-00 00:00:00' === $postarr['post_date_gmt'] ) {
		if ( ! in_array( $post_status, get_post_stati( array( 'date_floating' =&gt; true ) ), true ) ) {
			$post_date_gmt = get_gmt_from_date( $post_date );
		} else {
			$post_date_gmt = '0000-00-00 00:00:00';
		}
	} else {
		$post_date_gmt = $postarr['post_date_gmt'];
	}

	if ( $update || '0000-00-00 00:00:00' === $post_date ) {
		$post_modified     = current_time( 'mysql' );
		$post_modified_gmt = current_time( 'mysql', 1 );
	} else {
		$post_modified     = $post_date;
		$post_modified_gmt = $post_date_gmt;
	}

	if ( 'attachment' !== $post_type ) {
		$now = gmdate( 'Y-m-d H:i:s' );

		if ( 'publish' === $post_status ) {
			if ( strtotime( $post_date_gmt ) - strtotime( $now ) &gt;= MINUTE_IN_SECONDS ) {
				$post_status = 'future';
			}
		} elseif ( 'future' === $post_status ) {
			if ( strtotime( $post_date_gmt ) - strtotime( $now ) &lt; MINUTE_IN_SECONDS ) {
				$post_status = 'publish';
			}
		}
	}

	// Comment status.
	if ( empty( $postarr['comment_status'] ) ) {
		if ( $update ) {
			$comment_status = 'closed';
		} else {
			$comment_status = get_default_comment_status( $post_type );
		}
	} else {
		$comment_status = $postarr['comment_status'];
	}

	// These variables are needed by compact() later.
	$post_content_filtered = $postarr['post_content_filtered'];
	$post_author           = isset( $postarr['post_author'] ) ? $postarr['post_author'] : $user_id;
	$ping_status           = empty( $postarr['ping_status'] ) ? get_default_comment_status( $post_type, 'pingback' ) : $postarr['ping_status'];
	$to_ping               = isset( $postarr['to_ping'] ) ? sanitize_trackback_urls( $postarr['to_ping'] ) : '';
	$pinged                = isset( $postarr['pinged'] ) ? $postarr['pinged'] : '';
	$import_id             = isset( $postarr['import_id'] ) ? $postarr['import_id'] : 0;

	/*
	 * The 'wp_insert_post_parent' filter expects all variables to be present.
	 * Previously, these variables would have already been extracted
	 */
	if ( isset( $postarr['menu_order'] ) ) {
		$menu_order = (int) $postarr['menu_order'];
	} else {
		$menu_order = 0;
	}

	$post_password = isset( $postarr['post_password'] ) ? $postarr['post_password'] : '';
	if ( 'private' === $post_status ) {
		$post_password = '';
	}

	if ( isset( $postarr['post_parent'] ) ) {
		$post_parent = (int) $postarr['post_parent'];
	} else {
		$post_parent = 0;
	}

	$new_postarr = array_merge(
		array(
			'ID' =&gt; $post_id,
		),
		compact( array_diff( array_keys( $defaults ), array( 'context', 'filter' ) ) )
	);

	/**
	 * Filters the post parent -- used to check for and prevent hierarchy loops.
	 *
	 * @since 3.1.0
	 *
	 * @param int   $post_parent Post parent ID.
	 * @param int   $post_id     Post ID.
	 * @param array $new_postarr Array of parsed post data.
	 * @param array $postarr     Array of sanitized, but otherwise unmodified post data.
	 */
	$post_parent = apply_filters( 'wp_insert_post_parent', $post_parent, $post_id, $new_postarr, $postarr );

	/*
	 * If the post is being untrashed and it has a desired slug stored in post meta,
	 * reassign it.
	 */
	if ( 'trash' === $previous_status &amp;&amp; 'trash' !== $post_status ) {
		$desired_post_slug = get_post_meta( $post_id, '_wp_desired_post_slug', true );

		if ( $desired_post_slug ) {
			delete_post_meta( $post_id, '_wp_desired_post_slug' );
			$post_name = $desired_post_slug;
		}
	}

	// If a trashed post has the desired slug, change it and let this post have it.
	if ( 'trash' !== $post_status &amp;&amp; $post_name ) {
		/**
		 * Filters whether or not to add a `__trashed` suffix to trashed posts that match the name of the updated post.
		 *
		 * @since 5.4.0
		 *
		 * @param bool   $add_trashed_suffix Whether to attempt to add the suffix.
		 * @param string $post_name          The name of the post being updated.
		 * @param int    $post_id            Post ID.
		 */
		$add_trashed_suffix = apply_filters( 'add_trashed_suffix_to_trashed_posts', true, $post_name, $post_id );

		if ( $add_trashed_suffix ) {
			wp_add_trashed_suffix_to_post_name_for_trashed_posts( $post_name, $post_id );
		}
	}

	// When trashing an existing post, change its slug to allow non-trashed posts to use it.
	if ( 'trash' === $post_status &amp;&amp; 'trash' !== $previous_status &amp;&amp; 'new' !== $previous_status ) {
		$post_name = wp_add_trashed_suffix_to_post_name_for_post( $post_id );
	}

	$post_name = wp_unique_post_slug( $post_name, $post_id, $post_status, $post_type, $post_parent );

	// Don't unslash.
	$post_mime_type = isset( $postarr['post_mime_type'] ) ? $postarr['post_mime_type'] : '';

	// Expected_slashed (everything!).
	$data = compact(
		'post_author',
		'post_date',
		'post_date_gmt',
		'post_content',
		'post_content_filtered',
		'post_title',
		'post_excerpt',
		'post_status',
		'post_type',
		'comment_status',
		'ping_status',
		'post_password',
		'post_name',
		'to_ping',
		'pinged',
		'post_modified',
		'post_modified_gmt',
		'post_parent',
		'menu_order',
		'post_mime_type',
		'guid'
	);

	$emoji_fields = array( 'post_title', 'post_content', 'post_excerpt' );

	foreach ( $emoji_fields as $emoji_field ) {
		if ( isset( $data[ $emoji_field ] ) ) {
			$charset = $wpdb-&gt;get_col_charset( $wpdb-&gt;posts, $emoji_field );

			if ( 'utf8' === $charset ) {
				$data[ $emoji_field ] = wp_encode_emoji( $data[ $emoji_field ] );
			}
		}
	}

	if ( 'attachment' === $post_type ) {
		/**
		 * Filters attachment post data before it is updated in or added to the database.
		 *
		 * @since 3.9.0
		 * @since 5.4.1 The `$unsanitized_postarr` parameter was added.
		 * @since 6.0.0 The `$update` parameter was added.
		 *
		 * @param array $data                An array of slashed, sanitized, and processed attachment post data.
		 * @param array $postarr             An array of slashed and sanitized attachment post data, but not processed.
		 * @param array $unsanitized_postarr An array of slashed yet *unsanitized* and unprocessed attachment post data
		 *                                   as originally passed to wp_insert_post().
		 * @param bool  $update              Whether this is an existing attachment post being updated.
		 */
		$data = apply_filters( 'wp_insert_attachment_data', $data, $postarr, $unsanitized_postarr, $update );
	} else {
		/**
		 * Filters slashed post data just before it is inserted into the database.
		 *
		 * @since 2.7.0
		 * @since 5.4.1 The `$unsanitized_postarr` parameter was added.
		 * @since 6.0.0 The `$update` parameter was added.
		 *
		 * @param array $data                An array of slashed, sanitized, and processed post data.
		 * @param array $postarr             An array of sanitized (and slashed) but otherwise unmodified post data.
		 * @param array $unsanitized_postarr An array of slashed yet *unsanitized* and unprocessed post data as
		 *                                   originally passed to wp_insert_post().
		 * @param bool  $update              Whether this is an existing post being updated.
		 */
		$data = apply_filters( 'wp_insert_post_data', $data, $postarr, $unsanitized_postarr, $update );
	}

	$data  = wp_unslash( $data );
	$where = array( 'ID' =&gt; $post_id );

	if ( $update ) {
		/**
		 * Fires immediately before an existing post is updated in the database.
		 *
		 * @since 2.5.0
		 *
		 * @param int   $post_id Post ID.
		 * @param array $data    Array of unslashed post data.
		 */
		do_action( 'pre_post_update', $post_id, $data );

		if ( false === $wpdb-&gt;update( $wpdb-&gt;posts, $data, $where ) ) {
			if ( $wp_error ) {
				if ( 'attachment' === $post_type ) {
					$message = __( 'Could not update attachment in the database.' );
				} else {
					$message = __( 'Could not update post in the database.' );
				}

				return new WP_Error( 'db_update_error', $message, $wpdb-&gt;last_error );
			} else {
				return 0;
			}
		}
	} else {
		// If there is a suggested ID, use it if not already present.
		if ( ! empty( $import_id ) ) {
			$import_id = (int) $import_id;

			if ( ! $wpdb-&gt;get_var( $wpdb-&gt;prepare( "SELECT ID FROM $wpdb-&gt;posts WHERE ID = %d", $import_id ) ) ) {
				$data['ID'] = $import_id;
			}
		}

		if ( false === $wpdb-&gt;insert( $wpdb-&gt;posts, $data ) ) {
			if ( $wp_error ) {
				if ( 'attachment' === $post_type ) {
					$message = __( 'Could not insert attachment into the database.' );
				} else {
					$message = __( 'Could not insert post into the database.' );
				}

				return new WP_Error( 'db_insert_error', $message, $wpdb-&gt;last_error );
			} else {
				return 0;
			}
		}

		$post_id = (int) $wpdb-&gt;insert_id;

		// Use the newly generated $post_id.
		$where = array( 'ID' =&gt; $post_id );
	}

	if ( empty( $data['post_name'] ) &amp;&amp; ! in_array( $data['post_status'], array( 'draft', 'pending', 'auto-draft' ), true ) ) {
		$data['post_name'] = wp_unique_post_slug( sanitize_title( $data['post_title'], $post_id ), $post_id, $data['post_status'], $post_type, $post_parent );

		$wpdb-&gt;update( $wpdb-&gt;posts, array( 'post_name' =&gt; $data['post_name'] ), $where );
		clean_post_cache( $post_id );
	}

	if ( is_object_in_taxonomy( $post_type, 'category' ) ) {
		wp_set_post_categories( $post_id, $post_category );
	}

	if ( isset( $postarr['tags_input'] ) &amp;&amp; is_object_in_taxonomy( $post_type, 'post_tag' ) ) {
		wp_set_post_tags( $post_id, $postarr['tags_input'] );
	}

	// Add default term for all associated custom taxonomies.
	if ( 'auto-draft' !== $post_status ) {
		foreach ( get_object_taxonomies( $post_type, 'object' ) as $taxonomy =&gt; $tax_object ) {

			if ( ! empty( $tax_object-&gt;default_term ) ) {

				// Filter out empty terms.
				if ( isset( $postarr['tax_input'][ $taxonomy ] ) &amp;&amp; is_array( $postarr['tax_input'][ $taxonomy ] ) ) {
					$postarr['tax_input'][ $taxonomy ] = array_filter( $postarr['tax_input'][ $taxonomy ] );
				}

				// Passed custom taxonomy list overwrites the existing list if not empty.
				$terms = wp_get_object_terms( $post_id, $taxonomy, array( 'fields' =&gt; 'ids' ) );
				if ( ! empty( $terms ) &amp;&amp; empty( $postarr['tax_input'][ $taxonomy ] ) ) {
					$postarr['tax_input'][ $taxonomy ] = $terms;
				}

				if ( empty( $postarr['tax_input'][ $taxonomy ] ) ) {
					$default_term_id = get_option( 'default_term_' . $taxonomy );
					if ( ! empty( $default_term_id ) ) {
						$postarr['tax_input'][ $taxonomy ] = array( (int) $default_term_id );
					}
				}
			}
		}
	}

	// New-style support for all custom taxonomies.
	if ( ! empty( $postarr['tax_input'] ) ) {
		foreach ( $postarr['tax_input'] as $taxonomy =&gt; $tags ) {
			$taxonomy_obj = get_taxonomy( $taxonomy );

			if ( ! $taxonomy_obj ) {
				/* translators: %s: Taxonomy name. */
				_doing_it_wrong( __FUNCTION__, sprintf( __( 'Invalid taxonomy: %s.' ), $taxonomy ), '4.4.0' );
				continue;
			}

			// array = hierarchical, string = non-hierarchical.
			if ( is_array( $tags ) ) {
				$tags = array_filter( $tags );
			}

			if ( current_user_can( $taxonomy_obj-&gt;cap-&gt;assign_terms ) ) {
				wp_set_post_terms( $post_id, $tags, $taxonomy );
			}
		}
	}

	if ( ! empty( $postarr['meta_input'] ) ) {
		foreach ( $postarr['meta_input'] as $field =&gt; $value ) {
			update_post_meta( $post_id, $field, $value );
		}
	}

	$current_guid = get_post_field( 'guid', $post_id );

	// Set GUID.
	if ( ! $update &amp;&amp; '' === $current_guid ) {
		$wpdb-&gt;update( $wpdb-&gt;posts, array( 'guid' =&gt; get_permalink( $post_id ) ), $where );
	}

	if ( 'attachment' === $postarr['post_type'] ) {
		if ( ! empty( $postarr['file'] ) ) {
			update_attached_file( $post_id, $postarr['file'] );
		}

		if ( ! empty( $postarr['context'] ) ) {
			add_post_meta( $post_id, '_wp_attachment_context', $postarr['context'], true );
		}
	}

	// Set or remove featured image.
	if ( isset( $postarr['_thumbnail_id'] ) ) {
		$thumbnail_support = current_theme_supports( 'post-thumbnails', $post_type ) &amp;&amp; post_type_supports( $post_type, 'thumbnail' ) || 'revision' === $post_type;

		if ( ! $thumbnail_support &amp;&amp; 'attachment' === $post_type &amp;&amp; $post_mime_type ) {
			if ( wp_attachment_is( 'audio', $post_id ) ) {
				$thumbnail_support = post_type_supports( 'attachment:audio', 'thumbnail' ) || current_theme_supports( 'post-thumbnails', 'attachment:audio' );
			} elseif ( wp_attachment_is( 'video', $post_id ) ) {
				$thumbnail_support = post_type_supports( 'attachment:video', 'thumbnail' ) || current_theme_supports( 'post-thumbnails', 'attachment:video' );
			}
		}

		if ( $thumbnail_support ) {
			$thumbnail_id = (int) $postarr['_thumbnail_id'];
			if ( -1 === $thumbnail_id ) {
				delete_post_thumbnail( $post_id );
			} else {
				set_post_thumbnail( $post_id, $thumbnail_id );
			}
		}
	}

	clean_post_cache( $post_id );

	$post = get_post( $post_id );

	if ( ! empty( $postarr['page_template'] ) ) {
		$post-&gt;page_template = $postarr['page_template'];
		$page_templates      = wp_get_theme()-&gt;get_page_templates( $post );

		if ( 'default' !== $postarr['page_template'] &amp;&amp; ! isset( $page_templates[ $postarr['page_template'] ] ) ) {
			if ( $wp_error ) {
				return new WP_Error( 'invalid_page_template', __( 'Invalid page template.' ) );
			}

			update_post_meta( $post_id, '_wp_page_template', 'default' );
		} else {
			update_post_meta( $post_id, '_wp_page_template', $postarr['page_template'] );
		}
	}

	if ( 'attachment' !== $postarr['post_type'] ) {
		wp_transition_post_status( $data['post_status'], $previous_status, $post );
	} else {
		if ( $update ) {
			/**
			 * Fires once an existing attachment has been updated.
			 *
			 * @since 2.0.0
			 *
			 * @param int $post_id Attachment ID.
			 */
			do_action( 'edit_attachment', $post_id );

			$post_after = get_post( $post_id );

			/**
			 * Fires once an existing attachment has been updated.
			 *
			 * @since 4.4.0
			 *
			 * @param int     $post_id      Post ID.
			 * @param WP_Post $post_after   Post object following the update.
			 * @param WP_Post $post_before  Post object before the update.
			 */
			do_action( 'attachment_updated', $post_id, $post_after, $post_before );
		} else {

			/**
			 * Fires once an attachment has been added.
			 *
			 * @since 2.0.0
			 *
			 * @param int $post_id Attachment ID.
			 */
			do_action( 'add_attachment', $post_id );
		}

		return $post_id;
	}

	if ( $update ) {
		/**
		 * Fires once an existing post has been updated.
		 *
		 * The dynamic portion of the hook name, `$post-&gt;post_type`, refers to
		 * the post type slug.
		 *
		 * Possible hook names include:
		 *
		 *  - `edit_post_post`
		 *  - `edit_post_page`
		 *
		 * @since 5.1.0
		 *
		 * @param int     $post_id Post ID.
		 * @param WP_Post $post    Post object.
		 */
		do_action( "edit_post_{$post-&gt;post_type}", $post_id, $post );

		/**
		 * Fires once an existing post has been updated.
		 *
		 * @since 1.2.0
		 *
		 * @param int     $post_id Post ID.
		 * @param WP_Post $post    Post object.
		 */
		do_action( 'edit_post', $post_id, $post );

		$post_after = get_post( $post_id );

		/**
		 * Fires once an existing post has been updated.
		 *
		 * @since 3.0.0
		 *
		 * @param int     $post_id      Post ID.
		 * @param WP_Post $post_after   Post object following the update.
		 * @param WP_Post $post_before  Post object before the update.
		 */
		do_action( 'post_updated', $post_id, $post_after, $post_before );
	}

	/**
	 * Fires once a post has been saved.
	 *
	 * The dynamic portion of the hook name, `$post-&gt;post_type`, refers to
	 * the post type slug.
	 *
	 * Possible hook names include:
	 *
	 *  - `save_post_post`
	 *  - `save_post_page`
	 *
	 * @since 3.7.0
	 *
	 * @param int     $post_id Post ID.
	 * @param WP_Post $post    Post object.
	 * @param bool    $update  Whether this is an existing post being updated.
	 */
	do_action( "save_post_{$post-&gt;post_type}", $post_id, $post, $update );

	/**
	 * Fires once a post has been saved.
	 *
	 * @since 1.5.0
	 *
	 * @param int     $post_id Post ID.
	 * @param WP_Post $post    Post object.
	 * @param bool    $update  Whether this is an existing post being updated.
	 */
	do_action( 'save_post', $post_id, $post, $update );

	/**
	 * Fires once a post has been saved.
	 *
	 * @since 2.0.0
	 *
	 * @param int     $post_id Post ID.
	 * @param WP_Post $post    Post object.
	 * @param bool    $update  Whether this is an existing post being updated.
	 */
	do_action( 'wp_insert_post', $post_id, $post, $update );

	if ( $fire_after_hooks ) {
		wp_after_insert_post( $post, $update, $post_before );
	}

	return $post_id;
}
</code></pre><p class="wporg-dot-link-list"><a href="https://developer.notmatt.press/reference/files/wp-includes/post.php/">View all references</a> <a href="https://core.trac.wordpress.org/browser/tags/6.7/src/wp-includes/post.php#L4382">View on Trac</a> <a href="https://github.com/WordPress/wordpress-develop/blob/6.7/src/wp-includes/post.php#L4382-L5078">View on GitHub</a></p></section>
<section class="wp-block-wporg-code-reference-hooks"><h2 class="is-toc-heading wp-block-heading has-heading-5-font-size" id="hooks" tabindex="-1"><a href="#hooks">Hooks</a></h2> <dl><dt class="wp-block-wporg-code-reference-title has-normal-font-size"><a href="https://developer.notmatt.press/reference/hooks/add_attachment/"><span class="hook-func">do_action</span>( ‘add_attachment’,  <nobr><span class="arg-type">int</span> <span class="arg-name">$post_id</span></nobr> )</a></dt><dd><p>Fires once an attachment has been added.</p>
</dd><dt class="wp-block-wporg-code-reference-title has-normal-font-size"><a href="https://developer.notmatt.press/reference/hooks/add_trashed_suffix_to_trashed_posts/"><span class="hook-func">apply_filters</span>( ‘add_trashed_suffix_to_trashed_posts’,  <nobr><span class="arg-type">bool</span> <span class="arg-name">$add_trashed_suffix</span></nobr>,  <nobr><span class="arg-type">string</span> <span class="arg-name">$post_name</span></nobr>,  <nobr><span class="arg-type">int</span> <span class="arg-name">$post_id</span></nobr> )</a></dt><dd><p>Filters whether or not to add a <code>__trashed</code> suffix to trashed posts that match the name of the updated post.</p>
</dd><dt class="wp-block-wporg-code-reference-title has-normal-font-size"><a href="https://developer.notmatt.press/reference/hooks/attachment_updated/"><span class="hook-func">do_action</span>( ‘attachment_updated’,  <nobr><span class="arg-type">int</span> <span class="arg-name">$post_id</span></nobr>,  <nobr><span class="arg-type">WP_Post</span> <span class="arg-name">$post_after</span></nobr>,  <nobr><span class="arg-type">WP_Post</span> <span class="arg-name">$post_before</span></nobr> )</a></dt><dd><p>Fires once an existing attachment has been updated.</p>
</dd><dt class="wp-block-wporg-code-reference-title has-normal-font-size"><a href="https://developer.notmatt.press/reference/hooks/edit_attachment/"><span class="hook-func">do_action</span>( ‘edit_attachment’,  <nobr><span class="arg-type">int</span> <span class="arg-name">$post_id</span></nobr> )</a></dt><dd><p>Fires once an existing attachment has been updated.</p>
</dd><dt class="wp-block-wporg-code-reference-title has-normal-font-size"><a href="https://developer.notmatt.press/reference/hooks/edit_post/"><span class="hook-func">do_action</span>( ‘edit_post’,  <nobr><span class="arg-type">int</span> <span class="arg-name">$post_id</span></nobr>,  <nobr><span class="arg-type">WP_Post</span> <span class="arg-name">$post</span></nobr> )</a></dt><dd><p>Fires once an existing post has been updated.</p>
</dd><dt class="wp-block-wporg-code-reference-title has-normal-font-size"><a href="https://developer.notmatt.press/reference/hooks/edit_post_post-post_type/"><span class="hook-func">do_action</span>( “edit_post_{$post-&gt;post_type}”,  <nobr><span class="arg-type">int</span> <span class="arg-name">$post_id</span></nobr>,  <nobr><span class="arg-type">WP_Post</span> <span class="arg-name">$post</span></nobr> )</a></dt><dd><p>Fires once an existing post has been updated.</p>
</dd><dt class="wp-block-wporg-code-reference-title has-normal-font-size"><a href="https://developer.notmatt.press/reference/hooks/post_updated/"><span class="hook-func">do_action</span>( ‘post_updated’,  <nobr><span class="arg-type">int</span> <span class="arg-name">$post_id</span></nobr>,  <nobr><span class="arg-type">WP_Post</span> <span class="arg-name">$post_after</span></nobr>,  <nobr><span class="arg-type">WP_Post</span> <span class="arg-name">$post_before</span></nobr> )</a></dt><dd><p>Fires once an existing post has been updated.</p>
</dd><dt class="wp-block-wporg-code-reference-title has-normal-font-size"><a href="https://developer.notmatt.press/reference/hooks/pre_post_update/"><span class="hook-func">do_action</span>( ‘pre_post_update’,  <nobr><span class="arg-type">int</span> <span class="arg-name">$post_id</span></nobr>,  <nobr><span class="arg-type">array</span> <span class="arg-name">$data</span></nobr> )</a></dt><dd><p>Fires immediately before an existing post is updated in the database.</p>
</dd><dt class="wp-block-wporg-code-reference-title has-normal-font-size"><a href="https://developer.notmatt.press/reference/hooks/save_post/"><span class="hook-func">do_action</span>( ‘save_post’,  <nobr><span class="arg-type">int</span> <span class="arg-name">$post_id</span></nobr>,  <nobr><span class="arg-type">WP_Post</span> <span class="arg-name">$post</span></nobr>,  <nobr><span class="arg-type">bool</span> <span class="arg-name">$update</span></nobr> )</a></dt><dd><p>Fires once a post has been saved.</p>
</dd><dt class="wp-block-wporg-code-reference-title has-normal-font-size"><a href="https://developer.notmatt.press/reference/hooks/save_post_post-post_type/"><span class="hook-func">do_action</span>( “save_post_{$post-&gt;post_type}”,  <nobr><span class="arg-type">int</span> <span class="arg-name">$post_id</span></nobr>,  <nobr><span class="arg-type">WP_Post</span> <span class="arg-name">$post</span></nobr>,  <nobr><span class="arg-type">bool</span> <span class="arg-name">$update</span></nobr> )</a></dt><dd><p>Fires once a post has been saved.</p>
</dd><dt class="wp-block-wporg-code-reference-title has-normal-font-size"><a href="https://developer.notmatt.press/reference/hooks/wp_insert_attachment_data/"><span class="hook-func">apply_filters</span>( ‘wp_insert_attachment_data’,  <nobr><span class="arg-type">array</span> <span class="arg-name">$data</span></nobr>,  <nobr><span class="arg-type">array</span> <span class="arg-name">$postarr</span></nobr>,  <nobr><span class="arg-type">array</span> <span class="arg-name">$unsanitized_postarr</span></nobr>,  <nobr><span class="arg-type">bool</span> <span class="arg-name">$update</span></nobr> )</a></dt><dd><p>Filters attachment post data before it is updated in or added to the database.</p>
</dd><dt class="wp-block-wporg-code-reference-title has-normal-font-size"><a href="https://developer.notmatt.press/reference/hooks/wp_insert_post/"><span class="hook-func">do_action</span>( ‘wp_insert_post’,  <nobr><span class="arg-type">int</span> <span class="arg-name">$post_id</span></nobr>,  <nobr><span class="arg-type">WP_Post</span> <span class="arg-name">$post</span></nobr>,  <nobr><span class="arg-type">bool</span> <span class="arg-name">$update</span></nobr> )</a></dt><dd><p>Fires once a post has been saved.</p>
</dd><dt class="wp-block-wporg-code-reference-title has-normal-font-size"><a href="https://developer.notmatt.press/reference/hooks/wp_insert_post_data/"><span class="hook-func">apply_filters</span>( ‘wp_insert_post_data’,  <nobr><span class="arg-type">array</span> <span class="arg-name">$data</span></nobr>,  <nobr><span class="arg-type">array</span> <span class="arg-name">$postarr</span></nobr>,  <nobr><span class="arg-type">array</span> <span class="arg-name">$unsanitized_postarr</span></nobr>,  <nobr><span class="arg-type">bool</span> <span class="arg-name">$update</span></nobr> )</a></dt><dd><p>Filters slashed post data just before it is inserted into the database.</p>
</dd><dt class="wp-block-wporg-code-reference-title has-normal-font-size"><a href="https://developer.notmatt.press/reference/hooks/wp_insert_post_empty_content/"><span class="hook-func">apply_filters</span>( ‘wp_insert_post_empty_content’,  <nobr><span class="arg-type">bool</span> <span class="arg-name">$maybe_empty</span></nobr>,  <nobr><span class="arg-type">array</span> <span class="arg-name">$postarr</span></nobr> )</a></dt><dd><p>Filters whether the post should be considered “empty”.</p>
</dd><dt class="wp-block-wporg-code-reference-title has-normal-font-size"><a href="https://developer.notmatt.press/reference/hooks/wp_insert_post_parent/"><span class="hook-func">apply_filters</span>( ‘wp_insert_post_parent’,  <nobr><span class="arg-type">int</span> <span class="arg-name">$post_parent</span></nobr>,  <nobr><span class="arg-type">int</span> <span class="arg-name">$post_id</span></nobr>,  <nobr><span class="arg-type">array</span> <span class="arg-name">$new_postarr</span></nobr>,  <nobr><span class="arg-type">array</span> <span class="arg-name">$postarr</span></nobr> )</a></dt><dd><p>Filters the post parent — used to check for and prevent hierarchy loops.</p>
</dd></dl></section>
<section class="wp-block-wporg-code-reference-related" data-nosnippet="true"><h2 class="is-toc-heading wp-block-heading has-heading-5-font-size" id="related" tabindex="-1"><a href="#related">Related</a></h2> <section class="wp-block-wporg-code-table" id="uses" style="margin-top:var(--wp--preset--spacing--20);"><figure class="wp-block-table"><table><thead><tr><th scope="col">Uses</th><th scope="col">Description</th></tr></thead><tbody><tr class=""><td><a href="https://developer.notmatt.press/reference/functions/wp_resolve_post_date/">wp_resolve_post_date()</a><code>wp-includes/post.php</code></td><td><p>Uses wp_checkdate to return a valid Gregorian-calendar value for post_date.</p>
</td></tr><tr class=""><td><a href="https://developer.notmatt.press/reference/functions/wp_after_insert_post/">wp_after_insert_post()</a><code>wp-includes/post.php</code></td><td><p>Fires actions after a post, its terms and meta data has been saved.</p>
</td></tr><tr class=""><td><a href="https://developer.notmatt.press/reference/functions/wp_add_trashed_suffix_to_post_name_for_trashed_posts/">wp_add_trashed_suffix_to_post_name_for_trashed_posts()</a><code>wp-includes/post.php</code></td><td><p>Adds a suffix if any trashed posts have a given slug.</p>
</td></tr><tr class=""><td><a href="https://developer.notmatt.press/reference/functions/wp_add_trashed_suffix_to_post_name_for_post/">wp_add_trashed_suffix_to_post_name_for_post()</a><code>wp-includes/post.php</code></td><td><p>Adds a trashed suffix for a given post.</p>
</td></tr><tr class=""><td><a href="https://developer.notmatt.press/reference/functions/get_default_comment_status/">get_default_comment_status()</a><code>wp-includes/comment.php</code></td><td><p>Gets the default comment status for a post type.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/classes/wpdb/get_col_charset/">wpdb::get_col_charset()</a><code>wp-includes/class-wpdb.php</code></td><td><p>Retrieves the character set for the given column.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/wp_encode_emoji/">wp_encode_emoji()</a><code>wp-includes/formatting.php</code></td><td><p>Converts emoji characters to their equivalent HTML entity.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/wp_attachment_is/">wp_attachment_is()</a><code>wp-includes/post.php</code></td><td><p>Verifies an attachment is of a given type.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/wp_get_theme/">wp_get_theme()</a><code>wp-includes/theme.php</code></td><td><p>Gets a <a href="https://developer.notmatt.press/reference/classes/wp_theme/" rel="class">WP_Theme</a> object for a theme.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/sanitize_trackback_urls/">sanitize_trackback_urls()</a><code>wp-includes/formatting.php</code></td><td><p>Sanitizes space or carriage return separated URLs that are used to send trackbacks.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/get_gmt_from_date/">get_gmt_from_date()</a><code>wp-includes/formatting.php</code></td><td><p>Given a date in the timezone of the site, returns that date in UTC.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/sanitize_title/">sanitize_title()</a><code>wp-includes/formatting.php</code></td><td><p>Sanitizes a string into a slug, which can be used in URLs or HTML attributes.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/classes/wp_theme/get_page_templates/">WP_Theme::get_page_templates()</a><code>wp-includes/class-wp-theme.php</code></td><td><p>Returns the theme’s post templates for a given post type.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/current_time/">current_time()</a><code>wp-includes/functions.php</code></td><td><p>Retrieves the current time based on specified type.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/is_object_in_taxonomy/">is_object_in_taxonomy()</a><code>wp-includes/taxonomy.php</code></td><td><p>Determines if the given object type is associated with the given taxonomy.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/wp_get_object_terms/">wp_get_object_terms()</a><code>wp-includes/taxonomy.php</code></td><td><p>Retrieves the terms associated with the given object(s), in the supplied taxonomies.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/get_object_taxonomies/">get_object_taxonomies()</a><code>wp-includes/taxonomy.php</code></td><td><p>Returns the names or objects of the taxonomies which are registered for the requested object or object type, such as a post object or post type name.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/clean_post_cache/">clean_post_cache()</a><code>wp-includes/post.php</code></td><td><p>Will clean the post in the cache.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/delete_post_thumbnail/">delete_post_thumbnail()</a><code>wp-includes/post.php</code></td><td><p>Removes the thumbnail (featured image) from the given post.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/set_post_thumbnail/">set_post_thumbnail()</a><code>wp-includes/post.php</code></td><td><p>Sets the post thumbnail (featured image) for the given post.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/wp_unique_post_slug/">wp_unique_post_slug()</a><code>wp-includes/post.php</code></td><td><p>Computes a unique slug for the post, when given the desired slug and some post details.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/wp_set_post_categories/">wp_set_post_categories()</a><code>wp-includes/post.php</code></td><td><p>Sets categories for a post.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/wp_set_post_tags/">wp_set_post_tags()</a><code>wp-includes/post.php</code></td><td><p>Sets the tags for a post.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/wp_set_post_terms/">wp_set_post_terms()</a><code>wp-includes/post.php</code></td><td><p>Sets the terms for a post.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/wp_transition_post_status/">wp_transition_post_status()</a><code>wp-includes/post.php</code></td><td><p>Fires actions related to the transitioning of a post’s status.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/sanitize_post/">sanitize_post()</a><code>wp-includes/post.php</code></td><td><p>Sanitizes every post field.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/post_type_supports/">post_type_supports()</a><code>wp-includes/post.php</code></td><td><p>Checks a post type’s support for a given feature.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/delete_post_meta/">delete_post_meta()</a><code>wp-includes/post.php</code></td><td><p>Deletes a post meta field for the given post ID.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/update_post_meta/">update_post_meta()</a><code>wp-includes/post.php</code></td><td><p>Updates a post meta field based on the given post ID.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/add_post_meta/">add_post_meta()</a><code>wp-includes/post.php</code></td><td><p>Adds a meta field to the given post.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/get_post_field/">get_post_field()</a><code>wp-includes/post.php</code></td><td><p>Retrieves data from a post field based on Post ID.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/get_post_stati/">get_post_stati()</a><code>wp-includes/post.php</code></td><td><p>Gets a list of post statuses.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/update_attached_file/">update_attached_file()</a><code>wp-includes/post.php</code></td><td><p>Updates attachment file path based on attachment ID.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/classes/wpdb/update/">wpdb::update()</a><code>wp-includes/class-wpdb.php</code></td><td><p>Updates a row in the table.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/classes/wpdb/insert/">wpdb::insert()</a><code>wp-includes/class-wpdb.php</code></td><td><p>Inserts a row into the table.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/current_user_can/">current_user_can()</a><code>wp-includes/capabilities.php</code></td><td><p>Returns whether the current user has the specified capability.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/current_theme_supports/">current_theme_supports()</a><code>wp-includes/theme.php</code></td><td><p>Checks a theme’s support for a given feature.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/wp_unslash/">wp_unslash()</a><code>wp-includes/formatting.php</code></td><td><p>Removes slashes from a string or recursively removes slashes from strings within an array.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/_doing_it_wrong/">_doing_it_wrong()</a><code>wp-includes/functions.php</code></td><td><p>Marks something as being incorrectly called.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/wp_parse_args/">wp_parse_args()</a><code>wp-includes/functions.php</code></td><td><p>Merges user defined arguments into defaults array.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/get_taxonomy/">get_taxonomy()</a><code>wp-includes/taxonomy.php</code></td><td><p>Retrieves the taxonomy object of $taxonomy.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/get_permalink/">get_permalink()</a><code>wp-includes/link-template.php</code></td><td><p>Retrieves the full permalink for the current post or post ID.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/apply_filters/">apply_filters()</a><code>wp-includes/plugin.php</code></td><td><p>Calls the callback functions that have been added to a filter hook.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/do_action/">do_action()</a><code>wp-includes/plugin.php</code></td><td><p>Calls the callback functions that have been added to an action hook.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/get_option/">get_option()</a><code>wp-includes/option.php</code></td><td><p>Retrieves an option value based on an option name.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/get_current_user_id/">get_current_user_id()</a><code>wp-includes/user.php</code></td><td><p>Gets the current user’s ID.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/get_post_meta/">get_post_meta()</a><code>wp-includes/post.php</code></td><td><p>Retrieves a post meta field for the given post ID.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/get_post/">get_post()</a><code>wp-includes/post.php</code></td><td><p>Retrieves post data given a post ID or post object.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/get_post_type_object/">get_post_type_object()</a><code>wp-includes/post.php</code></td><td><p>Retrieves a post type object by name.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/classes/wpdb/get_var/">wpdb::get_var()</a><code>wp-includes/class-wpdb.php</code></td><td><p>Retrieves one value from the database.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/classes/wpdb/prepare/">wpdb::prepare()</a><code>wp-includes/class-wpdb.php</code></td><td><p>Prepares a SQL query for safe execution.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/classes/wp_error/__construct/">WP_Error::__construct()</a><code>wp-includes/class-wp-error.php</code></td><td><p>Initializes the error.</p>
</td></tr></tbody></table></figure><a class="wp-block-wporg-code-table-show-more" href="#">Show 47 more</a><a class="wp-block-wporg-code-table-show-less" href="#">Show less</a></section> <section class="wp-block-wporg-code-table" id="used-by" style="margin-top:var(--wp--preset--spacing--20);"><figure class="wp-block-table"><table><thead><tr><th scope="col">Used by</th><th scope="col">Description</th></tr></thead><tbody><tr class=""><td><a href="https://developer.notmatt.press/reference/classes/wp_navigation_fallback/create_classic_menu_fallback/">WP_Navigation_Fallback::create_classic_menu_fallback()</a><code>wp-includes/class-wp-navigation-fallback.php</code></td><td><p>Creates a Navigation Menu post from a Classic Menu.</p>
</td></tr><tr class=""><td><a href="https://developer.notmatt.press/reference/classes/wp_navigation_fallback/create_default_fallback/">WP_Navigation_Fallback::create_default_fallback()</a><code>wp-includes/class-wp-navigation-fallback.php</code></td><td><p>Creates a default Navigation Block Menu fallback.</p>
</td></tr><tr class=""><td><a href="https://developer.notmatt.press/reference/classes/wp_theme_json_resolver/get_user_data_from_wp_global_styles/">WP_Theme_JSON_Resolver::get_user_data_from_wp_global_styles()</a><code>wp-includes/class-wp-theme-json-resolver.php</code></td><td><p>Returns the custom post type that contains the user’s origin config for the active theme or an empty array if none are found.</p>
</td></tr><tr class=""><td><a href="https://developer.notmatt.press/reference/classes/wp_rest_templates_controller/update_item/">WP_REST_Templates_Controller::update_item()</a><code>wp-includes/rest-api/endpoints/class-wp-rest-templates-controller.php</code></td><td><p>Updates a single template.</p>
</td></tr><tr class=""><td><a href="https://developer.notmatt.press/reference/classes/wp_rest_templates_controller/create_item/">WP_REST_Templates_Controller::create_item()</a><code>wp-includes/rest-api/endpoints/class-wp-rest-templates-controller.php</code></td><td><p>Creates a single template.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/wp_create_user_request/">wp_create_user_request()</a><code>wp-includes/user.php</code></td><td><p>Creates and logs a user request to perform a specific action.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/classes/wp_customize_manager/save_changeset_post/">WP_Customize_Manager::save_changeset_post()</a><code>wp-includes/class-wp-customize-manager.php</code></td><td><p>Saves the post for the loaded changeset.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/wp_update_custom_css_post/">wp_update_custom_css_post()</a><code>wp-includes/theme.php</code></td><td><p>Updates the <code>custom_css</code> post for a given theme.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/classes/wp_rest_posts_controller/create_item/">WP_REST_Posts_Controller::create_item()</a><code>wp-includes/rest-api/endpoints/class-wp-rest-posts-controller.php</code></td><td><p>Creates a single post.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/classes/wp_customize_nav_menus/insert_auto_draft_post/">WP_Customize_Nav_Menus::insert_auto_draft_post()</a><code>wp-includes/class-wp-customize-nav-menus.php</code></td><td><p>Adds a new <code>auto-draft</code> post.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/wp_write_post/">wp_write_post()</a><code>wp-admin/includes/post.php</code></td><td><p>Creates a new post from the “Write Post” form using <code>$_POST</code> information.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/get_default_post_to_edit/">get_default_post_to_edit()</a><code>wp-admin/includes/post.php</code></td><td><p>Returns default post information to use when populating the “Write Post” form.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/classes/wp_embed/shortcode/">WP_Embed::shortcode()</a><code>wp-includes/class-wp-embed.php</code></td><td><p>The <a href="https://developer.notmatt.press/reference/functions/do_shortcode/" rel="function">do_shortcode()</a>  callback function.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/wp_insert_attachment/">wp_insert_attachment()</a><code>wp-includes/post.php</code></td><td><p>Inserts an attachment.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/wp_update_post/">wp_update_post()</a><code>wp-includes/post.php</code></td><td><p>Updates a post with new post data.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/_wp_put_post_revision/">_wp_put_post_revision()</a><code>wp-includes/revision.php</code></td><td><p>Inserts post data into the posts table as a post revision.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/wp_update_nav_menu_item/">wp_update_nav_menu_item()</a><code>wp-includes/nav-menu.php</code></td><td><p>Saves the properties of a menu item or create a new one.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/classes/wp_xmlrpc_server/blogger_newpost/">wp_xmlrpc_server::blogger_newPost()</a><code>wp-includes/class-wp-xmlrpc-server.php</code></td><td><p>Creates a new post.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/classes/wp_xmlrpc_server/mw_newpost/">wp_xmlrpc_server::mw_newPost()</a><code>wp-includes/class-wp-xmlrpc-server.php</code></td><td><p>Creates a new post.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/classes/wp_xmlrpc_server/_insert_post/">wp_xmlrpc_server::_insert_post()</a><code>wp-includes/class-wp-xmlrpc-server.php</code></td><td><p>Helper method for wp_newPost() and wp_editPost(), containing shared logic.</p>
</td></tr></tbody></table></figure><a class="wp-block-wporg-code-table-show-more" href="#">Show 15 more</a><a class="wp-block-wporg-code-table-show-less" href="#">Show less</a></section> </section>
<section class="wp-block-wporg-code-reference-changelog"><h2 class="is-toc-heading wp-block-heading has-heading-5-font-size" id="changelog" tabindex="-1"><a href="#changelog">Changelog</a></h2> <section class="wp-block-wporg-code-table" style="margin-top:var(--wp--preset--spacing--20);"><figure class="wp-block-table"><table><thead><tr><th scope="col">Version</th><th scope="col">Description</th></tr></thead><tbody><tr class=""><td><a href="https://developer.notmatt.press/reference/since/5.6.0/">5.6.0</a></td><td><span class="since-description">Added the <code>$fire_after_hooks</code> parameter.</span></td></tr><tr class=""><td><a href="https://developer.notmatt.press/reference/since/4.4.0/">4.4.0</a></td><td><span class="since-description">A <code>'meta_input'</code> array can now be passed to <code>$postarr</code> to add post meta data.</span></td></tr><tr class=""><td><a href="https://developer.notmatt.press/reference/since/4.2.0/">4.2.0</a></td><td><span class="since-description">Support was added for encoding emoji in the post title, content, and excerpt.</span></td></tr><tr class=""><td><a href="https://developer.notmatt.press/reference/since/2.6.0/">2.6.0</a></td><td><span class="since-description">Added the <code>$wp_error</code> parameter to allow a <a href="https://developer.notmatt.press/reference/classes/wp_error/" rel="class">WP_Error</a> to be returned on failure.</span></td></tr><tr class=""><td><a href="https://developer.notmatt.press/reference/since/1.0.0/">1.0.0</a></td><td>Introduced.</td></tr></tbody></table></figure></section> </section>
<section class="wp-block-wporg-code-reference-comments" data-nosnippet="true"><h2 class="is-toc-heading wp-block-heading" id="user-contributed-notes" tabindex="-1"><a href="#user-contributed-notes">User Contributed Notes</a></h2> <ol class="comment-list"> <li class="comment byuser comment-author-truongwp odd alt thread-odd thread-alt depth-1" data-comment-id="1710" id="comment-1710">
<article class="comment-body" id="div-comment-1710">
<a class="screen-reader-text" href="#comment-content-1710">Skip to note 20 content</a>

<!-- .comment-metadata -->
<div class="wporg-has-embedded-code comment-content" id="comment-content-1710">
<p>Insert post with custom taxonomy and post meta data (since 4.4.0):</p>
<pre class="wp-block-code"><code class="language-php line-numbers" lang="php">$hierarchical_tax = array( 13, 10 ); // Array of tax ids.
$non_hierarchical_terms = 'tax name 1, tax name 2'; // Can use array of ids or string of tax names separated by commas

$post_arr = array(
	'post_title'   =&gt; 'Test post',
	'post_content' =&gt; 'Test post content',
	'post_status'  =&gt; 'publish',
	'post_author'  =&gt; get_current_user_id(),
	'tax_input'    =&gt; array(
		'hierarchical_tax'     =&gt; $hierarchical_tax,
		'non_hierarchical_tax' =&gt; $non_hierarchical_terms,
	),
	'meta_input'   =&gt; array(
		'test_meta_key' =&gt; 'value of test_meta_key',
	),
);</code></pre>
</div><!-- .comment-content -->
<section class="wporg-has-embedded-code feedback hide-if-js" data-comment-count="0" id="feedback-1710">
</section><!-- .feedback -->

</article><!-- .comment-body -->
</li>
<li class="comment byuser comment-author-jxowe even thread-even depth-1" data-comment-id="2164" id="comment-2164">
<article class="comment-body" id="div-comment-2164">
<a class="screen-reader-text" href="#comment-content-2164">Skip to note 21 content</a>

<!-- .comment-metadata -->
<div class="wporg-has-embedded-code comment-content" id="comment-content-2164">
<p>‘tax_input’ in the arguments only works on wp_insert_post if the function is being called by a user with “assign_terms” access</p>
<p><a href="https://core.trac.wordpress.org/browser/tags/4.7/src/wp-includes/post.php#L3352" rel="nofollow ugc">https://core.trac.wordpress.org/browser/tags/4.7/src/wp-includes/post.php#L3352</a></p>
</div><!-- .comment-content -->
<section class="wporg-has-embedded-code feedback hide-if-js" data-comment-count="0" id="feedback-2164">
</section><!-- .feedback -->

</article><!-- .comment-body -->
</li>
<li class="comment byuser comment-author-codex odd alt thread-odd thread-alt depth-1" data-comment-id="401" id="comment-401">
<article class="comment-body" id="div-comment-401">
<a class="screen-reader-text" href="#comment-content-401">Skip to note 22 content</a>

<!-- .comment-metadata -->
<div class="wporg-has-embedded-code comment-content" id="comment-content-401">
<p><strong>Inserting a Post</strong></p>
<p>Before calling <code>wp_insert_post()</code> it is necessary to create an array to pass the necessary elements that make up a post. The <code>wp_insert_post()</code> will fill out a default list of these but the user is required to provide the title and content otherwise the database write will fail.</p>
<p>The next example shows the post title, content, status, author, and post categories being set. You can add further key-value pairs, making sure the keys match the names of the columns in the <code>wp_posts</code> table in the database.</p>
<pre class="wp-block-code"><code class="language-php line-numbers" lang="php">// Gather post data.
$my_post = array(
	'post_title'    =&gt; 'My post',
	'post_content'  =&gt; 'This is my post.',
	'post_status'   =&gt; 'publish',
	'post_author'   =&gt; 1,
	'post_category' =&gt; array( 8,39 )
);

// Insert the post into the database.
wp_insert_post( $my_post );</code></pre>
<p>You can also get the new post ID after inserting a new post:</p>
<pre class="wp-block-code"><code class="language-php" lang="php">$post_id = wp_insert_post( $post, $wp_error );</code></pre>
</div><!-- .comment-content -->
<section class="wporg-has-embedded-code feedback hide-if-js" data-comment-count="0" id="feedback-401">
</section><!-- .feedback -->

</article><!-- .comment-body -->
</li>
<li class="comment byuser comment-author-aurovrata even thread-even depth-1" data-comment-id="2096" id="comment-2096">
<article class="comment-body" id="div-comment-2096">
<a class="screen-reader-text" href="#comment-content-2096">Skip to note 23 content</a>

<!-- .comment-metadata -->
<div class="wporg-has-embedded-code comment-content" id="comment-content-2096">
<p>Its important that you validate your post ID before you use by checking if the returned values is not a <a href="https://developer.notmatt.press/reference/classes/wp_error/" rel="class">WP_error</a>,</p>
<pre class="wp-block-code"><code class="language-php line-numbers" lang="php">$args = array(
  'post_type' =&gt; 'my_custom_post',
  /*other default parameters you want to set*/
);
$post_id = wp_insert_post($args);
if(!is_wp_error($post_id)){
  //the post is valid
}else{
  //there was an error in the post insertion, 
  echo $post_id-&gt;get_error_message();
}</code></pre>
</div><!-- .comment-content -->
<section class="wporg-has-embedded-code feedback hide-if-js" data-comment-count="2" id="feedback-2096">
<ul class="children">
<li class="comment byuser comment-author-wpexplorer odd alt depth-2" data-comment-id="5159" id="comment-5159">
<article class="comment-body" id="div-comment-5159">
<div class="wporg-has-embedded-code comment-content" id="comment-content-5159">
<div>Variables must be escaped when echo’d.  Line 10 should read:  <code>echo esc_html( $post_id-&gt;get_error_message() );</code></div>
<div><a class="url" href="https://profiles.wordpress.org/wpexplorer/" rel="external nofollow">wpexplorer</a> <a class="comment-date" href="https://developer.notmatt.press/reference/functions/wp_insert_post/#comment-5159"><time datetime="2021-06-20T19:27:27+00:00">4 years ago</time></a></div>
</div><!-- .comment-content -->
</article>
</li>
<li class="comment byuser comment-author-asmitta even depth-2" data-comment-id="6520" id="comment-6520">
<article class="comment-body" id="div-comment-6520">
<div class="wporg-has-embedded-code comment-content" id="comment-content-6520">
<div>Since the function can return 0 on failure i suggest on line #6 to write: <code>if(!is_wp_error($post_id) &amp;&amp; $post_id !== 0){</code></div>
<div><a class="url" href="https://profiles.wordpress.org/asmitta/" rel="external nofollow">asmitta</a> <a class="comment-date" href="https://developer.notmatt.press/reference/functions/wp_insert_post/#comment-6520"><time datetime="2023-06-22T15:08:17+00:00">2 years ago</time></a></div>
</div><!-- .comment-content -->
</article>
</li>
</ul>
</section><!-- .feedback -->

</article><!-- .comment-body -->
</li>
<li class="comment byuser comment-author-karzin odd alt thread-odd thread-alt depth-1" data-comment-id="2434" id="comment-2434">
<article class="comment-body" id="div-comment-2434">
<a class="screen-reader-text" href="#comment-content-2434">Skip to note 24 content</a>

<!-- .comment-metadata -->
<div class="wporg-has-embedded-code comment-content" id="comment-content-2434">
<p>As @Kiera Howe brilliantly noticed, <strong>‘tax_input’</strong> requires <strong>‘assign_terms’</strong> access.<br>
Depending on the case it can make its use impracticable.</br></p>
<p>A quick solution could be replacing it by:</p>
<pre class="wp-block-code"><code class="language-php" lang="php">wp_set_object_terms( $post_id, array( $term_id1, $term_id2 ), 'tax_slug' );</code></pre>
<p>Reference:<br>
<a href="https://ryansechrest.com/2012/07/wordpress-taxonomy-terms-dont-insert-when-cron-job-executes-wp_insert_post/" rel="nofollow ugc">https://ryansechrest.com/2012/07/wordpress-taxonomy-terms-dont-insert-when-cron-job-executes-wp_insert_post/</a></br></p>
</div><!-- .comment-content -->
<section class="wporg-has-embedded-code feedback hide-if-js" data-comment-count="1" id="feedback-2434">
<ul class="children">
<li class="comment byuser comment-author-rinopo even depth-2" data-comment-id="3487" id="comment-3487">
<article class="comment-body" id="div-comment-3487">
<div class="wporg-has-embedded-code comment-content" id="comment-content-3487">
<div>Another solution could be to use <code>wp_set_current_user( 1 );</code> beforehand, assuming the ID ‘1’ is the super admin.</div>
<div><a class="url" href="https://profiles.wordpress.org/rinopo/" rel="external nofollow">rinopo</a> <a class="comment-date" href="https://developer.notmatt.press/reference/functions/wp_insert_post/#comment-3487"><time datetime="2019-11-23T13:38:56+00:00">5 years ago</time></a></div>
</div><!-- .comment-content -->
</article>
</li>
</ul>
</section><!-- .feedback -->

</article><!-- .comment-body -->
</li>
<li class="comment byuser comment-author-kanggheekeong odd alt thread-even depth-1" data-comment-id="3090" id="comment-3090">
<article class="comment-body" id="div-comment-3090">
<a class="screen-reader-text" href="#comment-content-3090">Skip to note 25 content</a>

<!-- .comment-metadata -->
<div class="wporg-has-embedded-code comment-content" id="comment-content-3090">
<p>The post_template parameter should be described as well.</p>
<p>It should be set with a full file name, such as ‘templatefilename.php’.</p>
<p>This clarify will help developers trying to tie a template to a page.</p>
</div><!-- .comment-content -->
<section class="wporg-has-embedded-code feedback hide-if-js" data-comment-count="1" id="feedback-3090">
<ul class="children">
<li class="comment byuser comment-author-larzans even depth-2" data-comment-id="3608" id="comment-3608">
<article class="comment-body" id="div-comment-3608">
<div class="wporg-has-embedded-code comment-content" id="comment-content-3608">
<div>And make sure to also add the subdirectory if your template is not in the theme’s root folder. So for example  <code>'page_template' =&gt; 'templates/tpl_default.php'</code></div>
<div><a class="url" href="https://profiles.wordpress.org/larzans/" rel="external nofollow">Larzans</a> <a class="comment-date" href="https://developer.notmatt.press/reference/functions/wp_insert_post/#comment-3608"><time datetime="2020-01-31T11:05:37+00:00">5 years ago</time></a></div>
</div><!-- .comment-content -->
</article>
</li>
</ul>
</section><!-- .feedback -->

</article><!-- .comment-body -->
</li>
<li class="comment byuser comment-author-natewr odd alt thread-odd thread-alt depth-1" data-comment-id="268" id="comment-268">
<article class="comment-body" id="div-comment-268">
<a class="screen-reader-text" href="#comment-content-268">Skip to note 26 content</a>

<!-- .comment-metadata -->
<div class="wporg-has-embedded-code comment-content" id="comment-content-268">
<p>By default, <code>wp_insert_post</code> will not insert an empty post. This can cause unexpected problems if you’re passing an <code>ID</code> and expecting it to fall back to <code>wp_update_post</code>. For instance, the following will not work:</p>
<pre class="wp-block-code"><code class="language-php" lang="php">wp_insert_post( array( 'ID' =&gt; 2, 'post_parent' =&gt; 1 ) );</code></pre>
<p>You will need to call <code>wp_update_post</code> directly.</p>
<pre class="wp-block-code"><code class="language-php" lang="php">wp_update_post( array( 'ID' =&gt; 2, 'post_parent' =&gt; 1 ) );</code></pre>
</div><!-- .comment-content -->
<section class="wporg-has-embedded-code feedback hide-if-js" data-comment-count="0" id="feedback-268">
</section><!-- .feedback -->

</article><!-- .comment-body -->
</li>
<li class="comment byuser comment-author-flimm even thread-even depth-1" data-comment-id="3355" id="comment-3355">
<article class="comment-body" id="div-comment-3355">
<a class="screen-reader-text" href="#comment-content-3355">Skip to note 27 content</a>

<!-- .comment-metadata -->
<div class="wporg-has-embedded-code comment-content" id="comment-content-3355">
<p>The format for <code>post_date</code> and <code>post_date_gmt</code> input is <code>Y-m-d H:i:s</code>, for instance <code>2019-01-01 01:01:01</code>. You can use PHP’s <code>date</code> function, like this:</p>
<pre class="wp-block-code"><code class="language-php" lang="php">wp_insert_post( array(
    'post_date' =&gt; date( 'Y-m-d H:i:s', time() ),
    // etc
) );</code></pre>
</div><!-- .comment-content -->
<section class="wporg-has-embedded-code feedback hide-if-js" data-comment-count="0" id="feedback-3355">
</section><!-- .feedback -->

</article><!-- .comment-body -->
</li>
<li class="comment byuser comment-author-compute odd alt thread-odd thread-alt depth-1" data-comment-id="2319" id="comment-2319">
<article class="comment-body" id="div-comment-2319">
<a class="screen-reader-text" href="#comment-content-2319">Skip to note 28 content</a>

<!-- .comment-metadata -->
<div class="wporg-has-embedded-code comment-content" id="comment-content-2319">
<p>When saving data containing slashes remember to add extra slashes due to <code>wp_insert_post</code> unslashing these values.</p>
<pre class="wp-block-code"><code class="language-php line-numbers" lang="php">$regex = '(\b16-\d{3}\b)';
$post_data = array(
    'post_title' =&gt; 'Test regex',
    'post_content' =&gt; $regex,
    'post_type' =&gt; 'post',
);
$post_id = wp_insert_post( $post_data );</code></pre>
<p>Will store <code>(b16-d{3}b)</code>. To fix this use <code>wp_slash()</code>:</p>
<pre class="wp-block-code"><code class="language-php line-numbers" lang="php">$regex = '(\b16-\d{3}\b)';
$post_data = array(
    'post_title' =&gt; 'Test regex',
    'post_content' =&gt; wp_slash( $regex ),
    'post_type' =&gt; 'post',
);
$post_id = wp_insert_post( $post_data );</code></pre>
</div><!-- .comment-content -->
<section class="wporg-has-embedded-code feedback hide-if-js" data-comment-count="0" id="feedback-2319">
</section><!-- .feedback -->

</article><!-- .comment-body -->
</li>
<li class="comment byuser comment-author-simongcc even thread-even depth-1" data-comment-id="3645" id="comment-3645">
<article class="comment-body" id="div-comment-3645">
<a class="screen-reader-text" href="#comment-content-3645">Skip to note 29 content</a>

<!-- .comment-metadata -->
<div class="wporg-has-embedded-code comment-content" id="comment-content-3645">
<p>About taxonomy parameter<br>
Parameters: <code>'tax_input' (array) Array of taxonomy terms keyed by their taxonomy name. Default empty.</code> </br></p>
<p>The description for the parameter <strong>‘tax_input’</strong> is not clearly stated and no example is given so far, so I would like to add a supplementary note here for the exact meaning and examples.  </p>
<p>According to the source code of ‘<a href="https://developer.notmatt.press/reference/functions/wp_insert_post/" rel="function">wp_insert_post()</a> ’, the <strong>‘tax_input’</strong> is being added by function <strong>‘<a href="https://developer.notmatt.press/reference/functions/wp_set_post_terms/" rel="function">wp_set_post_terms()</a> ’</strong>. So I refer to its description that  Here is the example for using this: </p>
<pre class="wp-block-code"><code class="language-php" lang="php">'tax_input' =&gt; array( $taxomony =&gt; $tags )</code></pre>
<ul>
<li>$taxomony – (string) Taxonomy name $tags – (string|array) An array of terms to set for the post, or a string of terms separated by commas. <strong>(tags)</strong><br>
eg.  
<pre class="wp-block-code"><code class="language-php" lang="php">'something1, something2, something3'</code></pre>
<p> or </p>
<pre class="wp-block-code"><code class="language-php" lang="php">array( 30, 40, 50 )</code></pre>
<p> or </p>
<pre class="wp-block-code"><code class="language-php" lang="php">array( 'something1', 'something2', 'something3' )</code></pre>
</br></li>
<li>Hierarchical taxonomies <strong>(category)</strong> <strong><em>must always pass IDs</em></strong> rather than names so that children with the same names but different parents aren’t confused.  eg.
<pre class="wp-block-code"><code class="language-php" lang="php">array( 30, 40, 50 )</code></pre>
</li>
</ul>
<p>Tested: I have personally tested it in a custom post type with custom category(taxonomy) name with <a href="https://developer.notmatt.press/reference/functions/wp_update_post/" rel="function">wp_update_post()</a> </p>
</div><!-- .comment-content -->
<section class="wporg-has-embedded-code feedback hide-if-js" data-comment-count="0" id="feedback-3645">
</section><!-- .feedback -->

</article><!-- .comment-body -->
</li>
<li class="comment byuser comment-author-sweetdaisy86 odd alt thread-odd thread-alt depth-1" data-comment-id="3329" id="comment-3329">
<article class="comment-body" id="div-comment-3329">
<a class="screen-reader-text" href="#comment-content-3329">Skip to note 30 content</a>

<!-- .comment-metadata -->
<div class="wporg-has-embedded-code comment-content" id="comment-content-3329">
<p>To add Taxonomy and Meta field values with custom post types. </p>
<p><strong>For Taxonomy:</strong><br>
Make sure Taxonomy name is key of tax_input array. And the array of Taxonomy ID’s is value of that key like in example below. </br></p>
<p><strong>For Meta Values:</strong><br>
You can pass meta value name as key and meta value as that keys value. </br></p>
<pre class="wp-block-code"><code class="language-php line-numbers" lang="php">$post_arr = array(
				'post_title'   =&gt; esc_html($video_title),
				'post_content' =&gt; $video_description,
				'post_status'  =&gt; 'draft',
				'post_author'  =&gt; $user_id,
				'post_type'	   =&gt; 'videos',
				'tax_input'    =&gt; array(
					"video_category" =&gt; $taxnomy_ids //Video Cateogry is Taxnmony Name and being used as key of array.
				),
				'meta_input'   =&gt; array(
					'wc_video_url' =&gt; $video_url,
					'wc_product'   =&gt; $video_product
				),
			);</code></pre>
</div><!-- .comment-content -->
<section class="wporg-has-embedded-code feedback hide-if-js" data-comment-count="0" id="feedback-3329">
</section><!-- .feedback -->

</article><!-- .comment-body -->
</li>
<li class="comment byuser comment-author-benjithaimmortal even thread-even depth-1" data-comment-id="3682" id="comment-3682">
<article class="comment-body" id="div-comment-3682">
<a class="screen-reader-text" href="#comment-content-3682">Skip to note 31 content</a>

<!-- .comment-metadata -->
<div class="wporg-has-embedded-code comment-content" id="comment-content-3682">
<p>If you’re creating a post and the post ID doesn’t yet exist, using <code>'ID' =&gt; your_number</code> will not create a new post. It will return blank, because it searched for the ID and it didn’t exist.</p>
<p>Instead, use <code>'import_id'</code> like this:</p>
<pre class="wp-block-code"><code class="language-php line-numbers" lang="php">$args = array(
	'import_id'    =&gt; your_custom_integer, 	// this designates the custom post ID you want to use! make sure it's unique
	'post_type'	   =&gt; 'your_post_type',
	'post_status'  =&gt; 'publish',
	'content'	   =&gt; 'your_content',
	'meta_input'   =&gt; array(
		'product_data' =&gt; 'if_you_want_this'
	)
);

$id = wp_insert_post($args);</code></pre>
</div><!-- .comment-content -->
<section class="wporg-has-embedded-code feedback hide-if-js" data-comment-count="0" id="feedback-3682">
</section><!-- .feedback -->

</article><!-- .comment-body -->
</li>
<li class="comment byuser comment-author-albertohrtzt odd alt thread-odd thread-alt depth-1" data-comment-id="5689" id="comment-5689">
<article class="comment-body" id="div-comment-5689">
<a class="screen-reader-text" href="#comment-content-5689">Skip to note 32 content</a>

<!-- .comment-metadata -->
<div class="wporg-has-embedded-code comment-content" id="comment-content-5689">
<p>Directly insert existing attachment with id 32 to post thumbnail.</p>
<pre class="wp-block-code"><code class="language-php line-numbers" lang="php">$thumbnail_id = 32;

$args = array(
    'post_type' =&gt; 'post',
    'post_title' =&gt; 'Some title',
    'post_content' =&gt; 'Some content',
    '_thumbnail_id' =&gt; $thumbnail_id,
);

wp_insert_post( $args );</code></pre>
</div><!-- .comment-content -->
<section class="wporg-has-embedded-code feedback hide-if-js" data-comment-count="0" id="feedback-5689">
</section><!-- .feedback -->

</article><!-- .comment-body -->
</li>
<li class="comment byuser comment-author-cvladan even thread-even depth-1" data-comment-id="6514" id="comment-6514">
<article class="comment-body" id="div-comment-6514">
<a class="screen-reader-text" href="#comment-content-6514">Skip to note 33 content</a>

<!-- .comment-metadata -->
<div class="wporg-has-embedded-code comment-content" id="comment-content-6514">
<p><strong>By default, <code>wp_insert_post</code> does not allow you to set <code>post_modified</code>.</strong></p>
<p>If you want to change the modified date of the post, you will find that this is not possible. In fact, the <code>$postarr</code> parameter does not contain the <code>post_modified</code> or <code>post_modified_gmt</code> field. This is intentional, and in a way makes sense, because the modified post date is automatically set to the time the post was inserted.</p>
<p>However, if you are doing an import or similar, you may want to set the <code>post_modified</code> field explicitly. Of course you can use two separate commands and two SQL statements – first insert the post with <code>wp_insert_post</code> and then update the modified date with <code>wp_update_post</code>. For instance like this</p>
<pre class="wp-block-code"><code class="language-php line-numbers" lang="php">wp_update_post( array(
    'ID'                =&gt; $post_id, 
    'post_modified'     =&gt; $date,
    'post_modified_gmt' =&gt; get_gmt_from_date( $date ),
) );</code></pre>
<p>However, a much better and more performant solution that requires only one SQL statement is as follows. You need to hook into <code>wp_insert_post_data</code> and insert the desired value just before <code>wp_insert_post</code>, and then remove this filter so that all other insert operations in WordPress continue to work as expected. It would look roughly as follows:</p>
<pre class="wp-block-code"><code class="language-php line-numbers" lang="php">function wpdocs_with_post_modified( $data, $postarr ) {
    $data['post_modified']     = $postarr['post_modified'] ?? null;
    $data['post_modified_gmt'] = $postarr['post_modified_gmt'] ?? get_gmt_from_date( $data['post_modified'] );
    $data['post_modified']     = $data['post_modified'] ?? get_date_from_gmt( $data['post_modified_gmt'] );

    return $data;
}

add_filter( 'wp_insert_post_data', 'wpdocs_with_post_modified', PHP_INT_MAX, 2 );
$newpost = wp_insert_post( $data );
remove_filter( 'wp_insert_post_data', 'wpdocs_with_post_modified', PHP_INT_MAX );</code></pre>
</div><!-- .comment-content -->
<section class="wporg-has-embedded-code feedback hide-if-js" data-comment-count="0" id="feedback-6514">
</section><!-- .feedback -->

</article><!-- .comment-body -->
</li>
<li class="comment byuser comment-author-mdshuvo odd alt thread-odd thread-alt depth-1" data-comment-id="4414" id="comment-4414">
<article class="comment-body" id="div-comment-4414">
<a class="screen-reader-text" href="#comment-content-4414">Skip to note 34 content</a>

<!-- .comment-metadata -->
<div class="wporg-has-embedded-code comment-content" id="comment-content-4414">
<p>Prevent duplicate post</p>
<pre class="wp-block-code"><code class="language-php line-numbers" lang="php">// Product Title
$post_title = 'Test Product';

// Add Product
$new_post = array(
    'post_title' =&gt; $post_title,
    'post_type' =&gt; 'product',
    'post_staus' =&gt; 'draft', 
    'post_content' =&gt; 'Lorem Ipsum is simply dummy text of the printing and typesetting industry.',
    'post_excerpt' =&gt; 'Lorem Ipsum is simply dummy text'
);

// Catch post ID
$post_id = post_exists( $post_title ) or wp_insert_post( $new_post );</code></pre>
</div><!-- .comment-content -->
<section class="wporg-has-embedded-code feedback hide-if-js" data-comment-count="0" id="feedback-4414">
</section><!-- .feedback -->

</article><!-- .comment-body -->
</li>
<li class="comment byuser comment-author-daniyalahmedk even thread-even depth-1" data-comment-id="1834" id="comment-1834">
<article class="comment-body" id="div-comment-1834">
<a class="screen-reader-text" href="#comment-content-1834">Skip to note 35 content</a>

<!-- .comment-metadata -->
<div class="wporg-has-embedded-code comment-content" id="comment-content-1834">
<p>Create a post for custom post type : </p>
<pre class="wp-block-code"><code class="language-php" lang="php">$id = wp_insert_post(array('post_title'=&gt;'random', 'post_type'=&gt;'custom_post', 'post_content'=&gt;'demo text'));</code></pre>
</div><!-- .comment-content -->
<section class="wporg-has-embedded-code feedback hide-if-js" data-comment-count="0" id="feedback-1834">
</section><!-- .feedback -->

</article><!-- .comment-body -->
</li>
<li class="comment byuser comment-author-rkokdev odd alt thread-odd thread-alt depth-1" data-comment-id="5150" id="comment-5150">
<article class="comment-body" id="div-comment-5150">
<a class="screen-reader-text" href="#comment-content-5150">Skip to note 36 content</a>

<!-- .comment-metadata -->
<div class="wporg-has-embedded-code comment-content" id="comment-content-5150">
<p>Watch out when <strong>updating</strong> a post using <a href="https://developer.notmatt.press/reference/functions/wp_insert_post/" rel="function">wp_insert_post()</a> ; if you don’t explicitly specify the post_status, it will change it back to ‘draft’.</p>
<p>I ended up using <a href="https://developer.notmatt.press/reference/functions/wp_update_post/" rel="function">wp_update_post()</a>  instead.</p>
</div><!-- .comment-content -->
<section class="wporg-has-embedded-code feedback hide-if-js" data-comment-count="0" id="feedback-5150">
</section><!-- .feedback -->

</article><!-- .comment-body -->
</li>
<li class="comment byuser comment-author-khoipro even thread-even depth-1 bad-note" data-comment-id="3112" id="comment-3112">
<article class="comment-body" id="div-comment-3112">
<a class="screen-reader-text" href="#comment-content-3112">Skip to note 37 content</a>

<!-- .comment-metadata -->
<div class="wporg-has-embedded-code comment-content" id="comment-content-3112">
<p>To work with this function, you should add condition to each of </p>
<pre class="wp-block-code"><code class="language-php" lang="php">$_POST</code></pre>
<pre class="wp-block-code"><code class="language-php line-numbers" lang="php">  $post_title = $_POST['title'];
  $post_description = $_POST['content'];
  $post_posted_id = $_POST['user_id'];
  $post_categories = $_POST['term'];
  $post_options = array();

  if( !empty($post_description) ) {
    $post_options['post_content'] = wp_strip_all_tags(post_description);
  }

  if( !empty($post_title) ) {
    $post_options['post_title'] = wp_strip_all_tags($post_title);
    // Then start to add new post
    $post_id = wp_insert_post($post_options);
    // Then return JSON in case you are using AJAX

    if( !is_wp_error($post_id) ) {
      wp_send_json_success(array('post_id' =&gt; $post_id), 200);
    } else {
      wp_send_json_error($post_id-&gt;get_error_message());
    }
  }</code></pre>
<p>The second thing, in case you push multiple params like multiple checkbox checked, you should know how to push to array:</p>
<p>The example markup:</p>
<pre class="wp-block-code"><code class="language-php line-numbers" lang="php">&lt;?php
// Existing Bootstrap 4 markup
if( !empty($languages) ) : ?&gt;
  &lt;?php foreach($languages as $key =&gt; $language) : ?&gt;
    &lt;div class="form-check"&gt;
      &lt;input class="form-check-input" type="checkbox" value="&lt;?php echo $language['id']; ?&gt;" id="term[language][&lt;?php echo $key; ?&gt;]" name="term[language][]"&gt;
      &lt;label class="form-check-label" for="term[language][&lt;?php echo $key; ?&gt;]"&gt;&lt;?php echo $language['name']; ?&gt;&lt;/label&gt;
    &lt;/div&gt;
  &lt;?php endforeach; ?&gt;
&lt;?php endif; 
// The result you got term[language] = [11, 13, 14];
?&gt;</code></pre>
<p>We should check and using this function to keep it working:</p>
<pre class="wp-block-code"><code class="language-php line-numbers" lang="php">&lt;?php
// Function hint: wp_ajax_
// Function hint: wp_ajax_nopriv_

$post_terms = $_POST['term'];
if( !empty($post_terms) ) {
  foreach($post_terms as $key =&gt; $category) {
    if( $post_options['tax_input'][$key] !== '' ) {
      $post_options['tax_input'][$key] = array($category);
    } else {
      array_push($post_options['tax_input'][$key], $category);
    }
  }
}
?&gt;</code></pre>
</div><!-- .comment-content -->
<section class="wporg-has-embedded-code feedback hide-if-js" data-comment-count="0" id="feedback-3112">
</section><!-- .feedback -->

</article><!-- .comment-body -->
</li>
<li class="comment byuser comment-author-oabadfol odd alt thread-odd thread-alt depth-1 bad-note" data-comment-id="2476" id="comment-2476">
<article class="comment-body" id="div-comment-2476">
<a class="screen-reader-text" href="#comment-content-2476">Skip to note 38 content</a>

<!-- .comment-metadata -->
<div class="wporg-has-embedded-code comment-content" id="comment-content-2476">
<p>This snippet creates a post with code checking if the post already exists before creating it.</p>
<pre class="wp-block-code"><code class="language-php line-numbers" lang="php">function create_wordpress_post_with_code() {
    
        // Set the post ID to -1. This sets to no action at moment
        $post_id = -1;
    
        // Set the Author, Slug, title and content of the new post
        $author_id = 1;
        $slug = 'wordpress-post-created-with-code';
        $title = 'WordPress post created whith code';
        $content = 'This is the content of the post that we are creating right now with code. 
                    More text: I motsetning til hva mange tror, er ikke Lorem Ipsum bare tilfeldig tekst. 
                    Dets røtter springer helt tilbake til et stykke klassisk latinsk litteratur fra 45 år f.kr., 
                    hvilket gjør det over 2000 år gammelt. Richard McClintock - professor i latin ved Hampden-Sydney 
                    College i Virginia, USA - slo opp flere av de mer obskure latinske ordene, consectetur, 
                    fra en del av Lorem Ipsum, og fant dets utvilsomme opprinnelse gjennom å studere bruken 
                    av disse ordene i klassisk litteratur. Lorem Ipsum kommer fra seksjon 1.10.32 og 1.10.33 i 
                    "de Finibus Bonorum et Malorum" (The Extremes of Good and Evil) av Cicero, skrevet i år 45 f.kr. 
                    Boken er en avhandling om teorier rundt etikk, og var veldig populær under renessansen. Den første 
                    linjen av Lorem Ipsum, "Lorem Ipsum dolor sit amet...", er hentet fra en linje i seksjon 1.10.32.';
        // Cheks if doen't exists a post with slug "wordpress-post-created-with-code".
        if( !post_exists_by_slug( $slug ) ) {
            // Set the post ID
            $post_id = wp_insert_post(
                array(
                    'comment_status'	=&gt;	'closed',
                    'ping_status'		=&gt;	'closed',
                    'post_author'		=&gt;	$author_id,
                    'post_name'		    =&gt;	$slug,
                    'post_title'		=&gt;	$title,
                    'post_content'      =&gt;  $content,
                    'post_status'		=&gt;	'publish',
                    'post_type'		    =&gt;	'post'
                )
            );
        } else {
    
                // Set pos_id to -2 becouse there is a post with this slug.
                $post_id = -2;
        
        } // end if
    
    } // end oaf_create_post_with_code
 add_filter( 'after_setup_theme', 'create_wordpress_post_with_code' );
 /**
 * post_exists_by_slug.
 *
 * @return mixed boolean false if no post exists; post ID otherwise.
 */
function post_exists_by_slug( $post_slug ) {
    $args_posts = array(
        'post_type'      =&gt; 'post',
        'post_status'    =&gt; 'any',
        'name'           =&gt; $post_slug,
        'posts_per_page' =&gt; 1,
    );
    $loop_posts = new WP_Query( $args_posts );
    if ( ! $loop_posts-&gt;have_posts() ) {
        return false;
    } else {
        $loop_posts-&gt;the_post();
        return $loop_posts-&gt;post-&gt;ID;
    }
}</code></pre>
</div><!-- .comment-content -->
<section class="wporg-has-embedded-code feedback hide-if-js" data-comment-count="0" id="feedback-2476">
</section><!-- .feedback -->

</article><!-- .comment-body -->
</li>
</ol></section>
</div></div>
    </div>
<footer class="text-center mt-10 py-5">
    <p class="text-sm"><a href="https://notmatt.press">NotMattPress</a>.</p>
</footer>
</body>
</html>
