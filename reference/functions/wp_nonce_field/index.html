
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Untitled Page</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@3.3.5/dist/tailwind.min.css" rel="stylesheet">
    <style>
        body {
            background-color: white;
            color: black;
            font-family: 'Quicksand', 'Open Sans', 'Helvetica', 'Arial', san-serif;
        }
        a, h1, h2, h3, h4, h5, h6 {
            color: #0073aa;
        }
        .container {
            max-width: 800px;
            margin: auto;
            padding: 20px;
        }
        .has-small-font-size.is-link-to-top {
            position: absolute;
            bottom: 10px;
            right: 10px;
        }
        .entry-content {
            position:relative;
        }
        .entry-content img {
            max-width: 100%;
        }
    </style>
</head>
<body>
<div class='container'>
    
    <div class="page-metadata" data-published="" data-last-updated=""></div>
    
    <div aria-label="Breadcrumbs" class="wp-block-wporg-site-breadcrumbs has-small-font-size" role="navigation"><div class="wporg-site-breadcrumbs__wrapper"><span><a href="https://developer.wordpress.org">Home</a></span><span><a href="https://developer.wordpress.org/reference/">Reference</a></span><span><a href="https://developer.wordpress.org/reference/functions/">Functions</a></span><span class="is-current-page">wp_nonce_field()</span></div></div>  <!-- Full breadcrumbs HTML -->
    <h1>wp_nonce_field()</h1>
    <h1 class="wp-block-wporg-code-reference-title" style="margin-bottom:40px;">wp_nonce_field( <span class="arg-type">int|string</span> <span class="arg-name">$action</span> = <span class="arg-default">-1</span>,  <span class="arg-type">string</span> <span class="arg-name">$name</span> = <span class="arg-default">'_wpnonce'</span>,  <span class="arg-type">bool</span> <span class="arg-name">$referer</span> = <span class="arg-default">true</span>,  <span class="arg-type">bool</span> <span class="arg-name">$display</span> = <span class="arg-default">true</span> ): <span class="return-type">string</span></h1>
    
    <div class="content"><div class="entry-content wp-block-post-content is-layout-flow wp-container-core-post-content-is-layout-1 wp-block-post-content-is-layout-flow">
<section class="wp-block-wporg-code-reference-summary"><p>Retrieves or display nonce hidden field for forms.</p>
</section>
<section class="wp-block-wporg-code-reference-description"><h2 class="is-toc-heading wp-block-heading has-heading-5-font-size" id="description" tabindex="-1"><a href="#description">Description</a></h2> <p>The nonce field is used to validate that the contents of the form came from the location on the current site and not somewhere else. The nonce does not offer absolute protection, but should protect against most cases. It is very important to use nonce field in forms.</p>
<p>The $action and $name are optional, but if you want to have better security, it is strongly suggested to set those two parameters. It is easier to just call the function without any parameters, because validation of the nonce doesn’t require any parameters, but since crackers know what the default is it won’t be difficult for them to find a way around your nonce and cause damage.</p>
<p>The input name will be whatever $name value you gave. The input value will be the nonce creation value.</p>
</section>
<section class="wp-block-wporg-code-reference-parameters"><h2 class="is-toc-heading wp-block-heading has-heading-5-font-size" id="parameters" tabindex="-1"><a href="#parameters">Parameters</a></h2> <dl><dt><code>$action</code><span class="type"><span class="int">int</span>|<span class="string">string</span></span><span class="required">optional</span></dt><dd><div class="desc"><span class="description">Action name. </span></div><p class="default">Default:<code>-1</code></p></dd><dt><code>$name</code><span class="type"><span class="string">string</span></span><span class="required">optional</span></dt><dd><div class="desc"><span class="description">Nonce name. Default <code>'_wpnonce'</code>.</span></div><p class="default">Default:<code>'_wpnonce'</code></p></dd><dt><code>$referer</code><span class="type"><span class="bool">bool</span></span><span class="required">optional</span></dt><dd><div class="desc"><span class="description">Whether to set the referer field for validation. </span></div><p class="default">Default:<code>true</code></p></dd><dt><code>$display</code><span class="type"><span class="bool">bool</span></span><span class="required">optional</span></dt><dd><div class="desc"><span class="description">Whether to display or return hidden form field. </span></div><p class="default">Default:<code>true</code></p></dd></dl></section>
<section class="wporg-has-embedded-code wp-block-wporg-code-reference-return-value"><h2 class="is-toc-heading wp-block-heading has-heading-5-font-size" id="return" tabindex="-1"><a href="#return">Return</a></h2> <span class="return-type">string</span> Nonce field HTML markup.</section>
<section class="wp-block-wporg-code-reference-source"><h2 class="is-toc-heading wp-block-heading has-heading-5-font-size" id="source" tabindex="-1"><a href="#source">Source</a></h2> <pre aria-label="Function source code" class="wp-block-code" data-start="1892"><code class="language-php line-numbers" id="wporg-source-code" lang="php">function wp_nonce_field( $action = -1, $name = '_wpnonce', $referer = true, $display = true ) {
	$name        = esc_attr( $name );
	$nonce_field = '&lt;input type="hidden" id="' . $name . '" name="' . $name . '" value="' . wp_create_nonce( $action ) . '" /&gt;';

	if ( $referer ) {
		$nonce_field .= wp_referer_field( false );
	}

	if ( $display ) {
		echo $nonce_field;
	}

	return $nonce_field;
}
</code></pre><p class="wporg-dot-link-list"><a href="https://developer.notmatt.press/reference/files/wp-includes/functions.php/">View all references</a> <a href="https://core.trac.wordpress.org/browser/tags/6.7/src/wp-includes/functions.php#L1892">View on Trac</a> <a href="https://github.com/WordPress/wordpress-develop/blob/6.7/src/wp-includes/functions.php#L1892-L1905">View on GitHub</a></p></section>
<section class="wp-block-wporg-code-reference-related" data-nosnippet="true"><h2 class="is-toc-heading wp-block-heading has-heading-5-font-size" id="related" tabindex="-1"><a href="#related">Related</a></h2> <section class="wp-block-wporg-code-table" id="uses" style="margin-top:var(--wp--preset--spacing--20);"><figure class="wp-block-table"><table><thead><tr><th scope="col">Uses</th><th scope="col">Description</th></tr></thead><tbody><tr class=""><td><a href="https://developer.notmatt.press/reference/functions/wp_create_nonce/">wp_create_nonce()</a><code>wp-includes/pluggable.php</code></td><td><p>Creates a cryptographic token tied to a specific action, user, user session, and window of time.</p>
</td></tr><tr class=""><td><a href="https://developer.notmatt.press/reference/functions/wp_referer_field/">wp_referer_field()</a><code>wp-includes/functions.php</code></td><td><p>Retrieves or displays referer hidden field for forms.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/esc_attr/">esc_attr()</a><code>wp-includes/formatting.php</code></td><td><p>Escaping for HTML attributes.</p>
</td></tr></tbody></table></figure><a class="wp-block-wporg-code-table-show-more" href="#">Show 1 more</a><a class="wp-block-wporg-code-table-show-less" href="#">Show less</a></section> <section class="wp-block-wporg-code-table" id="used-by" style="margin-top:var(--wp--preset--spacing--20);"><figure class="wp-block-table"><table><thead><tr><th scope="col">Used by</th><th scope="col">Description</th></tr></thead><tbody><tr class=""><td><a href="https://developer.notmatt.press/reference/functions/the_block_editor_meta_boxes/">the_block_editor_meta_boxes()</a><code>wp-admin/includes/post.php</code></td><td><p>Renders the meta boxes forms.</p>
</td></tr><tr class=""><td><a href="https://developer.notmatt.press/reference/functions/the_block_editor_meta_box_post_form_hidden_fields/">the_block_editor_meta_box_post_form_hidden_fields()</a><code>wp-admin/includes/post.php</code></td><td><p>Renders the hidden form required for the meta boxes form.</p>
</td></tr><tr class=""><td><a href="https://developer.notmatt.press/reference/functions/network_step1/">network_step1()</a><code>wp-admin/includes/network.php</code></td><td><p>Prints step 1 for Network installation process.</p>
</td></tr><tr class=""><td><a href="https://developer.notmatt.press/reference/classes/wp_screen/render_screen_options/">WP_Screen::render_screen_options()</a><code>wp-admin/includes/class-wp-screen.php</code></td><td><p>Renders the screen options tab.</p>
</td></tr><tr class=""><td><a href="https://developer.notmatt.press/reference/functions/install_themes_upload/">install_themes_upload()</a><code>wp-admin/includes/theme-install.php</code></td><td><p>Displays a form to upload themes from zip files.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/classes/wp_list_table/display_tablenav/">WP_List_Table::display_tablenav()</a><code>wp-admin/includes/class-wp-list-table.php</code></td><td><p>Generates the table navigation above or below the table</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/admin_color_scheme_picker/">admin_color_scheme_picker()</a><code>wp-admin/includes/misc.php</code></td><td><p>Displays the default admin color scheme picker (Used in user-edit.php).</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/classes/wp_theme_install_list_table/display/">WP_Theme_Install_List_Table::display()</a><code>wp-admin/includes/class-wp-theme-install-list-table.php</code></td><td><p>Displays the theme install table.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/install_plugins_upload/">install_plugins_upload()</a><code>wp-admin/includes/plugin-install.php</code></td><td><p>Displays a form to upload plugins from zip files.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/_wp_dashboard_control_callback/">_wp_dashboard_control_callback()</a><code>wp-admin/includes/dashboard.php</code></td><td><p>Outputs controls for the current dashboard widget.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/wp_dashboard/">wp_dashboard()</a><code>wp-admin/includes/dashboard.php</code></td><td><p>Displays the dashboard.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/wp_dashboard_quick_press/">wp_dashboard_quick_press()</a><code>wp-admin/includes/dashboard.php</code></td><td><p>Displays the Quick Draft widget.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/settings_fields/">settings_fields()</a><code>wp-admin/includes/plugin.php</code></td><td><p>Outputs nonce, action, and option_page fields for a settings page.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/find_posts_div/">find_posts_div()</a><code>wp-admin/includes/template.php</code></td><td><p>Outputs the modal window used for attaching media to posts or pages in the media-listing screen.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/wp_comment_reply/">wp_comment_reply()</a><code>wp-admin/includes/template.php</code></td><td><p>Outputs the in-line comment reply-to form in the Comments list table.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/_list_meta_row/">_list_meta_row()</a><code>wp-admin/includes/template.php</code></td><td><p>Outputs a single row of public meta data in the Custom Fields meta box.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/meta_form/">meta_form()</a><code>wp-admin/includes/template.php</code></td><td><p>Prints the form in the Custom Fields meta box.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/classes/wp_themes_list_table/display/">WP_Themes_List_Table::display()</a><code>wp-admin/includes/class-wp-themes-list-table.php</code></td><td><p>Displays the themes table.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/media_upload_type_form/">media_upload_type_form()</a><code>wp-admin/includes/media.php</code></td><td><p>Outputs the legacy media upload form for a given media type.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/media_upload_type_url_form/">media_upload_type_url_form()</a><code>wp-admin/includes/media.php</code></td><td><p>Outputs the legacy media upload form for external media.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/media_upload_gallery_form/">media_upload_gallery_form()</a><code>wp-admin/includes/media.php</code></td><td><p>Adds gallery form to upload iframe.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/media_upload_library_form/">media_upload_library_form()</a><code>wp-admin/includes/media.php</code></td><td><p>Outputs the legacy media upload form for the media library.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/post_comment_meta_box/">post_comment_meta_box()</a><code>wp-admin/includes/meta-boxes.php</code></td><td><p>Displays comments for post.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/link_categories_meta_box/">link_categories_meta_box()</a><code>wp-admin/includes/meta-boxes.php</code></td><td><p>Displays link categories form fields.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/post_categories_meta_box/">post_categories_meta_box()</a><code>wp-admin/includes/meta-boxes.php</code></td><td><p>Displays post categories form fields.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/classes/wp_post_comments_list_table/display/">WP_Post_Comments_List_Table::display()</a><code>wp-admin/includes/class-wp-post-comments-list-table.php</code></td><td></td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/classes/wp_comments_list_table/extra_tablenav/">WP_Comments_List_Table::extra_tablenav()</a><code>wp-admin/includes/class-wp-comments-list-table.php</code></td><td></td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/classes/wp_comments_list_table/display/">WP_Comments_List_Table::display()</a><code>wp-admin/includes/class-wp-comments-list-table.php</code></td><td><p>Displays the comments table.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/classes/wp_terms_list_table/inline_edit/">WP_Terms_List_Table::inline_edit()</a><code>wp-admin/includes/class-wp-terms-list-table.php</code></td><td><p>Outputs the hidden row displayed when inline editing</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/request_filesystem_credentials/">request_filesystem_credentials()</a><code>wp-admin/includes/file.php</code></td><td><p>Displays a form to the user to request for their FTP/SSH details in order to connect to the filesystem.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/classes/wp_posts_list_table/inline_edit/">WP_Posts_List_Table::inline_edit()</a><code>wp-admin/includes/class-wp-posts-list-table.php</code></td><td><p>Outputs the hidden row displayed when inline editing</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/classes/custom_image_header/step_1/">Custom_Image_Header::step_1()</a><code>wp-admin/includes/class-custom-image-header.php</code></td><td><p>Displays first step of custom header image page.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/classes/custom_image_header/step_2/">Custom_Image_Header::step_2()</a><code>wp-admin/includes/class-custom-image-header.php</code></td><td><p>Displays second step of custom header image page.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/confirm_delete_users/">confirm_delete_users()</a><code>wp-admin/includes/ms.php</code></td><td></td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/list_core_update/">list_core_update()</a><code>wp-admin/update-core.php</code></td><td><p>Lists available core updates.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/list_plugin_updates/">list_plugin_updates()</a><code>wp-admin/update-core.php</code></td><td><p>Display the upgrade plugins form.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/list_theme_updates/">list_theme_updates()</a><code>wp-admin/update-core.php</code></td><td><p>Display the upgrade themes form.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/list_translation_updates/">list_translation_updates()</a><code>wp-admin/update-core.php</code></td><td><p>Display the update translations form.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/classes/custom_background/admin_page/">Custom_Background::admin_page()</a><code>wp-admin/includes/class-custom-background.php</code></td><td><p>Displays the custom background page.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/signup_nonce_fields/">signup_nonce_fields()</a><code>wp-includes/ms-functions.php</code></td><td><p>Adds a nonce field to the signup page.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/functions/wp_comment_form_unfiltered_html_nonce/">wp_comment_form_unfiltered_html_nonce()</a><code>wp-includes/comment-template.php</code></td><td><p>Displays form token for unfiltered comments.</p>
</td></tr><tr class="wporg-hidden"><td><a href="https://developer.notmatt.press/reference/classes/_wp_editors/wp_link_dialog/">_WP_Editors::wp_link_dialog()</a><code>wp-includes/class-wp-editor.php</code></td><td><p>Dialog for internal linking.</p>
</td></tr></tbody></table></figure><a class="wp-block-wporg-code-table-show-more" href="#">Show 37 more</a><a class="wp-block-wporg-code-table-show-less" href="#">Show less</a></section> </section>
<section class="wp-block-wporg-code-reference-changelog"><h2 class="is-toc-heading wp-block-heading has-heading-5-font-size" id="changelog" tabindex="-1"><a href="#changelog">Changelog</a></h2> <section class="wp-block-wporg-code-table" style="margin-top:var(--wp--preset--spacing--20);"><figure class="wp-block-table"><table><thead><tr><th scope="col">Version</th><th scope="col">Description</th></tr></thead><tbody><tr class=""><td><a href="https://developer.notmatt.press/reference/since/2.0.4/">2.0.4</a></td><td>Introduced.</td></tr></tbody></table></figure></section> </section>
<section class="wp-block-wporg-code-reference-comments" data-nosnippet="true"><h2 class="is-toc-heading wp-block-heading" id="user-contributed-notes" tabindex="-1"><a href="#user-contributed-notes">User Contributed Notes</a></h2> <ol class="comment-list"> <li class="comment byuser comment-author-codex even thread-even depth-1" data-comment-id="801" id="comment-801">
<article class="comment-body" id="div-comment-801">
<a class="screen-reader-text" href="#comment-content-801">Skip to note 3 content</a>

<!-- .comment-metadata -->
<div class="wporg-has-embedded-code comment-content" id="comment-content-801">
<p><strong>Basic Examples</strong><br/>
While less secure than the examples that follow, this is the simplest implementation which omits all arguments. In your form add the following:</p>
<pre class="wp-block-code"><code class="language-php" lang="php">&lt;?php wp_nonce_field(); ?&gt;</code></pre>
<p>It’s better to name your action and nonce in your form. Enter values for the first and second arguments to print the necessary hidden field:</p>
<pre class="wp-block-code"><code class="language-php" lang="php">&lt;form method="post"&gt;
   &lt;!-- some inputs here ... --&gt;
   &lt;?php wp_nonce_field( 'name_of_my_action', 'name_of_nonce_field' ); ?&gt;
&lt;/form&gt;</code></pre>
<p>Then in the page where it is being submitted to, you may verify it using the <a href="https://developer.notmatt.press/reference/functions/wp_verify_nonce/" rel="function">wp_verify_nonce()</a>  function. Notice that you have to manually retrieve the nonce (from the $_POST array in this example), and the name of the action is the 2nd parameter instead of the first:</p>
<pre class="wp-block-code"><code class="language-php line-numbers" lang="php">if ( ! isset( $_POST['name_of_nonce_field'] ) 
    || ! wp_verify_nonce( $_POST['name_of_nonce_field'], 'name_of_my_action' ) 
) {
   print 'Sorry, your nonce did not verify.';
   exit;
} else {
   // process form data
}</code></pre>
</div><!-- .comment-content -->
<section class="wporg-has-embedded-code feedback hide-if-js" data-comment-count="0" id="feedback-801">
</section><!-- .feedback -->

</article><!-- .comment-body -->
</li>
<li class="comment byuser comment-author-sarathlal odd alt thread-odd thread-alt depth-1" data-comment-id="6449" id="comment-6449">
<article class="comment-body" id="div-comment-6449">
<a class="screen-reader-text" href="#comment-content-6449">Skip to note 4 content</a>

<!-- .comment-metadata -->
<div class="wporg-has-embedded-code comment-content" id="comment-content-6449">
<p>We can create a nonce field without a name because it is optional. In that case, the name will be <code>_wpnonce</code>.</p>
<pre class="wp-block-code"><code class="language-php" lang="php">wp_nonce_field( 'my-action-name' );</code></pre>
<p>The above statement echo a hidden field named as <code>_wpnonce</code>.</p>
<p>To verify this nonce, we can use the `wp_verify_nonce` function.</p>
<pre class="wp-block-code"><code class="language-php line-numbers" lang="php">if ( isset( $_REQUEST['_wpnonce'] ) &amp;&amp; wp_verify_nonce( $_REQUEST['_wpnonce'], 'my-action-name' ) ) {
  //do you action
} else {
  die( __( 'Security check', 'textdomain' ) );
}</code></pre>
</div><!-- .comment-content -->
<section class="wporg-has-embedded-code feedback hide-if-js" data-comment-count="0" id="feedback-6449">
</section><!-- .feedback -->

</article><!-- .comment-body -->
</li>
</ol></section>
</div></div>
    </div>
<footer class="text-center mt-10 py-5">
    <p class="text-sm"><a href="https://notmatt.press">NotMattPress</a>.</p>
</footer>
</body>
</html>
